<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://ouweiya.github.io/xstate-zh/blog</id>
    <title>Stately Blog</title>
    <updated>2024-07-29T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://ouweiya.github.io/xstate-zh/blog"/>
    <subtitle>Stately Blog</subtitle>
    <icon>https://ouweiya.github.io/xstate-zh/icon.svg</icon>
    <entry>
        <title type="html"><![CDATA[Viam x Stately - Smart Machines Meet State Machines]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-07-29-claw-game-state-machine</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-07-29-claw-game-state-machine"/>
        <updated>2024-07-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Controlling hardware in the real world requires confidence and safety, even when it's part of a game!]]></summary>
        <content type="html"><![CDATA[<p>The term "robots" invokes a fascinating range of ideas, from manually controlled machines to automated software that crawls the web. One of the prime examples in this area is robotic arms, traditionally used to aid and extend the reach of humans in manufacturing, surgery, and space exploration. Each of these use cases require some way of programming and controlling the arm to perform their dedicated task, usually with proprietary software developed by the manufacturer. The UI is tightly coupled to the hardware through a touchscreen device or desktop application physically connected to the arm, which makes it tough to put online securely and using modern technology.</p>
<p><a href="https://www.viam.com/" target="_blank" rel="noopener noreferrer">Viam</a> provides an open source software stack and set of cloud services that makes managing all types of robots (and other smart machines) accessible to developers without any prior hardware experience. To help demonstrate the types of experience that can be built with Viam, the developer advocacy team <a href="https://docs.viam.com/tutorials/projects/claw-game/" target="_blank" rel="noopener noreferrer">built an arcade claw game</a> that used an industrial robot arm and arcade claw that could be operated using a single-page web application powered by <a href="https://ts.viam.dev/" target="_blank" rel="noopener noreferrer">TypeScript SDK</a>.</p>
<!-- -->
<p><img loading="lazy" alt="a large arcade cabinet full of black, red, and green balls surrounding a robotic arm with an arcade claw attached at tehe top end" src="https://ouweiya.github.io/xstate-zh/assets/images/viam-claw-game-1a18c1ef125b5a1d1ec408da14d53cbb.jpg" width="3024" height="4032" class="img_ev3q"></p>
<p>Even for a relatively-constrained experience, managing the various possible actions and states to operate the arm made maintaining the code for the web application quite tough for anyone who wanted to update some feature. It was important to handle any errors related to potential collisions of the arm against any obstacles as it moved, as well as prevent commands from being sent to the arms while it was actively moving or grabbing. Also, as an open source example, we wanted the code to be understood by developers who were learning about Viam without getting lost in the UI-specific logic.</p>
<p>Given this mandate and my past experience using XState, I reached for Stately Studio and XState to make the claw game web app into a more production-ready system!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-problem">Understanding the problem<a href="https://ouweiya.github.io/xstate-zh/blog/2024-07-29-claw-game-state-machine#understanding-the-problem" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p><img loading="lazy" alt="a web page with a 3x3 grid of squares filled with directional arrows around an arcade claw, below the grid is a smiling robot with a speech bubble say &amp;quot;Good luck, and have fun!&amp;quot;" src="https://ouweiya.github.io/xstate-zh/assets/images/web-app-ui-2aa515b3743006618369a5166a1bc1e9.png" width="1044" height="810" class="img_ev3q"></p>
<p>As stated previously, the web application is quite literally a single page experience. It is a set of static assets (<code>index.html</code>, <code>styles.css</code>, <code>main.ts</code>) that are compiled and served by a static file server running on an embedded Linux device (the <a href="https://docs.viam.com/get-started/prepare/jetson-nano-setup/" target="_blank" rel="noopener noreferrer">NVIDIA Jetson Orin Nano</a> in this case) where the <a href="https://docs.viam.com/get-started/installation/" target="_blank" rel="noopener noreferrer">viam-server Robot Development Kit</a> is also running. This is purely for convenience rather than necessity since the Viam TypeScript SDK connects to <code>viam-server</code> using WebRTC, so the app could run on any device in the world with an Internet connection.</p>
<p>Because the UI itself is fairly simple, there's no client-side framework being used; just DOM APIs and the Viam SDK. Let's take a look at the <code>main</code> function in the <code>main.ts</code> file for the project, which pulls together most of the logic for interacting with the UI and robot; we can start to identify opportunities for finite states and actions:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">async</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Connect to client</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> client</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> Client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    client </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">connect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'connected!'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> motionClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MotionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> motionClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> boardClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BoardClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> boardClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> armClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArmClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> gripperClient </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GripperClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> gripperClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/// more below</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Right off the bat, there's some setup logic to connect to the robot that could potentially fail if the machine is offline but not much in the way of error handling. I can identify at least four states from this snippet alone: <code>initializing</code>, <code>connectingToMachine</code>, <code>clientErrored</code>, and <code>connected</code>. Once the main client has connected to the robot, we create an instance of each component client that we want to control.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> isMoving </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">styleMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> element </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getElementById</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">state </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'move'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    element</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">classList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">remove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container-error'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container-ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    element</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">classList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container-moving'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">state </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    element</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">classList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">remove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container-error'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container-moving'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    element</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">classList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container-ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">state </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'error'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    element</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">classList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">remove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container-moving'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container-ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    element</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">classList</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">add</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container-error'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we can see an interesting mix of boolean variables (<code>isMoving</code>) and explicit states being passed to a function to style the grid of quadrants to which the robot arm can move. This helps inform some additional states to model: <code>ready</code> (this could be separate from the <code>connected</code> state) and <code>moving</code>. Updating the styles based on the current state of the machine could happen as a side-effect within the machine config or by subscribing to the machine state; we can explore that when modeling in Stately Studio.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// Helper functions to define button behavior</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">async</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">mouseDown</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">func</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">Promise</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token builtin" style="color:hsl(119, 34%, 47%)">boolean</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">isMoving</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">styleMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'move'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  isMoving </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> success </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">func</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">success</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">styleMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    isMoving </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  button</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> HTMLTableCellElement</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">func</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">Promise</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token builtin" style="color:hsl(119, 34%, 47%)">boolean</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  button</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addEventListener</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'mousedown'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">mouseDown</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">func</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">async</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">planarMoveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  button</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> HTMLTableCellElement</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  x</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  y</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">inPlaneMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">styleMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'error'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">setTimeout</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function" style="color:hsl(221, 87%, 60%)">styleMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      isMoving </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> moveTimeout</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">forwardbutton</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">planarMoveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">forwardbutton</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain">moveDistance</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">backbutton</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">planarMoveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">backbutton</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> moveDistance</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">rightbutton</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">planarMoveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">rightbutton</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> moveDistance</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">leftbutton</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">planarMoveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">leftbutton</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token plain">moveDistance</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we're getting into the real action. The <code>mouseDown</code> helper function is doing a few things to orchestrate the UI while sending commands to the arm: guarding when the arm is moving, updating the styles and global variable before calling the wrapped async command, checking the result of the command before updating the styles and global variable again if it was successful. There's no error handling within the <code>mouseDown</code> handler, instead it has been included in the <code>planarMoveHandler</code> which also calls the <code>styleMove</code> helper along with a timer to reset the UI to the <code>ready</code> state again (the <code>inPlaneMove</code> function being called moves the arm a short distance in its existing position, rather than to a new quadrant as we'll see later). Keeping the general error handling in the <code>mouseDown</code> would help organize that logic together, but that doesn't necessarily mean it would be easy to follow the individual states that become active during this interaction.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// Define buttons for movement between quadrants</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">async</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">moveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">func</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">Promise</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> func</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">styleMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'error'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">setTimeout</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function" style="color:hsl(221, 87%, 60%)">styleMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      isMoving </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> moveTimeout</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">gridBackLeft</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">moveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">moveToQuadrant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">gridBack</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">moveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">moveToQuadrant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">gridBackRight</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">moveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">moveToQuadrant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">gridLeft</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">moveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">moveToQuadrant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">gridHome</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">moveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">home</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">gridRight</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">moveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">moveToQuadrant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">gridFrontLeft</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">moveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">moveToQuadrant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">-</span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">gridFrontRight</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">moveHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token function" style="color:hsl(221, 87%, 60%)">moveToQuadrant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is familiar to the <code>inPlanarMove</code> set up we just explored, so there's already some potential for combining those efforts into a single <code>moveHandler</code> with the same caveats of mixing side-effects with state changes. This current <code>moveHandler</code> most likely doesn't include the <code>moving</code> style updates and global variable change because the <code>moveToQuadrant</code> includes a guard using the <a href="https://docs.viam.com/components/arm/#ismoving" target="_blank" rel="noopener noreferrer"><code>armClient.isMoving()</code></a> method instead, but that's tough to know without exploring the implementation of that function.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// Define button to grab and return object</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">async</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">dropHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">zMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">240</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">grab</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">boardClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> gripperClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">delay</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">zMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> moveHeight</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">home</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">delay</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">release</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">boardClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> gripperClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">styleMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'error'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function" style="color:hsl(221, 87%, 60%)">setTimeout</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function" style="color:hsl(221, 87%, 60%)">styleMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      isMoving </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2000</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">setButtonBehavior</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">dropbutton</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">dropHandler</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the final snippet we can see the third iteration of the common move handler orchestration with even more commands and asynchronous behavior. The <code>dropHandler</code> takes care of grabbing a ball from the bottom of the game and moving it over to the drop chute to release it (if it was able to grab one). This is a pretty distinct action from the other move handlers, even with the overlap in error handling logic.</p>
<p>With our initial analysis of the game code done, let's try modeling it all in Stately Studio!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="modeling-in-stately-studio">Modeling in Stately Studio<a href="https://ouweiya.github.io/xstate-zh/blog/2024-07-29-claw-game-state-machine#modeling-in-stately-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>The completed state machine:</p>
<iframe loading="lazy" src="https://stately.ai/registry/editor/embed/40eef216-51c5-4c58-aa9a-22b5ed25ee68?mode=design&amp;machineId=72280163-4dde-4e85-a2a1-b30f49c7f27f&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/40eef216-51c5-4c58-aa9a-22b5ed25ee68?mode=design&amp;machineId=72280163-4dde-4e85-a2a1-b30f49c7f27f">View the <em>A state machine demonstrating the logic for a robotic claw game that can move around and pick up balls.</em> machine in Stately Studio</a>.</iframe>
<p>While we dig into the Stately model, I'll include "enhanced" views using MermaidJS diagrams to focus on certain parts.</p>
<p><img loading="lazy" alt="state diagram visualizing the starting states for the claw game state machine" src="https://ouweiya.github.io/xstate-zh/assets/images/mermaid-diagram-starting-states-4498628d04c07ada7a9aa677c30f3983.svg" width="825" height="748" class="img_ev3q"></p>
<p>As mentioned when first exploring the main TypeScript logic, we have a fairly classic <code>initializing</code> starting state that transitions into the <code>connectingToMachine</code> state upon the <code>connect</code> action. This allows us to control when we want to start connecting or attempt to reconnect if something happens; we could also call this <code>disconnected</code> for clarity in the future. In the <code>connectingToMachine</code> state, we invoke a <code>createRobotClient</code> actor that replicates the <code>connect</code> helper function and assigns the client to the machine context upon success. As the first improvement from original logic, we've added an explicit error handler for this actor to transition into the <code>clientErrored</code> state and allow a retry action to transition back to <code>initializing</code>. The <code>connected</code> state will immediately transition to the <code>ready</code> state after assigning the necessary component clients to the machine context upon entry.</p>
<p><img loading="lazy" alt="state diagram visualizing the moving states for the claw game state machine" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPD94bWwtc3R5bGVzaGVldCBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9mb250LWF3ZXNvbWUvNi41LjIvY3NzL2FsbC5taW4uY3NzIiB0eXBlPSJ0ZXh0L2NzcyI/Pgo8c3ZnIGFyaWEtcm9sZWRlc2NyaXB0aW9uPSJzdGF0ZURpYWdyYW0iIHJvbGU9ImdyYXBoaWNzLWRvY3VtZW50IGRvY3VtZW50IiB2aWV3Qm94PSIwLjUgMCA3NjIuMTE2NjM4MTgzNTkzOCAzNzkiIHN0eWxlPSJtYXgtd2lkdGg6IDEwMCU7IiBjbGFzcz0ic3RhdGVkaWFncmFtIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBpZD0iZ3JhcGgtZGl2IiBoZWlnaHQ9IjEwMCUiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48c3R5bGU+I2dyYXBoLWRpdntmb250LWZhbWlseToidHJlYnVjaGV0IG1zIix2ZXJkYW5hLGFyaWFsLHNhbnMtc2VyaWY7Zm9udC1zaXplOjE2cHg7ZmlsbDojMzMzO30jZ3JhcGgtZGl2IC5lcnJvci1pY29ue2ZpbGw6IzU1MjIyMjt9I2dyYXBoLWRpdiAuZXJyb3ItdGV4dHtmaWxsOiM1NTIyMjI7c3Ryb2tlOiM1NTIyMjI7fSNncmFwaC1kaXYgLmVkZ2UtdGhpY2tuZXNzLW5vcm1hbHtzdHJva2Utd2lkdGg6MnB4O30jZ3JhcGgtZGl2IC5lZGdlLXRoaWNrbmVzcy10aGlja3tzdHJva2Utd2lkdGg6My41cHg7fSNncmFwaC1kaXYgLmVkZ2UtcGF0dGVybi1zb2xpZHtzdHJva2UtZGFzaGFycmF5OjA7fSNncmFwaC1kaXYgLmVkZ2UtcGF0dGVybi1kYXNoZWR7c3Ryb2tlLWRhc2hhcnJheTozO30jZ3JhcGgtZGl2IC5lZGdlLXBhdHRlcm4tZG90dGVke3N0cm9rZS1kYXNoYXJyYXk6Mjt9I2dyYXBoLWRpdiAubWFya2Vye2ZpbGw6IzMzMzMzMztzdHJva2U6IzMzMzMzMzt9I2dyYXBoLWRpdiAubWFya2VyLmNyb3Nze3N0cm9rZTojMzMzMzMzO30jZ3JhcGgtZGl2IHN2Z3tmb250LWZhbWlseToidHJlYnVjaGV0IG1zIix2ZXJkYW5hLGFyaWFsLHNhbnMtc2VyaWY7Zm9udC1zaXplOjE2cHg7fSNncmFwaC1kaXYgZGVmcyAjc3RhdGVkaWFncmFtLWJhcmJFbmR7ZmlsbDojMzMzMzMzO3N0cm9rZTojMzMzMzMzO30jZ3JhcGgtZGl2IGcuc3RhdGVHcm91cCB0ZXh0e2ZpbGw6IzkzNzBEQjtzdHJva2U6bm9uZTtmb250LXNpemU6MTBweDt9I2dyYXBoLWRpdiBnLnN0YXRlR3JvdXAgdGV4dHtmaWxsOiMzMzM7c3Ryb2tlOm5vbmU7Zm9udC1zaXplOjEwcHg7fSNncmFwaC1kaXYgZy5zdGF0ZUdyb3VwIC5zdGF0ZS10aXRsZXtmb250LXdlaWdodDpib2xkZXI7ZmlsbDojMTMxMzAwO30jZ3JhcGgtZGl2IGcuc3RhdGVHcm91cCByZWN0e2ZpbGw6I0VDRUNGRjtzdHJva2U6IzkzNzBEQjt9I2dyYXBoLWRpdiBnLnN0YXRlR3JvdXAgbGluZXtzdHJva2U6IzMzMzMzMztzdHJva2Utd2lkdGg6MTt9I2dyYXBoLWRpdiAudHJhbnNpdGlvbntzdHJva2U6IzMzMzMzMztzdHJva2Utd2lkdGg6MTtmaWxsOm5vbmU7fSNncmFwaC1kaXYgLnN0YXRlR3JvdXAgLmNvbXBvc2l0e2ZpbGw6d2hpdGU7Ym9yZGVyLWJvdHRvbToxcHg7fSNncmFwaC1kaXYgLnN0YXRlR3JvdXAgLmFsdC1jb21wb3NpdHtmaWxsOiNlMGUwZTA7Ym9yZGVyLWJvdHRvbToxcHg7fSNncmFwaC1kaXYgLnN0YXRlLW5vdGV7c3Ryb2tlOiNhYWFhMzM7ZmlsbDojZmZmNWFkO30jZ3JhcGgtZGl2IC5zdGF0ZS1ub3RlIHRleHR7ZmlsbDpibGFjaztzdHJva2U6bm9uZTtmb250LXNpemU6MTBweDt9I2dyYXBoLWRpdiAuc3RhdGVMYWJlbCAuYm94e3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowO2ZpbGw6I0VDRUNGRjtvcGFjaXR5OjAuNTt9I2dyYXBoLWRpdiAuZWRnZUxhYmVsIC5sYWJlbCByZWN0e2ZpbGw6I0VDRUNGRjtvcGFjaXR5OjAuNTt9I2dyYXBoLWRpdiAuZWRnZUxhYmVsIC5sYWJlbCB0ZXh0e2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiAubGFiZWwgZGl2IC5lZGdlTGFiZWx7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiAuc3RhdGVMYWJlbCB0ZXh0e2ZpbGw6IzEzMTMwMDtmb250LXNpemU6MTBweDtmb250LXdlaWdodDpib2xkO30jZ3JhcGgtZGl2IC5ub2RlIGNpcmNsZS5zdGF0ZS1zdGFydHtmaWxsOiMzMzMzMzM7c3Ryb2tlOiMzMzMzMzM7fSNncmFwaC1kaXYgLm5vZGUgLmZvcmstam9pbntmaWxsOiMzMzMzMzM7c3Ryb2tlOiMzMzMzMzM7fSNncmFwaC1kaXYgLm5vZGUgY2lyY2xlLnN0YXRlLWVuZHtmaWxsOiM5MzcwREI7c3Ryb2tlOndoaXRlO3N0cm9rZS13aWR0aDoxLjU7fSNncmFwaC1kaXYgLmVuZC1zdGF0ZS1pbm5lcntmaWxsOndoaXRlO3N0cm9rZS13aWR0aDoxLjU7fSNncmFwaC1kaXYgLm5vZGUgcmVjdHtmaWxsOiNFQ0VDRkY7c3Ryb2tlOiM5MzcwREI7c3Ryb2tlLXdpZHRoOjFweDt9I2dyYXBoLWRpdiAubm9kZSBwb2x5Z29ue2ZpbGw6I0VDRUNGRjtzdHJva2U6IzkzNzBEQjtzdHJva2Utd2lkdGg6MXB4O30jZ3JhcGgtZGl2ICNzdGF0ZWRpYWdyYW0tYmFyYkVuZHtmaWxsOiMzMzMzMzM7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbS1jbHVzdGVyIHJlY3R7ZmlsbDojRUNFQ0ZGO3N0cm9rZTojOTM3MERCO3N0cm9rZS13aWR0aDoxcHg7fSNncmFwaC1kaXYgLmNsdXN0ZXItbGFiZWwsI2dyYXBoLWRpdiAubm9kZUxhYmVse2NvbG9yOiMxMzEzMDA7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbS1jbHVzdGVyIHJlY3Qub3V0ZXJ7cng6NXB4O3J5OjVweDt9I2dyYXBoLWRpdiAuc3RhdGVkaWFncmFtLXN0YXRlIC5kaXZpZGVye3N0cm9rZTojOTM3MERCO30jZ3JhcGgtZGl2IC5zdGF0ZWRpYWdyYW0tc3RhdGUgLnRpdGxlLXN0YXRle3J4OjVweDtyeTo1cHg7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbS1jbHVzdGVyLnN0YXRlZGlhZ3JhbS1jbHVzdGVyIC5pbm5lcntmaWxsOndoaXRlO30jZ3JhcGgtZGl2IC5zdGF0ZWRpYWdyYW0tY2x1c3Rlci5zdGF0ZWRpYWdyYW0tY2x1c3Rlci1hbHQgLmlubmVye2ZpbGw6I2YwZjBmMDt9I2dyYXBoLWRpdiAuc3RhdGVkaWFncmFtLWNsdXN0ZXIgLmlubmVye3J4OjA7cnk6MDt9I2dyYXBoLWRpdiAuc3RhdGVkaWFncmFtLXN0YXRlIHJlY3QuYmFzaWN7cng6NXB4O3J5OjVweDt9I2dyYXBoLWRpdiAuc3RhdGVkaWFncmFtLXN0YXRlIHJlY3QuZGl2aWRlcntzdHJva2UtZGFzaGFycmF5OjEwLDEwO2ZpbGw6I2YwZjBmMDt9I2dyYXBoLWRpdiAubm90ZS1lZGdle3N0cm9rZS1kYXNoYXJyYXk6NTt9I2dyYXBoLWRpdiAuc3RhdGVkaWFncmFtLW5vdGUgcmVjdHtmaWxsOiNmZmY1YWQ7c3Ryb2tlOiNhYWFhMzM7c3Ryb2tlLXdpZHRoOjFweDtyeDowO3J5OjA7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbS1ub3RlIHJlY3R7ZmlsbDojZmZmNWFkO3N0cm9rZTojYWFhYTMzO3N0cm9rZS13aWR0aDoxcHg7cng6MDtyeTowO30jZ3JhcGgtZGl2IC5zdGF0ZWRpYWdyYW0tbm90ZSB0ZXh0e2ZpbGw6YmxhY2s7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbS1ub3RlIC5ub2RlTGFiZWx7Y29sb3I6YmxhY2s7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbSAuZWRnZUxhYmVse2NvbG9yOnJlZDt9I2dyYXBoLWRpdiAjZGVwZW5kZW5jeVN0YXJ0LCNncmFwaC1kaXYgI2RlcGVuZGVuY3lFbmR7ZmlsbDojMzMzMzMzO3N0cm9rZTojMzMzMzMzO3N0cm9rZS13aWR0aDoxO30jZ3JhcGgtZGl2IC5zdGF0ZWRpYWdyYW1UaXRsZVRleHR7dGV4dC1hbmNob3I6bWlkZGxlO2ZvbnQtc2l6ZToxOHB4O2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiA6cm9vdHstLW1lcm1haWQtZm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO308L3N0eWxlPjxnPjxkZWZzPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJVbml0cz0ic3Ryb2tlV2lkdGgiIG1hcmtlckhlaWdodD0iMTQiIG1hcmtlcldpZHRoPSIyMCIgcmVmWT0iNyIgcmVmWD0iMTkiIGlkPSJncmFwaC1kaXZfc3RhdGVkaWFncmFtLWJhcmJFbmQiPjxwYXRoIGQ9Ik0gMTksNyBMOSwxMyBMMTQsNyBMOSwxIFoiPjwvcGF0aD48L21hcmtlcj48L2RlZnM+PGcgY2xhc3M9InJvb3QiPjxnIGNsYXNzPSJjbHVzdGVycyI+PC9nPjxnIGNsYXNzPSJlZGdlUGF0aHMiPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVscyI+PC9nPjxnIGNsYXNzPSJub2RlcyI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC41LCAwKSIgY2xhc3M9InJvb3QiPjxnIGNsYXNzPSJjbHVzdGVycyI+PGcgaWQ9IkNsYXdfTWFjaGluZSIgY2xhc3M9InN0YXRlZGlhZ3JhbS1zdGF0ZSBzdGF0ZWRpYWdyYW0tY2x1c3RlciI+PHJlY3QgaGVpZ2h0PSIzNjMiIHdpZHRoPSI3NDYuMTE2NjM4MTgzNTkzOCIgeT0iOCIgeD0iOCIgY2xhc3M9Im91dGVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzMyLjEyNDk4NDc0MTIxMDk0LCA4KSIgY2xhc3M9ImNsdXN0ZXItbGFiZWwiPjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSI5Ny44NjY2Njg3MDExNzE4OCI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPkNsYXcgTWFjaGluZTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjxyZWN0IGhlaWdodD0iMzM2IiB3aWR0aD0iNzQ2LjExNjYzODE4MzU5MzgiIHk9IjMxIiB4PSI4IiBjbGFzcz0iaW5uZXIiPjwvcmVjdD48L2c+PC9nPjxnIGNsYXNzPSJlZGdlUGF0aHMiPjxwYXRoIG1hcmtlci1lbmQ9InVybCgjZ3JhcGgtZGl2X3N0YXRlZGlhZ3JhbS1iYXJiRW5kKSIgc3R5bGU9ImZpbGw6bm9uZSIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCB0cmFuc2l0aW9uIiBpZD0iZWRnZTIwIiBkPSJNMjgwLjYzNyw2MC40NThMMjUyLjYwNCw2OC41NDhDMjI0LjU3MSw3Ni42MzksMTY4LjUwNCw5Mi44MTksMTQ2LjM0MiwxMDcuMDc2QzEyNC4xOCwxMjEuMzMzLDEzNS45MjMsMTMzLjY2NywxNDEuNzk1LDEzOS44MzNMMTQ3LjY2NiwxNDYiPjwvcGF0aD48cGF0aCBtYXJrZXItZW5kPSJ1cmwoI2dyYXBoLWRpdl9zdGF0ZWRpYWdyYW0tYmFyYkVuZCkiIHN0eWxlPSJmaWxsOm5vbmUiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgdHJhbnNpdGlvbiIgaWQ9ImVkZ2UyMSIgZD0iTTIzNy42OTQsMTQ2TDI0OS40NDcsMTM5LjgzM0MyNjEuMiwxMzMuNjY3LDI4NC43MDYsMTIxLjMzMywyOTYuNDU5LDEwOUMzMDguMjEyLDk2LjY2NywzMDguMjEyLDg0LjMzMywzMDguMjEyLDc4LjE2N0wzMDguMjEyLDcyIj48L3BhdGg+PHBhdGggbWFya2VyLWVuZD0idXJsKCNncmFwaC1kaXZfc3RhdGVkaWFncmFtLWJhcmJFbmQpIiBzdHlsZT0iZmlsbDpub25lIiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIHRyYW5zaXRpb24iIGlkPSJlZGdlMjIiIGQ9Ik0xNzcuNjU4LDIwOUwxNzcuNjU4LDIxNy4xNjdDMTc3LjY1OCwyMjUuMzMzLDE3Ny42NTgsMjQxLjY2NywxOTkuMywyNThDMjIwLjk0MywyNzQuMzMzLDI2NC4yMjcsMjkwLjY2NywyODUuODY5LDI5OC44MzNMMzA3LjUxMSwzMDciPjwvcGF0aD48cGF0aCBtYXJrZXItZW5kPSJ1cmwoI2dyYXBoLWRpdl9zdGF0ZWRpYWdyYW0tYmFyYkVuZCkiIHN0eWxlPSJmaWxsOm5vbmUiIGNsYXNzPSJlZGdlLXRoaWNrbmVzcy1ub3JtYWwgdHJhbnNpdGlvbiIgaWQ9ImVkZ2UyMyIgZD0iTTQxMC44NjQsMzA3TDQzMi41MDYsMjk4LjgzM0M0NTQuMTQ4LDI5MC42NjcsNDk3LjQzMiwyNzQuMzMzLDUxOS4wNzQsMjUyLjc1QzU0MC43MTcsMjMxLjE2Nyw1NDAuNzE3LDIwNC4zMzMsNTQwLjcxNywxNzkuNUM1NDAuNzE3LDE1NC42NjcsNTQwLjcxNywxMzEuODMzLDUwNi41NjIsMTEyLjExN0M0NzIuNDA3LDkyLjQsNDA0LjA5Nyw3NS44MDEsMzY5Ljk0Miw2Ny41MDFMMzM1Ljc4Nyw1OS4yMDEiPjwvcGF0aD48L2c+PGcgY2xhc3M9ImVkZ2VMYWJlbHMiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExMi40Mzc0OTYxODUzMDI3MywgMTA5KSIgY2xhc3M9ImVkZ2VMYWJlbCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE5LjIxNjY2NzE3NTI5Mjk3LCAtMTIpIiBjbGFzcz0ibGFiZWwiPjxyZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIzOC40MzMzMzQzNTA1ODU5NCIgcnk9IjAiIHJ4PSIwIj48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjM4LjQzMzMzNDM1MDU4NTk0Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+bW92ZTwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMDguMjEyNDg2MjY3MDg5ODQsIDEwOSkiIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC04MS45NDk5OTY5NDgyNDIxOSwgLTEyKSIgY2xhc3M9ImxhYmVsIj48cmVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTYzLjg5OTk5Mzg5NjQ4NDM4IiByeT0iMCIgcng9IjAiPjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTYzLjg5OTk5Mzg5NjQ4NDM4Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+ZG9uZS5pbnZva2UuYXJtTW92ZXI8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc3LjY1ODMyNTE5NTMxMjUsIDI1OCkiIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC04OS4zMDAwMDMwNTE3NTc4MSwgLTI0KSIgY2xhc3M9ImxhYmVsIj48cmVjdCBoZWlnaHQ9IjQ4IiB3aWR0aD0iMTc4LjYwMDAwNjEwMzUxNTYyIiByeT0iMCIgcng9IjAiPjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjQ4IiB3aWR0aD0iMTc4LjYwMDAwNjEwMzUxNTYyIj48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+ZXJyb3IucGxhdGZvcm0uYXJtTW92ZXIgPGJyLz5kbyAvIGFzc2lnbkVycm9yPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDU0MC43MTY2NDQyODcxMDk0LCAxNzcuNSkiIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xOTMuMzk5OTkzODk2NDg0MzgsIC0yNCkiIGNsYXNzPSJsYWJlbCI+PHJlY3QgaGVpZ2h0PSI0OCIgd2lkdGg9IjM4Ni43OTk5ODc3OTI5Njg3NSIgcnk9IjAiIHJ4PSIwIj48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSI0OCIgd2lkdGg9IjM4Ni43OTk5ODc3OTI5Njg3NSI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPnhzdGF0ZS5hZnRlcigzMDAwKSNDbGF3IE1hY2hpbmUuZGlzcGxheWluZ01vdmVFcnJvciA8YnIvPmRvIC8gY2xlYXJFcnJvcjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48L2c+PGcgY2xhc3M9Im5vZGVzIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMDguMjEyNDg2MjY3MDg5ODQsIDUyLjUpIiBkYXRhLWlkPSJDbGF3X01hY2hpbmUucmVhZHkiIGRhdGEtbm9kZT0idHJ1ZSIgaWQ9InN0YXRlLUNsYXdfTWFjaGluZS5yZWFkeS0yNCIgY2xhc3M9Im5vZGUgIHN0YXRlZGlhZ3JhbS1zdGF0ZSB1bmRlZmluZWQiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSI1NS4xNDk5OTM4OTY0ODQzNzUiIHk9Ii0xOS41IiB4PSItMjcuNTc0OTk2OTQ4MjQyMTg4IiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTIwLjA3NDk5Njk0ODI0MjE4OCwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjQwLjE0OTk5Mzg5NjQ4NDM3NSI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPnJlYWR5PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3Ny42NTgzMjUxOTUzMTI1LCAxNzcuNSkiIGRhdGEtaWQ9IkNsYXdfTWFjaGluZS5tb3ZpbmciIGRhdGEtbm9kZT0idHJ1ZSIgaWQ9InN0YXRlLUNsYXdfTWFjaGluZS5tb3ZpbmctMjQiIGNsYXNzPSJub2RlICBzdGF0ZWRpYWdyYW0tc3RhdGUgdW5kZWZpbmVkIj48cmVjdCBoZWlnaHQ9IjYzIiB3aWR0aD0iMjY5LjMxNjY2NTY0OTQxNDA2IiB5PSItMzEuNSIgeD0iLTEzNC42NTgzMzI4MjQ3MDcwMyIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xMjcuMTU4MzMyODI0NzA3MDMsIC0yNCkiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iNDgiIHdpZHRoPSIyNTQuMzE2NjY1NjQ5NDE0MDYiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7Ij48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5tb3Zpbmc8YnIvPmludm9rZSAvIG1vdmVIYW5kbGVyIGFzIGFybU1vdmVyPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM1OS4xODc0ODQ3NDEyMTA5NCwgMzI2LjUpIiBkYXRhLWlkPSJDbGF3X01hY2hpbmUuZGlzcGxheWluZ01vdmVFcnJvciIgZGF0YS1ub2RlPSJ0cnVlIiBpZD0ic3RhdGUtQ2xhd19NYWNoaW5lLmRpc3BsYXlpbmdNb3ZlRXJyb3ItMjQiIGNsYXNzPSJub2RlICBzdGF0ZWRpYWdyYW0tc3RhdGUgdW5kZWZpbmVkIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iMTU4LjUzMzM0MDQ1NDEwMTU2IiB5PSItMTkuNSIgeD0iLTc5LjI2NjY3MDIyNzA1MDc4IiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTcxLjc2NjY3MDIyNzA1MDc4LCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTQzLjUzMzM0MDQ1NDEwMTU2Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+ZGlzcGxheWluZ01vdmVFcnJvcjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPg==" width="762" height="379" class="img_ev3q"></p>
<p>From the <code>ready</code> state, the first action to look at is <code>move</code>. This will transition into the <code>moving</code> state (no more separate boolean variable to update ðŸŽ‰) and invoke the <code>armMover</code> actor with a set of inputs to specify the <code>x</code> and <code>y</code> arguments along with the movement type: <code>planar</code> or <code>quadrant</code>; this allows for a consolidated workflow to handle those two similar interactions. Upon success, the machine transitions immediately back to <code>ready</code>. The error case is one of my favorite parts about this modeling; besides the explicit <code>displayingMoveError</code> state, we can see the automatic transition after the set period of time in one place.</p>
<p><img loading="lazy" alt="state diagram visualizing the picking states for the claw game state machine" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPD94bWwtc3R5bGVzaGVldCBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9mb250LWF3ZXNvbWUvNi41LjIvY3NzL2FsbC5taW4uY3NzIiB0eXBlPSJ0ZXh0L2NzcyI/Pgo8c3ZnIGFyaWEtcm9sZWRlc2NyaXB0aW9uPSJzdGF0ZURpYWdyYW0iIHJvbGU9ImdyYXBoaWNzLWRvY3VtZW50IGRvY3VtZW50IiB2aWV3Qm94PSIwLjUgMCA3NjUuMjc5MTc0ODA0Njg3NSAzNzkiIHN0eWxlPSJtYXgtd2lkdGg6IDEwMCU7IiBjbGFzcz0ic3RhdGVkaWFncmFtIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBpZD0iZ3JhcGgtZGl2IiBoZWlnaHQ9IjEwMCUiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48c3R5bGU+I2dyYXBoLWRpdntmb250LWZhbWlseToidHJlYnVjaGV0IG1zIix2ZXJkYW5hLGFyaWFsLHNhbnMtc2VyaWY7Zm9udC1zaXplOjE2cHg7ZmlsbDojMzMzO30jZ3JhcGgtZGl2IC5lcnJvci1pY29ue2ZpbGw6IzU1MjIyMjt9I2dyYXBoLWRpdiAuZXJyb3ItdGV4dHtmaWxsOiM1NTIyMjI7c3Ryb2tlOiM1NTIyMjI7fSNncmFwaC1kaXYgLmVkZ2UtdGhpY2tuZXNzLW5vcm1hbHtzdHJva2Utd2lkdGg6MnB4O30jZ3JhcGgtZGl2IC5lZGdlLXRoaWNrbmVzcy10aGlja3tzdHJva2Utd2lkdGg6My41cHg7fSNncmFwaC1kaXYgLmVkZ2UtcGF0dGVybi1zb2xpZHtzdHJva2UtZGFzaGFycmF5OjA7fSNncmFwaC1kaXYgLmVkZ2UtcGF0dGVybi1kYXNoZWR7c3Ryb2tlLWRhc2hhcnJheTozO30jZ3JhcGgtZGl2IC5lZGdlLXBhdHRlcm4tZG90dGVke3N0cm9rZS1kYXNoYXJyYXk6Mjt9I2dyYXBoLWRpdiAubWFya2Vye2ZpbGw6IzMzMzMzMztzdHJva2U6IzMzMzMzMzt9I2dyYXBoLWRpdiAubWFya2VyLmNyb3Nze3N0cm9rZTojMzMzMzMzO30jZ3JhcGgtZGl2IHN2Z3tmb250LWZhbWlseToidHJlYnVjaGV0IG1zIix2ZXJkYW5hLGFyaWFsLHNhbnMtc2VyaWY7Zm9udC1zaXplOjE2cHg7fSNncmFwaC1kaXYgZGVmcyAjc3RhdGVkaWFncmFtLWJhcmJFbmR7ZmlsbDojMzMzMzMzO3N0cm9rZTojMzMzMzMzO30jZ3JhcGgtZGl2IGcuc3RhdGVHcm91cCB0ZXh0e2ZpbGw6IzkzNzBEQjtzdHJva2U6bm9uZTtmb250LXNpemU6MTBweDt9I2dyYXBoLWRpdiBnLnN0YXRlR3JvdXAgdGV4dHtmaWxsOiMzMzM7c3Ryb2tlOm5vbmU7Zm9udC1zaXplOjEwcHg7fSNncmFwaC1kaXYgZy5zdGF0ZUdyb3VwIC5zdGF0ZS10aXRsZXtmb250LXdlaWdodDpib2xkZXI7ZmlsbDojMTMxMzAwO30jZ3JhcGgtZGl2IGcuc3RhdGVHcm91cCByZWN0e2ZpbGw6I0VDRUNGRjtzdHJva2U6IzkzNzBEQjt9I2dyYXBoLWRpdiBnLnN0YXRlR3JvdXAgbGluZXtzdHJva2U6IzMzMzMzMztzdHJva2Utd2lkdGg6MTt9I2dyYXBoLWRpdiAudHJhbnNpdGlvbntzdHJva2U6IzMzMzMzMztzdHJva2Utd2lkdGg6MTtmaWxsOm5vbmU7fSNncmFwaC1kaXYgLnN0YXRlR3JvdXAgLmNvbXBvc2l0e2ZpbGw6d2hpdGU7Ym9yZGVyLWJvdHRvbToxcHg7fSNncmFwaC1kaXYgLnN0YXRlR3JvdXAgLmFsdC1jb21wb3NpdHtmaWxsOiNlMGUwZTA7Ym9yZGVyLWJvdHRvbToxcHg7fSNncmFwaC1kaXYgLnN0YXRlLW5vdGV7c3Ryb2tlOiNhYWFhMzM7ZmlsbDojZmZmNWFkO30jZ3JhcGgtZGl2IC5zdGF0ZS1ub3RlIHRleHR7ZmlsbDpibGFjaztzdHJva2U6bm9uZTtmb250LXNpemU6MTBweDt9I2dyYXBoLWRpdiAuc3RhdGVMYWJlbCAuYm94e3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowO2ZpbGw6I0VDRUNGRjtvcGFjaXR5OjAuNTt9I2dyYXBoLWRpdiAuZWRnZUxhYmVsIC5sYWJlbCByZWN0e2ZpbGw6I0VDRUNGRjtvcGFjaXR5OjAuNTt9I2dyYXBoLWRpdiAuZWRnZUxhYmVsIC5sYWJlbCB0ZXh0e2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiAubGFiZWwgZGl2IC5lZGdlTGFiZWx7Y29sb3I6IzMzMzt9I2dyYXBoLWRpdiAuc3RhdGVMYWJlbCB0ZXh0e2ZpbGw6IzEzMTMwMDtmb250LXNpemU6MTBweDtmb250LXdlaWdodDpib2xkO30jZ3JhcGgtZGl2IC5ub2RlIGNpcmNsZS5zdGF0ZS1zdGFydHtmaWxsOiMzMzMzMzM7c3Ryb2tlOiMzMzMzMzM7fSNncmFwaC1kaXYgLm5vZGUgLmZvcmstam9pbntmaWxsOiMzMzMzMzM7c3Ryb2tlOiMzMzMzMzM7fSNncmFwaC1kaXYgLm5vZGUgY2lyY2xlLnN0YXRlLWVuZHtmaWxsOiM5MzcwREI7c3Ryb2tlOndoaXRlO3N0cm9rZS13aWR0aDoxLjU7fSNncmFwaC1kaXYgLmVuZC1zdGF0ZS1pbm5lcntmaWxsOndoaXRlO3N0cm9rZS13aWR0aDoxLjU7fSNncmFwaC1kaXYgLm5vZGUgcmVjdHtmaWxsOiNFQ0VDRkY7c3Ryb2tlOiM5MzcwREI7c3Ryb2tlLXdpZHRoOjFweDt9I2dyYXBoLWRpdiAubm9kZSBwb2x5Z29ue2ZpbGw6I0VDRUNGRjtzdHJva2U6IzkzNzBEQjtzdHJva2Utd2lkdGg6MXB4O30jZ3JhcGgtZGl2ICNzdGF0ZWRpYWdyYW0tYmFyYkVuZHtmaWxsOiMzMzMzMzM7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbS1jbHVzdGVyIHJlY3R7ZmlsbDojRUNFQ0ZGO3N0cm9rZTojOTM3MERCO3N0cm9rZS13aWR0aDoxcHg7fSNncmFwaC1kaXYgLmNsdXN0ZXItbGFiZWwsI2dyYXBoLWRpdiAubm9kZUxhYmVse2NvbG9yOiMxMzEzMDA7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbS1jbHVzdGVyIHJlY3Qub3V0ZXJ7cng6NXB4O3J5OjVweDt9I2dyYXBoLWRpdiAuc3RhdGVkaWFncmFtLXN0YXRlIC5kaXZpZGVye3N0cm9rZTojOTM3MERCO30jZ3JhcGgtZGl2IC5zdGF0ZWRpYWdyYW0tc3RhdGUgLnRpdGxlLXN0YXRle3J4OjVweDtyeTo1cHg7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbS1jbHVzdGVyLnN0YXRlZGlhZ3JhbS1jbHVzdGVyIC5pbm5lcntmaWxsOndoaXRlO30jZ3JhcGgtZGl2IC5zdGF0ZWRpYWdyYW0tY2x1c3Rlci5zdGF0ZWRpYWdyYW0tY2x1c3Rlci1hbHQgLmlubmVye2ZpbGw6I2YwZjBmMDt9I2dyYXBoLWRpdiAuc3RhdGVkaWFncmFtLWNsdXN0ZXIgLmlubmVye3J4OjA7cnk6MDt9I2dyYXBoLWRpdiAuc3RhdGVkaWFncmFtLXN0YXRlIHJlY3QuYmFzaWN7cng6NXB4O3J5OjVweDt9I2dyYXBoLWRpdiAuc3RhdGVkaWFncmFtLXN0YXRlIHJlY3QuZGl2aWRlcntzdHJva2UtZGFzaGFycmF5OjEwLDEwO2ZpbGw6I2YwZjBmMDt9I2dyYXBoLWRpdiAubm90ZS1lZGdle3N0cm9rZS1kYXNoYXJyYXk6NTt9I2dyYXBoLWRpdiAuc3RhdGVkaWFncmFtLW5vdGUgcmVjdHtmaWxsOiNmZmY1YWQ7c3Ryb2tlOiNhYWFhMzM7c3Ryb2tlLXdpZHRoOjFweDtyeDowO3J5OjA7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbS1ub3RlIHJlY3R7ZmlsbDojZmZmNWFkO3N0cm9rZTojYWFhYTMzO3N0cm9rZS13aWR0aDoxcHg7cng6MDtyeTowO30jZ3JhcGgtZGl2IC5zdGF0ZWRpYWdyYW0tbm90ZSB0ZXh0e2ZpbGw6YmxhY2s7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbS1ub3RlIC5ub2RlTGFiZWx7Y29sb3I6YmxhY2s7fSNncmFwaC1kaXYgLnN0YXRlZGlhZ3JhbSAuZWRnZUxhYmVse2NvbG9yOnJlZDt9I2dyYXBoLWRpdiAjZGVwZW5kZW5jeVN0YXJ0LCNncmFwaC1kaXYgI2RlcGVuZGVuY3lFbmR7ZmlsbDojMzMzMzMzO3N0cm9rZTojMzMzMzMzO3N0cm9rZS13aWR0aDoxO30jZ3JhcGgtZGl2IC5zdGF0ZWRpYWdyYW1UaXRsZVRleHR7dGV4dC1hbmNob3I6bWlkZGxlO2ZvbnQtc2l6ZToxOHB4O2ZpbGw6IzMzMzt9I2dyYXBoLWRpdiA6cm9vdHstLW1lcm1haWQtZm9udC1mYW1pbHk6InRyZWJ1Y2hldCBtcyIsdmVyZGFuYSxhcmlhbCxzYW5zLXNlcmlmO308L3N0eWxlPjxnPjxkZWZzPjxtYXJrZXIgb3JpZW50PSJhdXRvIiBtYXJrZXJVbml0cz0ic3Ryb2tlV2lkdGgiIG1hcmtlckhlaWdodD0iMTQiIG1hcmtlcldpZHRoPSIyMCIgcmVmWT0iNyIgcmVmWD0iMTkiIGlkPSJncmFwaC1kaXZfc3RhdGVkaWFncmFtLWJhcmJFbmQiPjxwYXRoIGQ9Ik0gMTksNyBMOSwxMyBMMTQsNyBMOSwxIFoiPjwvcGF0aD48L21hcmtlcj48L2RlZnM+PGcgY2xhc3M9InJvb3QiPjxnIGNsYXNzPSJjbHVzdGVycyI+PC9nPjxnIGNsYXNzPSJlZGdlUGF0aHMiPjwvZz48ZyBjbGFzcz0iZWRnZUxhYmVscyI+PC9nPjxnIGNsYXNzPSJub2RlcyI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC41LCAwKSIgY2xhc3M9InJvb3QiPjxnIGNsYXNzPSJjbHVzdGVycyI+PGcgaWQ9IkNsYXdfTWFjaGluZSIgY2xhc3M9InN0YXRlZGlhZ3JhbS1zdGF0ZSBzdGF0ZWRpYWdyYW0tY2x1c3RlciI+PHJlY3QgaGVpZ2h0PSIzNjMiIHdpZHRoPSI3NDkuMjc5MTc0ODA0Njg3NSIgeT0iOCIgeD0iOCIgY2xhc3M9Im91dGVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzMzLjcwNjI1MzA1MTc1NzgsIDgpIiBjbGFzcz0iY2x1c3Rlci1sYWJlbCI+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9Ijk3Ljg2NjY2ODcwMTE3MTg4Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyI+PHNwYW4gY2xhc3M9Im5vZGVMYWJlbCI+Q2xhdyBNYWNoaW5lPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PHJlY3QgaGVpZ2h0PSIzMzYiIHdpZHRoPSI3NDkuMjc5MTc0ODA0Njg3NSIgeT0iMzEiIHg9IjgiIGNsYXNzPSJpbm5lciI+PC9yZWN0PjwvZz48L2c+PGcgY2xhc3M9ImVkZ2VQYXRocyI+PHBhdGggbWFya2VyLWVuZD0idXJsKCNncmFwaC1kaXZfc3RhdGVkaWFncmFtLWJhcmJFbmQpIiBzdHlsZT0iZmlsbDpub25lIiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIHRyYW5zaXRpb24iIGlkPSJlZGdlMjQiIGQ9Ik0yOTIuOTc1LDYwLjI3TDI2NC4xNTEsNjguMzkxQzIzNS4zMjYsNzYuNTEzLDE3Ny42NzgsOTIuNzU3LDE1NS4xMjEsMTA3LjA0NUMxMzIuNTY1LDEyMS4zMzMsMTQ1LjEwMSwxMzMuNjY3LDE1MS4zNjksMTM5LjgzM0wxNTcuNjM3LDE0NiI+PC9wYXRoPjxwYXRoIG1hcmtlci1lbmQ9InVybCgjZ3JhcGgtZGl2X3N0YXRlZGlhZ3JhbS1iYXJiRW5kKSIgc3R5bGU9ImZpbGw6bm9uZSIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCB0cmFuc2l0aW9uIiBpZD0iZWRnZTI1IiBkPSJNMjQ5Ljg0NywxNDZMMjYxLjYzMSwxMzkuODMzQzI3My40MTUsMTMzLjY2NywyOTYuOTgyLDEyMS4zMzMsMzA4Ljc2NiwxMDlDMzIwLjU1LDk2LjY2NywzMjAuNTUsODQuMzMzLDMyMC41NSw3OC4xNjdMMzIwLjU1LDcyIj48L3BhdGg+PHBhdGggbWFya2VyLWVuZD0idXJsKCNncmFwaC1kaXZfc3RhdGVkaWFncmFtLWJhcmJFbmQpIiBzdHlsZT0iZmlsbDpub25lIiBjbGFzcz0iZWRnZS10aGlja25lc3Mtbm9ybWFsIHRyYW5zaXRpb24iIGlkPSJlZGdlMjYiIGQ9Ik0xODkuNjU0LDIwOUwxODkuNjU0LDIxNy4xNjdDMTg5LjY1NCwyMjUuMzMzLDE4OS42NTQsMjQxLjY2NywyMTAuNTU2LDI1OEMyMzEuNDU4LDI3NC4zMzMsMjczLjI2MiwyOTAuNjY3LDI5NC4xNjQsMjk4LjgzM0wzMTUuMDY2LDMwNyI+PC9wYXRoPjxwYXRoIG1hcmtlci1lbmQ9InVybCgjZ3JhcGgtZGl2X3N0YXRlZGlhZ3JhbS1iYXJiRW5kKSIgc3R5bGU9ImZpbGw6bm9uZSIgY2xhc3M9ImVkZ2UtdGhpY2tuZXNzLW5vcm1hbCB0cmFuc2l0aW9uIiBpZD0iZWRnZTI3IiBkPSJNNDE0Ljg4NCwzMDdMNDM1Ljc4NiwyOTguODMzQzQ1Ni42ODgsMjkwLjY2Nyw0OTguNDkyLDI3NC4zMzMsNTE5LjM5NCwyNTIuNzVDNTQwLjI5NiwyMzEuMTY3LDU0MC4yOTYsMjA0LjMzMyw1NDAuMjk2LDE3OS41QzU0MC4yOTYsMTU0LjY2Nyw1NDAuMjk2LDEzMS44MzMsNTA4LjI2NywxMTIuMTgyQzQ3Ni4yMzksOTIuNTMsNDEyLjE4Miw3Ni4wNiwzODAuMTUzLDY3LjgyNUwzNDguMTI1LDU5LjU5Ij48L3BhdGg+PC9nPjxnIGNsYXNzPSJlZGdlTGFiZWxzIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjAuMDI5MTY3MTc1MjkyOTcsIDEwOSkiIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01MC40MDAwMDE1MjU4Nzg5MDYsIC0xMikiIGNsYXNzPSJsYWJlbCI+PHJlY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjEwMC44MDAwMDMwNTE3NTc4MSIgcnk9IjAiIHJ4PSIwIj48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjEwMC44MDAwMDMwNTE3NTc4MSI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPmRyb3BBbmRIb21lPC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMyMC41NTAwMDMwNTE3NTc4LCAxMDkpIiBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNjguODQ5OTk4NDc0MTIxMSwgLTEyKSIgY2xhc3M9ImxhYmVsIj48cmVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTM3LjY5OTk5Njk0ODI0MjIiIHJ5PSIwIiByeD0iMCI+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iMjQiIHdpZHRoPSIxMzcuNjk5OTk2OTQ4MjQyMiI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiPjxzcGFuIGNsYXNzPSJlZGdlTGFiZWwiPmRvbmUuaW52b2tlLnBpY2tlcjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxODkuNjU0MTY3MTc1MjkyOTcsIDI1OCkiIGNsYXNzPSJlZGdlTGFiZWwiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC03Ni4xOTk5OTY5NDgyNDIxOSwgLTI0KSIgY2xhc3M9ImxhYmVsIj48cmVjdCBoZWlnaHQ9IjQ4IiB3aWR0aD0iMTUyLjM5OTk5Mzg5NjQ4NDM4IiByeT0iMCIgcng9IjAiPjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjQ4IiB3aWR0aD0iMTUyLjM5OTk5Mzg5NjQ4NDM4Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+ZXJyb3IucGxhdGZvcm0ucGlja2VyIDxici8+ZG8gLyBhc3NpZ25FcnJvcjwvc3Bhbj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PC9nPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NDAuMjk1ODM3NDAyMzQzOCwgMTc3LjUpIiBjbGFzcz0iZWRnZUxhYmVsIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTk2Ljk4MzMzNzQwMjM0Mzc1LCAtMjQpIiBjbGFzcz0ibGFiZWwiPjxyZWN0IGhlaWdodD0iNDgiIHdpZHRoPSIzOTMuOTY2Njc0ODA0Njg3NSIgcnk9IjAiIHJ4PSIwIj48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSI0OCIgd2lkdGg9IjM5My45NjY2NzQ4MDQ2ODc1Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aGl0ZS1zcGFjZTogbm93cmFwOyI+PHNwYW4gY2xhc3M9ImVkZ2VMYWJlbCI+eHN0YXRlLmFmdGVyKDIwMDApI0NsYXcgTWFjaGluZS5kaXNwbGF5aW5nUGlja2VyRXJyb3IgPGJyLz5kbyAvIGNsZWFyRXJyb3I8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PC9nPjxnIGNsYXNzPSJub2RlcyI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzIwLjU1MDAwMzA1MTc1NzgsIDUyLjUpIiBkYXRhLWlkPSJDbGF3X01hY2hpbmUucmVhZHkiIGRhdGEtbm9kZT0idHJ1ZSIgaWQ9InN0YXRlLUNsYXdfTWFjaGluZS5yZWFkeS0yOCIgY2xhc3M9Im5vZGUgIHN0YXRlZGlhZ3JhbS1zdGF0ZSB1bmRlZmluZWQiPjxyZWN0IGhlaWdodD0iMzkiIHdpZHRoPSI1NS4xNDk5OTM4OTY0ODQzNzUiIHk9Ii0xOS41IiB4PSItMjcuNTc0OTk2OTQ4MjQyMTg4IiBzdHlsZT0iIiBjbGFzcz0iYmFzaWMgbGFiZWwtY29udGFpbmVyIj48L3JlY3Q+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTIwLjA3NDk5Njk0ODI0MjE4OCwgLTEyKSIgc3R5bGU9IiIgY2xhc3M9ImxhYmVsIj48cmVjdD48L3JlY3Q+PGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIyNCIgd2lkdGg9IjQwLjE0OTk5Mzg5NjQ4NDM3NSI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgd2hpdGUtc3BhY2U6IG5vd3JhcDsiPjxzcGFuIGNsYXNzPSJub2RlTGFiZWwiPnJlYWR5PC9zcGFuPjwvZGl2PjwvZm9yZWlnbk9iamVjdD48L2c+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4OS42NTQxNjcxNzUyOTI5NywgMTc3LjUpIiBkYXRhLWlkPSJDbGF3X01hY2hpbmUucGlja2luZyIgZGF0YS1ub2RlPSJ0cnVlIiBpZD0ic3RhdGUtQ2xhd19NYWNoaW5lLnBpY2tpbmctMjgiIGNsYXNzPSJub2RlICBzdGF0ZWRpYWdyYW0tc3RhdGUgdW5kZWZpbmVkIj48cmVjdCBoZWlnaHQ9IjYzIiB3aWR0aD0iMjM3LjMxNjY2NTY0OTQxNDA2IiB5PSItMzEuNSIgeD0iLTExOC42NTgzMzI4MjQ3MDcwMyIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xMTEuMTU4MzMyODI0NzA3MDMsIC0yNCkiIHN0eWxlPSIiIGNsYXNzPSJsYWJlbCI+PHJlY3Q+PC9yZWN0Pjxmb3JlaWduT2JqZWN0IGhlaWdodD0iNDgiIHdpZHRoPSIyMjIuMzE2NjY1NjQ5NDE0MDYiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7Ij48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5waWNraW5nPGJyLz5pbnZva2UgLyBkcm9wSGFuZGxlciBhcyBwaWNrZXI8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzY0Ljk3NTAwMjI4ODgxODM2LCAzMjYuNSkiIGRhdGEtaWQ9IkNsYXdfTWFjaGluZS5kaXNwbGF5aW5nUGlja2VyRXJyb3IiIGRhdGEtbm9kZT0idHJ1ZSIgaWQ9InN0YXRlLUNsYXdfTWFjaGluZS5kaXNwbGF5aW5nUGlja2VyRXJyb3ItMjgiIGNsYXNzPSJub2RlICBzdGF0ZWRpYWdyYW0tc3RhdGUgdW5kZWZpbmVkIj48cmVjdCBoZWlnaHQ9IjM5IiB3aWR0aD0iMTY1LjY5OTk5Njk0ODI0MjIiIHk9Ii0xOS41IiB4PSItODIuODQ5OTk4NDc0MTIxMSIgc3R5bGU9IiIgY2xhc3M9ImJhc2ljIGxhYmVsLWNvbnRhaW5lciI+PC9yZWN0PjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC03NS4zNDk5OTg0NzQxMjExLCAtMTIpIiBzdHlsZT0iIiBjbGFzcz0ibGFiZWwiPjxyZWN0PjwvcmVjdD48Zm9yZWlnbk9iamVjdCBoZWlnaHQ9IjI0IiB3aWR0aD0iMTUwLjY5OTk5Njk0ODI0MjIiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdoaXRlLXNwYWNlOiBub3dyYXA7Ij48c3BhbiBjbGFzcz0ibm9kZUxhYmVsIj5kaXNwbGF5aW5nUGlja2VyRXJyb3I8L3NwYW4+PC9kaXY+PC9mb3JlaWduT2JqZWN0PjwvZz48L2c+PC9nPjwvZz48L2c+PC9nPjwvZz48L3N2Zz4=" width="765" height="379" class="img_ev3q"></p>
<p>The final action will look nearly identical to the previous one: we execute the <code>dropAndHome</code> action to transition into the <code>picking</code> state to invoke the <code>dropHandler</code> actor. Rather than include <code>picking</code> as an option in the <code>armMover</code> inputs, we keep this more complex workflow separate to leave opportunity to optimize later.</p>
<p>Even before including the generated state machine configuration in the codebase, this high level view of the robot's control logic is a fantastic tool for including in the documentation and teaching other members of the team how it should work.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="refactoring-the-code">Refactoring the code<a href="https://ouweiya.github.io/xstate-zh/blog/2024-07-29-claw-game-state-machine#refactoring-the-code" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>To kick off the implementation of this state machine, I took the generated TypeScript code for XState v5 from Stately Studio and added it to the <code>main.ts</code> for the claw game app to start filling in the actions and actors.</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> clawMachine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  types</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> ClawMachineContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// abstracted to explict types for readability</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    events</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> ClawMachineEvent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// abstracted to explict types for readability</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    assignClients</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">assign</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">motionClient</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> ClientNameParams</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">MotionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">machineClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">motionClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">boardClient</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> ClientNameParams</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">BoardClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">machineClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">boardClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">armClient</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> ClientNameParams</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">ArmClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">machineClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">armClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">gripperClient</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> ClientNameParams</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">GripperClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">machineClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">gripperClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    assignError</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">assign</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> Error </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    assignRobotClient</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">assign</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">machineClient</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> client</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> Client </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">client</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    clearError</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">assign</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    styleMove</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> _params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> state</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'moving'</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'error'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">logError</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> Error </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  actors</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    createRobotClient</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token generic-function function" style="color:hsl(221, 87%, 60%)">fromPromise</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">      Client</span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">      </span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> apiKey</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> </span><span class="token generic-function generic class-name builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> apiKeyId</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> </span><span class="token generic-function generic class-name builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> locationAddress</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> </span><span class="token generic-function generic class-name builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> </span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">    </span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> input </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> credential </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'api-key'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        payload</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">apiKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token comment" style="color:hsl(230, 4%, 64%)">//This is the host address of the main part of your robot.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> host </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">locationAddress</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createRobotClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        host</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        credential</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        authEntity</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">apiKeyId</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        signalingAddress</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'https://app.viam.com:443'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    moveHandler</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token generic-function function" style="color:hsl(221, 87%, 60%)">fromPromise</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token generic-function generic class-name keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> MoveInput</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> input </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">target </span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'quadrant'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">moveToQuadrant</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">target </span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'planar'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">inPlaneMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    dropHandler</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token generic-function function" style="color:hsl(221, 87%, 60%)">fromPromise</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token generic-function generic class-name keyword" style="color:hsl(301, 63%, 40%)">void</span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> ClawMachineContext </span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">&amp;</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> </span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> moveHeight</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> </span><span class="token generic-function generic class-name builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> </span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> input </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">zMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">240</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">grab</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">boardClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">gripperClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">delay</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">zMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">moveHeight</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">home</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">motionClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">armClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">delay</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">1000</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">await</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">release</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">boardClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">gripperClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> ClawMachineContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  id</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'Claw Machine'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  initial</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'initializing'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  states</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    initializing</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      on</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        connect</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'connectingToMachine'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    connectingToMachine</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      invoke</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        id</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'clientConnection'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        input</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          apiKey</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> robotAPIKey</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          apiKeyId</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> robotAPIKeyID</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          locationAddress</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> robotLocation</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        onDone</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'connected'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'assignRobotClient'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> client</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">output </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        onError</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'clientErrored'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'assignError'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">error </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> Error </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'logError'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">error </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> Error </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        src</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'createRobotClient'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    connected</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      always</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      entry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'assignClients'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          motionClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          boardClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          armClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          gripperClientName</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    clientErrored</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      entry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'styleMove'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> state</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'error'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      on</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        retry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'initializing'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'clearError'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ready</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      entry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'styleMove'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> state</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      on</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        move</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'moving'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        dropAndHome</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'picking'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    moving</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      entry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'styleMove'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> state</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'moving'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      invoke</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        id</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'armMover'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">input</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token function" style="color:hsl(221, 87%, 60%)">assertEvent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'move'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">target </span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'home'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">...</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">target </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token operator" style="color:hsl(221, 87%, 60%)">...</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">target</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            x</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            y</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">y</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        onDone</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        onError</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'displayingMoveError'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'assignError'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">error </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> Error </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'logError'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">error </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> Error </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        src</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'moveHandler'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    picking</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      entry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'styleMove'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> state</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'moving'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      invoke</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        id</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'picker'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">input</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">...</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> moveHeight </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        onDone</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        onError</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'displayingPickerError'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'assignError'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">error </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> Error </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'logError'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> error</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">error </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> Error </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        src</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'dropHandler'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    displayingMoveError</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      entry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'styleMove'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> state</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'error'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      after</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string-property property" style="color:hsl(5, 74%, 59%)">'3000'</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'clearError'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    displayingPickerError</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      entry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'styleMove'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> state</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'error'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      after</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string-property property" style="color:hsl(5, 74%, 59%)">'2000'</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'clearError'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If we compare the <code>moveHandler</code> and <code>dropHandler</code> actors to the original code, they are essentially the same as before but with the success and error handling lifted up to the state machine level.</p>
<p>You might also notice the <code>styleMove</code> helper being used as an explicit entry action for the necessary states and making it more consistent than before.</p>
<p>With this <code>clawMachine</code> configured, the body of the <code>main</code> function has been dramatically reduced:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">main</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> clawMachineActor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    clawMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">provide</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> styleMove </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">body</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">addEventListener</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'pointerdown'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">target </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">instanceof</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">HTMLElement</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token string" style="color:hsl(119, 34%, 47%)">'event'</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">target</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">dataset</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        event</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> machineEvent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        target</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        x </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'0'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        y </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'0'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">target</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">dataset</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">machineEvent </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'move'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">target </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'planar'</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">||</span><span class="token plain"> target </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'quadrant'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          clawMachineActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> machineEvent</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            target</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            x</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">parseInt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            y</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">parseInt</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">y</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">machineEvent </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'dropAndHome'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        clawMachineActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> machineEvent </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  clawMachineActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">start</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  clawMachineActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'connect'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>styleMove</code> action is configured here rather than including it by default in the <code>clawMachine</code> configuration as a personal preference to keep DOM logic separate. While I was working on this, I decided to simplify <code>styleMove</code> as well since it just needed the current state reflected in the HTML to conditionally style the grid (it could be a one-liner without the safety check):</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">styleMove</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> state</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'moving'</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'error'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> container </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> document</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getElementById</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'grid-container'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">container </span><span class="token operator" style="color:hsl(221, 87%, 60%)">==</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">null</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  container</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">dataset</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">state </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The updated CSS:</p>
<div class="language-css codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-css codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token selector class" style="color:hsl(119, 34%, 47%)">.grid-container</span><span class="token selector attribute punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token selector attribute attr-name" style="color:hsl(35, 99%, 36%)">data-state</span><span class="token selector attribute operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token selector attribute attr-value" style="color:hsl(119, 34%, 47%)">'ready'</span><span class="token selector attribute punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token property" style="color:hsl(5, 74%, 59%)">background-color</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token hexcode color">#6ded8a</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token selector class" style="color:hsl(119, 34%, 47%)">.grid-container</span><span class="token selector attribute punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token selector attribute attr-name" style="color:hsl(35, 99%, 36%)">data-state</span><span class="token selector attribute operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token selector attribute attr-value" style="color:hsl(119, 34%, 47%)">'moving'</span><span class="token selector attribute punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token property" style="color:hsl(5, 74%, 59%)">background-color</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token hexcode color">#ffee99</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token selector class" style="color:hsl(119, 34%, 47%)">.grid-container</span><span class="token selector attribute punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token selector attribute attr-name" style="color:hsl(35, 99%, 36%)">data-state</span><span class="token selector attribute operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token selector attribute attr-value" style="color:hsl(119, 34%, 47%)">'error'</span><span class="token selector attribute punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token property" style="color:hsl(5, 74%, 59%)">background-color</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">:</span><span class="token plain"> </span><span class="token hexcode color">#aa0000</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The event handler for the claw game buttons was also refactored a bit to reduce the amount of redundant TypeScript code by specifying the action inputs as data attributes on the static HTML:</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)">  </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">forward-button</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)">  </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">grid-arrow grid-arrow-up</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)">  </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">data-event</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">move</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)">  </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">data-target</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">planar</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)">  </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">data-x</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">-20</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)">  </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">data-y</span><span class="token tag attr-value punctuation attr-equals" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag attr-value" style="color:hsl(119, 34%, 47%)">0</span><span class="token tag attr-value punctuation" style="color:hsl(119, 34%, 47%)">"</span><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token tag" style="color:hsl(5, 74%, 59%)"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  Forward</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now it is just a single, delegated event handler to send events to the <code>clawMachine</code> with all the guards and error handling guaranteed!</p>
<p>Once the modeling was complete, the process of refactoring the code to use <code>xstate</code> took less than an hour thanks to my familiarity with the library and the clearer understanding of how Viam API interactions would slot into the state machine configuration.</p>
<p>You can view the full refactor PR here: <a href="https://github.com/viam-labs/claw-game/pull/17" target="_blank" rel="noopener noreferrer">https://github.com/viam-labs/claw-game/pull/17</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reflecting">Reflecting<a href="https://ouweiya.github.io/xstate-zh/blog/2024-07-29-claw-game-state-machine#reflecting" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>View it in action:</p>
<iframe width="300" height="500" src="https://www.youtube.com/embed/_bJADuMUDq8" title="Robot Arcade Claw Game in Action!" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin"></iframe>
<p>Overall, I found the whole process from visualizing the logic to plugging the generated code into my web app incredibly fruitful. I've already identified ways to extend and improve the machine as needed, like adding error capturing in place of the default <code>logError</code> action and breaking out the <code>dropHandler</code> Promise actor into an explicit state machine actor. I hope folks on my team and in the <a href="https://discord.gg/viam" target="_blank" rel="noopener noreferrer">Viam community</a> will understand this application better with this refactor in place.</p>
<p>Happy Building!</p>]]></content>
        <author>
            <name>Nick Hehr</name>
            <uri>https://github.com/hipsterbrown</uri>
        </author>
        <category label="case study" term="case study"/>
        <category label="study" term="study"/>
        <category label="viam" term="viam"/>
        <category label="xstate" term="xstate"/>
        <category label="state machines" term="state machines"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä»‹ç» XState Store]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-04-10-xstate-store</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-04-10-xstate-store"/>
        <updated>2024-04-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[ä¸€ä¸ªå— XState å¯å‘çš„ç®€å•ä¸”å°å·§çš„çŠ¶æ€ç®¡ç†åº“]]></summary>
        <content type="html"><![CDATA[<p>ä¸–ç•Œéœ€è¦å¦ä¸€ä¸ªçŠ¶æ€ç®¡ç†åº“å—ï¼Ÿå¯èƒ½ä¸éœ€è¦ï¼Œä½†å¦‚æžœä½ å¯¹ XState æ„Ÿå…´è¶£ï¼Œä½ ä¸€å®šè¦çœ‹çœ‹è¿™ä¸ªã€‚</p>
<p>XState Store æ˜¯ä¸€ä¸ªå— XState å¯å‘çš„ç®€å•ä¸”å°å·§çš„çŠ¶æ€ç®¡ç†åº“ã€‚å¦‚æžœä½ åªéœ€è¦ä¸€ç§æ–¹æ³•æ¥æ›´æ–°å­˜å‚¨ä¸­çš„æ•°æ®å¹¶è®¢é˜…å­˜å‚¨ä¸­çš„æ›´æ”¹ï¼ŒXState Store é€‚åˆä½ ã€‚å®ƒæ˜¯ï¼š</p>
<ul>
<li><strong>æžå…¶ç®€å•</strong>ã€‚æä¾›åˆå§‹ä¸Šä¸‹æ–‡å’Œè¿‡æ¸¡å‡½æ•°ç»™ <code>createStore(â€¦)</code> å‡½æ•°ï¼Œä½ å°±å¯ä»¥å¼€å§‹äº†ã€‚</li>
<li><strong>æžå…¶å°å·§</strong>ã€‚åŽ‹ç¼©åŽå°äºŽ 1kbã€‚</li>
<li><strong>ä¸Ž XState å…¼å®¹</strong>ã€‚å…±äº«ä¸Ž XState ç›¸åŒçš„ actor APIï¼Œä½¿å¾—åœ¨éœ€è¦å¤„ç†æ›´å¤šå¤æ‚æ€§æ—¶ï¼Œé›†æˆ/è¿ç§»å˜å¾—å®¹æ˜“ã€‚</li>
<li><strong>é¢å¤–çš„ç±»åž‹å®‰å…¨</strong>ã€‚ç”¨ TypeScript ç¼–å†™ï¼Œè‡ªåŠ¨ä»Žä½ çš„ä¸Šä¸‹æ–‡å’Œè¿‡æ¸¡ä¸­æŽ¨æ–­å‡ºå¼ºç±»åž‹çš„äº‹ä»¶å’Œå¿«ç…§ã€‚</li>
<li><strong>åŸºäºŽäº‹ä»¶</strong>ã€‚ä¸Ž XState ä¸€æ ·å·¥ä½œï¼›å‘é€äº‹ä»¶ä»¥è§¦å‘è¿‡æ¸¡ã€‚</li>
<li><strong>æ”¯æŒ Immer</strong>ã€‚é€šè¿‡ <code>createStoreWithProducer(producer, â€¦)</code> è½»æ¾æ·»åŠ  <a href="https://github.com/immerjs/immer" target="_blank" rel="noopener noreferrer">Immer</a> ä»¥è¿›è¡Œâ€œå¯å˜â€ä¸Šä¸‹æ–‡æ›´æ–°ã€‚</li>
</ul>
<!-- -->
<aside class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>é˜…è¯» <a href="https://ouweiya.github.io/xstate-zh/docs/xstate-store"><code>@xstate/store</code> æ–‡æ¡£</a> äº†è§£æ›´å¤šä¿¡æ¯ã€‚</p></div></aside>
<p>é€šè¿‡ <a href="https://www.npmjs.com/package/@xstate/store" target="_blank" rel="noopener noreferrer">npm</a> å®‰è£…ï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">npm install @xstate/store</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åˆ›å»ºä½ çš„å­˜å‚¨å¹¶åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨å®ƒï¼š</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createStore </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/store'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> store </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  inc</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> event</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> by</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">count </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">by</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">store</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">subscribe</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">snapshot</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">snapshot</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">store</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'inc'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> by</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// logs { count: 1 }</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">store</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'inc'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> by</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// logs { count: 3 }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å³ä½¿åœ¨ React ä¸­ï¼š</p>
<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> useSelector </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/store/react'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> store </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'./store'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">Counter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> count </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useSelector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">store</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> store</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token tag script language-javascript method function property-access" style="color:hsl(221, 87%, 60%)">send</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> type</span><span class="token tag script language-javascript operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript string" style="color:hsl(119, 34%, 47%)">'inc'</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> by</span><span class="token tag script language-javascript operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript number" style="color:hsl(35, 99%, 36%)">1</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">  </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="åŠ¨æœº">åŠ¨æœº<a href="https://ouweiya.github.io/xstate-zh/blog/2024-04-10-xstate-store#%E5%8A%A8%E6%9C%BA" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>å¸‚é¢ä¸Šæœ‰å¾ˆå¤šçŠ¶æ€ç®¡ç†åº“ï¼Œå¦‚ XStateã€Reduxã€MobXã€Zustandã€Pinia ç­‰ã€‚å®ƒä»¬é€šå¸¸åˆ†ä¸ºä¸¤ç±»ï¼š<strong>ç›´æŽ¥</strong>å’Œ<strong>é—´æŽ¥</strong>çŠ¶æ€æ“ä½œã€‚</p>
<ul>
<li>ç›´æŽ¥çŠ¶æ€æ“ä½œæœ€ç®€å•ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•åœ°æ–¹ã€ä»»ä½•æ—¶é—´ç›´æŽ¥æ›´æ–°çŠ¶æ€ã€‚ç„¶è€Œï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯å’Œä¸å¯é¢„æµ‹çš„è¡Œä¸ºï¼Œå› ä¸ºé€»è¾‘æ²¡æœ‰é›†ä¸­ï¼Œéœ€è¦å¤§é‡çš„é˜²å¾¡æ€§ç¼–ç¨‹ã€‚</li>
<li>é—´æŽ¥çŠ¶æ€æ“ä½œæœ€ç®€å•ï¼Œå› ä¸ºä½ å¯ä»¥å°†æ‰€æœ‰çŠ¶æ€æ“ä½œé›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚è¿™å¯èƒ½ä¼šæœ‰ç‚¹å†—é•¿ï¼Œå› ä¸ºä½ éœ€è¦å‘é€/æ´¾å‘äº‹ä»¶ï¼ˆæˆ–åœ¨ Redux æœ¯è¯­ä¸­ç§°ä¸ºâ€œåŠ¨ä½œâ€ï¼‰åˆ°ä¸€ä¸ªé›†ä¸­ä½ç½®ï¼Œä½†è¿™æ„å‘³ç€ä½ æœ‰ä¸€ä¸ªåº”ç”¨é€»è¾‘çš„å•ä¸€äº‹å®žæ¥æºã€‚è¿™ç§é›†ä¸­æ¥æºä½¿å¾—æµ‹è¯•ã€æ£€æŸ¥ã€è°ƒè¯•å’Œé‡ç”¨å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</li>
</ul>
<p><a href="https://stately.ai/docs/xstate" target="_blank" rel="noopener noreferrer">XState</a> é€‰æ‹©äº†ä¸€æ¡å°‘æœ‰äººèµ°çš„è·¯ï¼Œå¼ºçƒˆæŽ¨å´‡é—´æŽ¥çŠ¶æ€æ“ä½œï¼Œå› ä¸ºå®ƒå¯ä»¥æ›´å¥½åœ°æ‰©å±•æ›´å¤æ‚çš„åº”ç”¨é€»è¾‘ã€‚ç„¶è€Œï¼ŒXState æœ‰ä¸€ä¸ªç›¸å½“å¤§çš„å­¦ä¹ æ›²çº¿ï¼Œå› ä¸ºå®ƒè¿˜å®žçŽ°äº†çŠ¶æ€æœºã€çŠ¶æ€å›¾å’Œ actor æ¨¡åž‹â€”â€”æ‰€æœ‰è¿™äº›å¯¹äºŽè®¸å¤šå¼€å‘è€…æ¥è¯´éƒ½æ˜¯æ–°çš„ï¼ˆä¸”é‡è¦çš„ï¼ï¼‰æ¦‚å¿µã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬çœ‹åˆ°å›¢é˜Ÿä¸ä»…ä½¿ç”¨ XState è¿›è¡Œå¤æ‚çš„çŠ¶æ€ç®¡ç†ï¼Œè¿˜ç”¨äºŽç®€å•çš„æ•°æ®æ›´æ–°ï¼Œè€Œä½¿ç”¨å®Œæ•´çš„çŠ¶æ€æœºå¯èƒ½æœ‰äº›è¿‡å¤´ã€‚</p>
<p>ä¸ºäº†ä¸è®©å¼€å‘è€…åœ¨ç®€å•çŠ¶æ€ç®¡ç†æ—¶ç¦»å¼€ XState ç”Ÿæ€ç³»ç»Ÿï¼Œæˆ‘ä»¬åˆ›å»ºäº† <code>@xstate/store</code>ï¼Œå®ƒä¸Ž XState å…±äº«ç›¸åŒçš„åŽŸåˆ™ï¼Œå…·æœ‰ç›¸åŒçš„ APIï¼Œä½†æ›´ç®€å•æ˜“ç”¨ã€‚å¦‚æžœä½ éœ€è¦æ‰©å±•åˆ°æ›´å¤æ‚çš„çŠ¶æ€ç®¡ç†ï¼Œä½ å¯ä»¥è½»æ¾è¿ç§»åˆ° XStateã€‚</p>
<p>æ€»ä¹‹ï¼Œå¦‚æžœä½ åªéœ€è¦ä¸€ç§æ–¹æ³•æ¥æ›´æ–°å­˜å‚¨ä¸­çš„æ•°æ®å¹¶è®¢é˜…å­˜å‚¨ä¸­çš„æ›´æ”¹ï¼Œå¹¶ä¸Žåº”ç”¨ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†å…±äº«è¿™äº›æ•°æ®ï¼Œè¯·ä½¿ç”¨ <code>@xstate/store</code>ã€‚å¦‚æžœä½ éœ€è¦æ›´å¤æ‚çš„çŠ¶æ€ç®¡ç†ï¼ŒåŒ…æ‹¬æœ‰é™çŠ¶æ€ã€æ•ˆæžœï¼ˆåŠ¨ä½œã€è°ƒç”¨/ç”Ÿæˆçš„ actorï¼‰ï¼Œè¯·ä½¿ç”¨ XStateã€‚</p>
<table><thead><tr><th>åŠŸèƒ½</th><th><code>@xstate/store</code></th><th><code>xstate</code></th></tr></thead><tbody><tr><td>æœ‰é™çŠ¶æ€</td><td>âŒ</td><td>âœ…</td></tr><tr><td>ä¸Šä¸‹æ–‡</td><td>âœ…</td><td>âœ…</td></tr><tr><td>äº‹ä»¶</td><td>âœ…</td><td>âœ…</td></tr><tr><td>è¿‡æ¸¡</td><td>âœ…</td><td>âœ…</td></tr><tr><td>å®ˆå«</td><td>âŒ</td><td>âœ…</td></tr><tr><td>æ•ˆæžœ</td><td>âŒ</td><td>âœ…</td></tr><tr><td>Actor æ¨¡åž‹</td><td>âŒ</td><td>âœ…</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="è¶…ç®€å•ç¤ºä¾‹">è¶…ç®€å•ç¤ºä¾‹<a href="https://ouweiya.github.io/xstate-zh/blog/2024-04-10-xstate-store#%E8%B6%85%E7%AE%80%E5%8D%95%E7%A4%BA%E4%BE%8B" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>è¿™æ˜¯ä¸€ä¸ªäººä¸ºçš„ç¤ºä¾‹ï¼Œç”¨äºŽæ¼”ç¤º APIã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createStore </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/store'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 1. åˆ›å»ºä¸€ä¸ªå­˜å‚¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> donutStore </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åˆå§‹ä¸Šä¸‹æ–‡æ•°æ®</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> donuts</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> favoriteFlavor</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'chocolate'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¿‡æ¸¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    addDonut</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">donuts</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">donuts </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    changeFlavor</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">favoriteFlavor</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> event</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> flavor</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">flavor</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    eatAllDonuts</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      donuts</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">store</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">getSnapshot</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//   status: 'active',</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//   context: {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//     donuts: 0,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//     favoriteFlavor: 'chocolate'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">//   }</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// }</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 2. è®¢é˜…å­˜å‚¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">store</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">subscribe</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">snapshot</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">snapshot</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// 3. å‘é€äº‹ä»¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">store</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'addDonut'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// logs { donuts: 1, favoriteFlavor: 'chocolate' }</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">store</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'changeFlavor'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  flavor</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'strawberry'</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Strongly-typed!</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// logs { donuts; 1, favoriteFlavor: 'strawberry' }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ€»ä½“è€Œè¨€ï¼ŒAPI æ˜¯ï¼š</p>
<ol>
<li>ä½¿ç”¨ <code>createStore(initialContext, transitions)</code> åˆ›å»ºä¸€ä¸ªå­˜å‚¨ã€‚</li>
<li>ä½¿ç”¨ <code>store.subscribe(callback)</code> è®¢é˜…è¯¥å­˜å‚¨çš„æ›´æ–°ã€‚</li>
<li>ä½¿ç”¨ <code>store.send(event)</code> å‘é€äº‹ä»¶ä»¥è§¦å‘è¿‡æ¸¡ã€‚</li>
<li>ï¼ˆå¯é€‰ï¼‰ä½¿ç”¨ <code>store.getSnapshot()</code> èŽ·å–å­˜å‚¨çš„å½“å‰å¿«ç…§ã€‚</li>
</ol>
<aside class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>é˜…è¯» <a href="https://ouweiya.github.io/xstate-zh/docs/xstate-store"><code>@xstate/store</code> æ–‡æ¡£</a> äº†è§£æ›´å¤šä¿¡æ¯ã€‚</p></div></aside>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="è¶…èƒ½åŠ›">è¶…èƒ½åŠ›<a href="https://ouweiya.github.io/xstate-zh/blog/2024-04-10-xstate-store#%E8%B6%85%E8%83%BD%E5%8A%9B" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>æˆ‘ä»¬åœ¨ <code>@xstate/store</code> ä¸­åŠ å…¥äº†ä¸€äº›ä¸é”™çš„åŠŸèƒ½ï¼Œä½¿çŠ¶æ€ç®¡ç†å°½å¯èƒ½é¡ºåˆ©ã€‚â›µï¸</p>
<p>é¦–å…ˆï¼Œä½ å¯ä»¥å¼€ç®±å³ç”¨åœ°èŽ·å¾—<strong>å¼ºç±»åž‹</strong>ï¼Œé€‚ç”¨äºŽçŠ¶æ€ä¸Šä¸‹æ–‡å’Œäº‹ä»¶ï¼Œè€Œæ— éœ€ç¼–å†™ä»»ä½•å°´å°¬çš„æ³›åž‹ç±»åž‹å‚æ•°ã€‚å½“ç„¶ï¼Œintellisense å¯¹ <code>store.send({ â€¦ })</code> ä¸­çš„äº‹ä»¶ä¹Ÿèƒ½å¾ˆå¥½åœ°å·¥ä½œã€‚è¯·æ³¨æ„ï¼Œè¦ä½¿è¿™ç§é­”æ³•ç”Ÿæ•ˆï¼Œéœ€è¦ TypeScript ç‰ˆæœ¬ 5.4 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createStore </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/store'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> store </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  inc</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> event</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> by</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">count </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">by</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">store</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'inc'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¼ºç±»åž‹ï¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  by</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¹Ÿæ˜¯å¼ºç±»åž‹ï¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// @ts-expect-error</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">store</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'unknownEvent'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å…¶æ¬¡ï¼Œæœ‰ä¸€äº›æ–¹ä¾¿çš„æ–¹æ³•å¯ä»¥åœ¨è¿‡æ¸¡ä¸­æ›´æ–° <code>context</code>ï¼Œç±»ä¼¼äºŽåœ¨ XState ä¸­ä½¿ç”¨ <code>assign(â€¦)</code>ã€‚ä½ å¯ä»¥ï¼š</p>
<ul>
<li>ä½¿ç”¨å¯¹è±¡æ¥æ›´æ–°ç‰¹å®šçš„ <code>context</code> å±žæ€§ï¼š<!-- -->
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> store </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  inc</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> event</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> by</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">count </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">by</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>ä½¿ç”¨å¯¹è±¡å°† <code>context</code> å±žæ€§æ›´æ–°ä¸ºé™æ€å€¼ï¼š<!-- -->
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> store </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  reset</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¸éœ€è¦å‡½æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>ä½¿ç”¨å‡½æ•°æ›´æ–°æ•´ä¸ª <code>context</code>ï¼ˆå¯ä»¥æ˜¯éƒ¨åˆ†æˆ–å…¨éƒ¨æ›´æ–°ï¼‰ï¼š<!-- -->
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> store </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createStore</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  greeting</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'Hello'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">adios</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> greeting</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'Goodbye'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¸Ž { count } åˆå¹¶</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>ä½†æ˜¯ï¼Œå¦‚æžœä½ æƒ³è®©å¤æ‚çš„ <code>context</code> æ›´æ–°å˜å¾—æ›´å®¹æ˜“ï¼Œä½ å¯ä»¥é€šè¿‡å°† <a href="https://immerjs.github.io/immer/docs/introduction" target="_blank" rel="noopener noreferrer">Immer</a> çš„ <code>producer</code> å‡½æ•°æ’å…¥åˆ° <code>createStoreWithProducer(producer, â€¦)</code> ä¸­æ¥è½»æ¾ä½¿ç”¨ Immerï¼š</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createStoreWithProducer </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/store'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> produce </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'immer'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> store </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createStoreWithProducer</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  produce</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    todos</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">addTodo</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> event</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> todo</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">todos</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">push</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">todo</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æŽ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆ">æŽ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆ<a href="https://ouweiya.github.io/xstate-zh/blog/2024-04-10-xstate-store#%E6%8E%A5%E4%B8%8B%E6%9D%A5%E6%98%AF%E4%BB%80%E4%B9%88" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p><code>@xstate/store</code> ä¸è®¡åˆ’æ·»åŠ æ–°åŠŸèƒ½ï¼Œå› ä¸ºå®ƒæ—¨åœ¨ä¿æŒå°å·§ã€ç®€å•å’Œä¸“æ³¨ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¸Œæœ›æ·»åŠ ä¸Žå…¶ä»–æ¡†æž¶ï¼ˆå¦‚ Vueã€Angularã€Svelteã€Solid ç­‰ï¼‰çš„é›†æˆï¼Œå¹¶éžå¸¸æ„Ÿè°¢ç¤¾åŒºå¯¹æ­¤çš„è´¡çŒ®ã€‚æˆ‘ä»¬ä¹Ÿä¸ä¼šå¿˜è®°ç¤ºä¾‹ï¼›è¯·å…³æ³¨ XState ä»“åº“çš„ <code>/examples</code> ç›®å½•ä¸­çš„ç¤ºä¾‹ï¼Œä¾‹å¦‚<a href="https://github.com/statelyai/xstate/tree/main/examples/store-counter-react" target="_blank" rel="noopener noreferrer">è¿™ä¸ªå°åž‹ React è®¡æ•°å™¨ç¤ºä¾‹</a>ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼ŒæŽ¥ä¸‹æ¥ä½ è¦åšçš„å°±æ˜¯è¯•ç”¨å®ƒï¼å¦‚æžœä½ ä½¿ç”¨è¿‡ Zustandã€Reduxã€Pinia æˆ– XStateï¼Œä½ ä¼šå‘çŽ° <code>@xstate/store</code> éžå¸¸ç†Ÿæ‚‰ã€‚è¯·è®°ä½ï¼Œä½ åº”è¯¥é€‰æ‹©æœ€é€‚åˆä½ éœ€æ±‚å’Œå›¢é˜Ÿåå¥½çš„çŠ¶æ€ç®¡ç†åº“ã€‚ç„¶è€Œï¼Œå¦‚æžœéœ€è¦ï¼Œè¿ç§»åˆ°ï¼ˆæˆ–ä»Žï¼‰<code>@xstate/store</code> åˆ° Reduxã€Zustandã€Piniaã€XState æˆ–å…¶ä»–çŠ¶æ€ç®¡ç†åº“æ˜¯å¾ˆç®€å•çš„ã€‚</p>
<p>æˆ‘ä»¬å¯¹ <code>@xstate/store</code> çš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªç®€å•ä½†å¼ºå¤§çš„_åŸºäºŽäº‹ä»¶_çš„çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”æ˜¯ç±»åž‹å®‰å…¨çš„ã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œé—´æŽ¥ï¼ˆåŸºäºŽäº‹ä»¶ï¼‰çš„çŠ¶æ€ç®¡ç†å¯ä»¥æ›´å¥½åœ°ç»„ç»‡åº”ç”¨é€»è¾‘ï¼Œç‰¹åˆ«æ˜¯å½“å®ƒå˜å¾—å¤æ‚æ—¶ï¼Œè€Œ <code>@xstate/store</code> æ˜¯è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚</p>
<p>è¯•è¯•çœ‹å§ï¼Œå¦‚æžœæœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶åœ¨<a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">æˆ‘ä»¬çš„ Discord</a> ä¸­æé—®ï¼Œæˆ–åœ¨ <a href="https://github.com/statelyai/xstate/issues" target="_blank" rel="noopener noreferrer">XState GitHub ä»“åº“</a> ä¸­æŠ¥å‘Šé”™è¯¯ã€‚æˆ‘ä»¬ä¸€ç›´åœ¨å¯»æ‰¾æ”¹è¿›ä½“éªŒçš„åé¦ˆï¼</p>]]></content>
        <author>
            <name>David Khourshid</name>
            <uri>https://github.com/davidkpiano</uri>
        </author>
        <category label="xstate" term="xstate"/>
        <category label="state" term="state"/>
        <category label="store" term="store"/>
        <category label="state management" term="state management"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Changelog Week 7 2024]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-02-16-changelog</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-02-16-changelog"/>
        <updated>2024-02-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In the last few weeks, weâ€™ve released single-file GitHub pull requests, machine sorting, and many other improvements and bug fixes.]]></summary>
        <content type="html"><![CDATA[<p>In the last few weeks, weâ€™ve released single-file GitHub pull requests, machine sorting, and many other improvements and bug fixes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="make-github-pull-requests-for-single-files-from-inside-stately-studio">Make GitHub pull requests for single files from inside Stately Studio<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-16-changelog#make-github-pull-requests-for-single-files-from-inside-stately-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Last week, we released our single file pull request update to our GitHub integration. You can now quickly visualize a state machine from its GitHub file using <a href="https://ouweiya.github.io/xstate-zh/docs/import-from-github#bookmarklet">our handy bookmarklet</a> and then quickly make a pull request for any changes you make back to GitHub. All without leaving the browser. <a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-07-single-file-prs">Read more about this feature in our recent blog post</a>.</p>
<p><img loading="lazy" alt="Using a bookmarklet to import a state machine from GitHub to Stately Studio" src="https://ouweiya.github.io/xstate-zh/assets/images/single-file-import-83be9f9f80f2ec5547877d3336ea352b.gif" width="1328" height="720" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sort-your-machines">Sort your machines<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-16-changelog#sort-your-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>You can now sort your machines in the machines list by name and last updated date. Sorting your machines makes it easier to find the machine youâ€™re looking for, especially if you have a lot of machines in your project.</p>
<p><img src="https://ouweiya.github.io/blog/2024-02-16-changelog/sort.png" alt="The machines list panel showing a list of machines ordered alphabetically, the sort button is pressed and a menu is showing the options for Name A-Z, Name Z-A, Last updated and first updated. The Name A-Z option is selected." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-02-16-changelog/sort-dm.png" alt="The machines list panel showing a list of machines ordered alphabetically, the sort button is pressed and a menu is showing the options for Name A-Z, Name Z-A, Last updated and first updated. The Name A-Z option is selected." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-16-changelog#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li>Community plan users can now get a preview of our premium features when they click on them. So you can find out what youâ€™re missing out on and how to upgrade!</li>
<li>You can now choose which kind of machine to create when you create a new project. Choose from the Blank template, the Starter machine, importing code or generating a machine with AI.</li>
<li>We added more helpful messages when a user hits the GitHub rate limits.</li>
<li>We simplified the search in the Discover area.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-16-changelog#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li>We fixed a bug where the Code panel would not close when you deleted the last machine in a project.</li>
<li>We fixed a bug where renaming a machine to a name, including a <code>.</code> (period), caused it to lose all its transitions.</li>
<li>We fixed a bug where the Projects panel was always open on refresh.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="we-love-your-feedback">We love your feedback!<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-16-changelog#we-love-your-feedback" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Do you have a feature request you want to share with us? <a href="https://github.com/statelyai/feedback" target="_blank" rel="noopener noreferrer">Submit and upvote feature requests on our dedicated GitHub feedback repo</a>. Or <a href="https://discord.stately.ai/" target="_blank" rel="noopener noreferrer">join our Discord server</a>.</p>]]></content>
        <author>
            <name>Laura Kalbag</name>
            <uri>https://github.com/laurakalbag</uri>
        </author>
        <category label="changelog" term="changelog"/>
        <category label="new" term="new"/>
        <category label="github" term="github"/>
        <category label="pr" term="pr"/>
        <category label="import" term="import"/>
        <category label="improvements" term="improvements"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Stately Office Hours 80]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-02-16-office-hours</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-02-16-office-hours"/>
        <updated>2024-02-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Watch our latest office hours live stream where we cover single file GitHub pull requests, sorting machines, Stately Agent, updates to XState and more.]]></summary>
        <content type="html"><![CDATA[<p>Watch our latest office hours live stream where we cover single file GitHub pull requests, sorting machines, Stately Agent, updates to XState and more.</p>
<!-- -->
<div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="chapters">Chapters<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-16-office-hours#chapters" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Watch the video to find out about our new features. Use the links below to jump straight to that chapter in the video:</p>
<ul>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=0s" target="_blank" rel="noopener noreferrer">0:00 Intro</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=117s" target="_blank" rel="noopener noreferrer">01:57 Single-file GitHub pull requests</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=352s" target="_blank" rel="noopener noreferrer">05:52 Order machines</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=474s" target="_blank" rel="noopener noreferrer">07:54 Importing a GitHub file using createActorContext to Stately Studio</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=577s" target="_blank" rel="noopener noreferrer">09:37 Services (actors) and createActorContext for improved type inference</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=697s" target="_blank" rel="noopener noreferrer">11:37 Are there any best practices and guidelines around XState and TypeScript?</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=816s" target="_blank" rel="noopener noreferrer">13:36 Stately Inspect: createSkyInspector</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=980s" target="_blank" rel="noopener noreferrer">16:20 XState updates</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=1110s" target="_blank" rel="noopener noreferrer">18:30 useSelector in XState</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=1183s" target="_blank" rel="noopener noreferrer">19:43 Stately Agent</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=1318s" target="_blank" rel="noopener noreferrer">21:58 Stately Agent docs and API</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=1525s" target="_blank" rel="noopener noreferrer">25:25 Will useSelector still work if the actor becomes available on render?</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=1592s" target="_blank" rel="noopener noreferrer">26:32 Effect Days in Austria next week</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=1684s" target="_blank" rel="noopener noreferrer">28:04 More on Stately Agent</a></li>
<li><a href="https://youtube.com/watch?v=q0S4_QfCBJk&amp;t=1890s" target="_blank" rel="noopener noreferrer">31:30 Wrap up</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="links-from-this-weeks-office-hours">Links from this weekâ€™s office hours<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-16-office-hours#links-from-this-weeks-office-hours" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5">Kevinâ€™s blog post on Migrating machines to XState V5</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/typescript">XState and TypeScript</a></li>
<li><a href="https://www.youtube.com/watch?v=TRVjeil-y74" target="_blank" rel="noopener noreferrer">XState V5 webinar</a></li>
<li><a href="https://stately.ai/agent" target="_blank" rel="noopener noreferrer">Stately Agent</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/agents">Stately AI Agents docs</a></li>
<li><a href="https://effect.website/events/effect-days" target="_blank" rel="noopener noreferrer">Effect Days</a></li>
</ul>
<p>Got any questions for the team? Want to share how youâ€™re using Stately or XState? Join us live, or share your questions in our <a href="https://discord.stately.ai/" target="_blank" rel="noopener noreferrer">Discordâ€™s office-hours channel</a>.</p>
<p>Be the first to find out about our next office hours by subscribing to <a href="https://www.youtube.com/@Statelyai" target="_blank" rel="noopener noreferrer">our YouTube channel</a>, <a href="https://www.twitch.tv/statelyai" target="_blank" rel="noopener noreferrer">Twitch channel</a>, or <a href="https://www.linkedin.com/company/statelyai/" target="_blank" rel="noopener noreferrer">following us on LinkedIn</a>.</p>]]></content>
        <author>
            <name>Laura Kalbag</name>
            <uri>https://github.com/laurakalbag</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="studio" term="studio"/>
        <category label="office hours" term="office hours"/>
        <category label="xstate" term="xstate"/>
        <category label="github sync" term="github sync"/>
        <category label="pull request" term="pull request"/>
        <category label="bookmarklet" term="bookmarklet"/>
        <category label="stately agent" term="stately agent"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ä½¿ç”¨ XState å’Œ React ç®¡ç†å…¨å±€çŠ¶æ€]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-02-12-xstate-react-global-state</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-02-12-xstate-react-global-state"/>
        <updated>2024-02-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[å¦‚ä½•ä½¿ç”¨ XState åœ¨ React ä¸­ç®¡ç†å…¨å±€çŠ¶æ€]]></summary>
        <content type="html"><![CDATA[<p>XState æ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½çš„çŠ¶æ€ç®¡ç†å’Œç¼–æŽ’åº“ï¼Œå¯ä»¥ä¸Žä»»ä½•æ¡†æž¶ä¸€èµ·ä½¿ç”¨ï¼ŒåŒ…æ‹¬ä¸Ž <a href="https://ouweiya.github.io/xstate-zh/docs/xstate-react"><code>@xstate/react</code></a> åŒ…ä¸€èµ·ä½¿ç”¨çš„ Reactã€‚å¯¹äºŽè®¸å¤šåº”ç”¨ç¨‹åºæ¥è¯´ï¼Œç®¡ç†å…¨å±€çŠ¶æ€æ˜¯ä¸€ä¸ªè¦æ±‚ï¼Œæœ‰å¾ˆå¤šé€‰é¡¹å¯ä»¥åœ¨ React ä¸­å…±äº«å…¨å±€çŠ¶æ€ï¼Œæ¯”å¦‚ä½¿ç”¨ <a href="https://react.dev/learn/passing-data-deeply-with-context" target="_blank" rel="noopener noreferrer">React Context</a> æˆ–è€…åƒ <a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer">Redux</a>ã€<a href="https://mobx.js.org/" target="_blank" rel="noopener noreferrer">MobX</a> å’Œ <a href="https://github.com/pmndrs/zustand" target="_blank" rel="noopener noreferrer">Zustand</a> è¿™æ ·çš„åº“ã€‚</p>
<p><code>@xstate/react</code> åŒ…ä½¿å¾—ä½¿ç”¨ <code>useMachine()</code> å’Œ <code>useActor()</code> è¿™æ ·çš„é’©å­æ¥ç®¡ç†ç»„ä»¶çº§çŠ¶æ€å˜å¾—ç®€å•ï¼Œä½†å®ƒåŒæ ·é€‚ç”¨äºŽç®¡ç†å…¨å±€çŠ¶æ€ ðŸŒŽ</p>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å¿«é€Ÿå¼€å§‹">å¿«é€Ÿå¼€å§‹<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-12-xstate-react-global-state#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ol>
<li><strong>åˆ›å»ºå…¨å±€é€»è¾‘</strong>ã€‚è¿™å¯ä»¥æ˜¯ä¸€ä¸ªç®€å•çš„ promise æˆ–å‡½æ•°ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå¤æ‚çš„çŠ¶æ€æœºæˆ–çŠ¶æ€å›¾ã€‚</li>
<li><strong>ä»Žè¯¥é€»è¾‘åˆ›å»ºä¸€ä¸ª actor å¹¶å¯¼å‡ºå®ƒ</strong>ã€‚</li>
<li><strong>ä»Žä»»ä½•ç»„ä»¶ä¸­å¯¼å…¥è¯¥ actor</strong> å¹¶ï¼š<!-- -->
<ul>
<li>ä½¿ç”¨ <code>useSelector(â€¦)</code> é’©å­è¯»å– actor çš„å¿«ç…§</li>
<li>è°ƒç”¨ <code>actorRef.send(â€¦)</code> å‘é€äº‹ä»¶ç»™å®ƒã€‚</li>
</ul>
</li>
</ol>
<p>å°±æ˜¯è¿™æ ·ï¼</p>
<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> setup</span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token imports"> createActor </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> useSelector </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/react'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å…¨å±€åº”ç”¨é€»è¾‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> globalLogic </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'./globalLogic'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åˆ›å»º actor</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> globalActor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">globalLogic</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¯åŠ¨ actor</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">globalActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">start</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">App</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¯»å– actor çš„å¿«ç…§</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> user </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useSelector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">globalActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">snapshot</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> snapshot</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">h1</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text">ä½ å¥½, </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">user</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text">!</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">h1</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      // å‘é€äº‹ä»¶ç»™ actor</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> globalActor</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token tag script language-javascript method function property-access" style="color:hsl(221, 87%, 60%)">send</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> type</span><span class="token tag script language-javascript operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript string" style="color:hsl(119, 34%, 47%)">'logout'</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      ç™»å‡º</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">div</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å…¨å±€çŠ¶æ€">å…¨å±€çŠ¶æ€<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-12-xstate-react-global-state#%E5%85%A8%E5%B1%80%E7%8A%B6%E6%80%81" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>ç®¡ç†å…¨å±€çŠ¶æ€çš„æœ€ç®€å•æ–¹æ³•æ˜¯å…±äº«ä¸€ä¸ª<a href="https://ouweiya.github.io/xstate-zh/docs/actors">actor</a>å®žä¾‹ã€‚å¯ä»¥å°† actor è§†ä¸ºä¸€ä¸ªâ€œå­˜å‚¨â€â€”â€”ä½ å¯ä»¥è®¢é˜…å®ƒçš„çŠ¶æ€æ›´æ–°ï¼ˆâ€œå¿«ç…§â€ï¼‰å¹¶å‘å®ƒå‘é€äº‹ä»¶ã€‚</p>
<p>ä½ å¯ä»¥é€šè¿‡å°† actor ä½œä¸º prop ä¼ é€’æˆ–ç›´æŽ¥ä»Žæ¨¡å—èŒƒå›´å¼•ç”¨æ¥åœ¨ä»»ä½•ç»„ä»¶ä¸­ä½¿ç”¨å®ƒã€‚</p>
<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> setup</span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token imports"> createActor </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> useSelector </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/react'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å…¨å±€åº”ç”¨é€»è¾‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> countMachine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  on</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    inc</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">assign</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">count</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å…¨å±€ actor - åº”ç”¨é€»è¾‘çš„ä¸€ä¸ªå®žä¾‹</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> countActor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">countMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">countActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">start</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç«‹å³å¯åŠ¨ actor</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">App</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è¯»å– actor çš„å¿«ç…§</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> count </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useSelector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">countActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å‘é€äº‹ä»¶ç»™ actor</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> countActor</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token tag script language-javascript method function property-access" style="color:hsl(221, 87%, 60%)">send</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> type</span><span class="token tag script language-javascript operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript string" style="color:hsl(119, 34%, 47%)">'inc'</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      Count: </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä½ å¯ä»¥ä»Žä»»ä½•ç»„ä»¶ä¸­è¯»å–è¿™ä¸ªå…¨å±€ actorï¼ˆâ€œå­˜å‚¨â€ï¼‰å¹¶å‘å®ƒå‘é€äº‹ä»¶ï¼š</p>
<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> countActor </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'./countActor'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">Counter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> count </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useSelector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">countActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> countActor</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token tag script language-javascript method function property-access" style="color:hsl(221, 87%, 60%)">send</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> type</span><span class="token tag script language-javascript operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript string" style="color:hsl(119, 34%, 47%)">'inc'</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      Current count: </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å‰¯ä½œç”¨å’Œç”Ÿå‘½å‘¨æœŸ">å‰¯ä½œç”¨å’Œç”Ÿå‘½å‘¨æœŸ<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-12-xstate-react-global-state#%E5%89%AF%E4%BD%9C%E7%94%A8%E5%92%8C%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>actor ä¸ä»…é™äºŽä½œä¸ºçŠ¶æ€å­˜å‚¨ã€‚å®ƒä»¬è¿˜å¯ä»¥ç”¨äºŽç®¡ç†å‰¯ä½œç”¨ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚ï¼Œæˆ–è€…ä»Ž actor å†…éƒ¨è§¦å‘å‰¯ä½œç”¨ã€‚å› æ­¤ï¼Œä½ å¯èƒ½ä¸å¸Œæœ› actor ç«‹å³å¯åŠ¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>.start()</code> æ–¹æ³•åœ¨é€‚å½“çš„æ—¶é—´å¯åŠ¨ actorï¼Œæ¯”å¦‚åœ¨åº”ç”¨æŒ‚è½½æ—¶ã€‚</p>
<aside class="theme-admonition theme-admonition-tip alert alert--tip admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18h6m-5 4h4m1.09-8c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 1 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"></path></svg></span></div><div class="admonitionContent_vXIg"><p>å¦‚æžœ actor å·²ç»å¯åŠ¨ï¼Œå†æ¬¡è°ƒç”¨ <code>.start()</code> å°†ä¸ä¼šæœ‰ä»»ä½•æ•ˆæžœã€‚è¿™ä½¿å¾—åœ¨ <code>useEffect()</code> ä¸­è°ƒç”¨å®ƒæ˜¯å®‰å…¨çš„ï¼Œ<code>useEffect()</code> <a href="https://react.dev/reference/react/useEffect#my-effect-runs-twice-when-the-component-mounts" target="_blank" rel="noopener noreferrer">åœ¨å¼€å‘çŽ¯å¢ƒçš„ä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæ‰§è¡Œä¸¤æ¬¡</a>ã€‚</p></div></aside>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> effectfulActor </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'./effectfulActor'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">App</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token function" style="color:hsl(221, 87%, 60%)">useEffect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    effectfulActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">start</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">effectfulActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åŒæ ·ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ <code>actor.stop()</code> æ¥æŽ§åˆ¶ actor ä½•æ—¶åœæ­¢ã€‚</p>
<aside class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>å…¨å±€ä½¿ç”¨çš„ actor å¿…é¡»æ˜¾å¼å¯åŠ¨ (<code>actor.start()</code>)ã€‚å½“ä½¿ç”¨ <code>@xstate/react</code> é’©å­å¦‚ <code>useMachine(â€¦)</code>ã€<code>useSelector(â€¦)</code> ç­‰æ—¶ï¼Œactor ä¼šè‡ªåŠ¨å¯åŠ¨å’Œåœæ­¢ã€‚</p></div></aside>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä½¿ç”¨-react-context-ç®¡ç†å…¨å±€çŠ¶æ€">ä½¿ç”¨ React Context ç®¡ç†å…¨å±€çŠ¶æ€<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-12-xstate-react-global-state#%E4%BD%BF%E7%94%A8-react-context-%E7%AE%A1%E7%90%86%E5%85%A8%E5%B1%80%E7%8A%B6%E6%80%81" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>å¦‚æžœä½ æ›´å–œæ¬¢ä½¿ç”¨ <a href="https://react.dev/learn/passing-data-deeply-with-context" target="_blank" rel="noopener noreferrer">React Context</a> æ¥å…±äº«å…¨å±€çŠ¶æ€ï¼Œä½ å¯ä»¥å°†ä¸Šè¿°æ¨¡å¼é€‚é…ä¸ºä½¿ç”¨ React Context æä¾›è€…å’Œæ¶ˆè´¹è€…ã€‚</p>
<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> createContext </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'react'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> someMachine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token comment" style="color:hsl(230, 4%, 64%)">/* ... */</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> someActor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">someMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ä¸è¦å¿˜è®°å¯åŠ¨ actorï¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">someActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">start</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å°† `someActor` ä¼ é€’ç»™ `createContext` ä¸»è¦æ˜¯ä¸ºäº†ç±»åž‹å®‰å…¨</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> </span><span class="token maybe-class-name">SomeActorContext</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">someActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">App</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag class-name" style="color:hsl(35, 99%, 36%)">SomeActorContext.Provider</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">value</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)">someActor</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag class-name" style="color:hsl(35, 99%, 36%)">Counter</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag class-name" style="color:hsl(35, 99%, 36%)">SomeActorContext.Provider</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> useContext </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'react'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> useSelector </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/react'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">SomeActorContext</span><span class="token imports"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'./SomeActorContext'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">Counter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> someActor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token maybe-class-name">SomeActorContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> count </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useSelector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">someActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag attr-name" style="color:hsl(35, 99%, 36%)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(119, 34%, 47%)">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> someActor</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token tag script language-javascript method function property-access" style="color:hsl(221, 87%, 60%)">send</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> type</span><span class="token tag script language-javascript operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript string" style="color:hsl(119, 34%, 47%)">'inc'</span><span class="token tag script language-javascript" style="color:hsl(5, 74%, 59%)"> </span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token tag script language-javascript punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">      Current count: </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag" style="color:hsl(5, 74%, 59%)">button</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<aside class="theme-admonition theme-admonition-tip alert alert--tip admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18h6m-5 4h4m1.09-8c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 1 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"></path></svg></span></div><div class="admonitionContent_vXIg"><p><code>@xstate/react</code> åŒ…è¿˜æä¾›äº†ä¸€ä¸ª <code>createActorContext(â€¦)</code> å‡½æ•°ä»¥æ–¹ä¾¿ä½¿ç”¨ã€‚é˜…è¯»å…³äºŽ<a href="https://ouweiya.github.io/xstate-zh/blog/2023-1-27-making-state-machines-global-in-react">åœ¨ React ä¸­ä½¿çŠ¶æ€æœºå…¨å±€åŒ–</a>çš„åšå®¢æ–‡ç« ï¼Œå¹¶æŸ¥çœ‹<a href="https://ouweiya.github.io/xstate-zh/docs/xstate-react#createactorcontextlogic"><code>createActorContext(â€¦)</code> çš„æ–‡æ¡£</a>ã€‚</p></div></aside>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä¸ä»…ä»…æ˜¯çŠ¶æ€æœº">ä¸ä»…ä»…æ˜¯çŠ¶æ€æœº<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-12-xstate-react-global-state#%E4%B8%8D%E4%BB%85%E4%BB%85%E6%98%AF%E7%8A%B6%E6%80%81%E6%9C%BA" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>çŠ¶æ€æœºéžå¸¸å¼ºå¤§ä¸”æœ‰ç”¨ï¼Œä½†æœ‰æ—¶ä½ ä¸éœ€è¦æ‰€æœ‰è¿™äº›åŠŸèƒ½ã€‚XState v5 ä½¿ä½ èƒ½å¤Ÿåˆ›å»º<a href="https://ouweiya.github.io/xstate-zh/docs/category/actors">ä¸åŒç±»åž‹çš„ actor é€»è¾‘</a>ä»¥é€‚åº”ä½ çš„ç”¨ä¾‹ï¼Œä¾‹å¦‚åŸºäºŽ promiseã€observableã€è½¬æ¢å‡½æ•°ã€å›žè°ƒç­‰çš„ actor é€»è¾‘ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> fromTransition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> createActor </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> useSelector </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/react'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ¼”å‘˜é€»è¾‘</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> counterLogic </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">fromTransition</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">type </span><span class="token operator" style="color:hsl(221, 87%, 60%)">===</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'inc'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">count </span><span class="token operator" style="color:hsl(221, 87%, 60%)">+</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> counterActor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">counterLogic</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">counterActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">start</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Same API</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">Counter</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> count </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useSelector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">counterActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> counterActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'inc'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      Current count</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">count</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token operator" style="color:hsl(221, 87%, 60%)">/</span><span class="token plain">button</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>David Khourshid</name>
            <uri>https://github.com/davidkpiano</uri>
        </author>
        <category label="xstate" term="xstate"/>
        <category label="react" term="react"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Edit a state machine from GitHub without touching any code]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-02-07-single-file-pr</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-02-07-single-file-pr"/>
        <updated>2024-02-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Import a state machine from GitHub to Stately, edit the machine, and make a pull request back to GitHub without touching any code.]]></summary>
        <content type="html"><![CDATA[<p>You use XState in your codebase, and you want to make a change to a state machine. You donâ€™t want to touch any code but want to make a pull request back to GitHub. Our single file import feature lets you do it all in the browser.</p>
<!-- -->
<p>This time last year, <a href="https://ouweiya.github.io/xstate-zh/blog/2023-02-06-github-import-machines">we introduced importing a single file into the Stately Studio from GitHub</a>. Now, weâ€™re taking it a step further. As part of our <a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync">bi-directional GitHub integration</a>, you can import a state machine (or multiple state machines!) from a single file in GitHub, make changes in Stately Studio, and make a pull request back to GitHub without touching any code. You can do it all in the browser; no code editor required.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quickly-visualize-any-state-machine-from-github">Quickly visualize any state machine from GitHub<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-07-single-file-pr#quickly-visualize-any-state-machine-from-github" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p><img loading="lazy" alt="Using a bookmarklet to import a state machine from GitHub to Stately Studio" src="https://ouweiya.github.io/xstate-zh/assets/images/single-file-import-83be9f9f80f2ec5547877d3336ea352b.gif" width="1328" height="720" class="img_ev3q"></p>
<p>To get any state machine from GitHub into Stately Studio, just change the <code>.com</code> part of the URL to <code>.stately.ai</code>. For example, <code>https://github.com/username/repo/blob/main/apps/superMachine.ts</code>, becomes
<code>https://github.stately.ai/username/repo/blob/main/apps/superMachine.ts</code>. Hit enter, and youâ€™ll be taken to Stately Studio with the machine visualized and ready to edit.</p>
<p>Or, for even speedier access, use our bookmarklet. Just drag the following bookmarklet link to your bookmarks:</p>
<p><a style="border:1px solid;border-radius:1rem;padding:0.5rem 0.75rem" href="javascript:(function()%7Bjavascript%3A(function()%7B%20location.href%20%3D%20'https%3A%2F%2Fgithub.stately.ai%2F'%20%2B%20window.location.pathname%3B%7D)()%3B%7D)()%3B">GitHub â†’ Stately</a></p>
<p>Or add the bookmarklet manually:</p>
<ol>
<li>Add a new bookmark to your browser.</li>
<li>Set the bookmarkâ€™s web address to the following:
<code>javascript:(function(){ location.href = 'https://github.stately.ai/' + window.location.pathname;})();</code></li>
<li>Click the bookmarklet when viewing a GitHub file containing one or more machines to import that machine to Stately Studio.</li>
</ol>
<p>You only need a <a href="https://ouweiya.github.io/xstate-zh/docs/import-from-github#github-personal-access-token">GitHub personal access token</a> and a <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">Stately Pro account, which you can try with a free trial</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="make-github-pull-requests-from-inside-stately-studio">Make GitHub pull requests from inside Stately Studio<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-07-single-file-pr#make-github-pull-requests-from-inside-stately-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Once your machine is in Stately Studio, you can make your changes. When youâ€™re ready to make a pull request back to GitHub, use the <strong>Create pull request</strong> button in the top bar. Now weâ€™re developers here at Stately, so we know you donâ€™t necessarily want to make a pull request if you donâ€™t know what the code looks like, so before your pull request is created, you can see a code diff of the changes youâ€™ve made in Stately Studio.</p>
<p><img src="https://ouweiya.github.io/blog/2024-02-07-single-file-prs/diff.png" alt="The pull request modal in Stately Studio showing deleted lines of code in red and inserted lines of code in green." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-02-07-single-file-prs/diff-dm.png" alt="The pull request modal in Stately Studio showing deleted lines of code in red and inserted lines of code in green." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<p>Our GitHub integration is a premium feature of Stately Studio. You can try our premium plans with a free trial. <a href="https://stately.ai/" target="_blank" rel="noopener noreferrer">Sign up today</a> or <a href="https://ouweiya.github.io/xstate-zh/docs/studio-pro-plan">check out our Pro plan</a>, <a href="https://ouweiya.github.io/xstate-zh/docs/studio-team-plan">Team plan</a>, and <a href="https://ouweiya.github.io/xstate-zh/docs/studio-enterprise-plan">Enterprise plan</a> features.</p>]]></content>
        <author>
            <name>Laura Kalbag</name>
            <uri>https://github.com/laurakalbag</uri>
        </author>
        <category label="new" term="new"/>
        <category label="github" term="github"/>
        <category label="github sync" term="github sync"/>
        <category label="import" term="import"/>
        <category label="pr" term="pr"/>
        <category label="pull request" term="pull request"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[å°†çŠ¶æ€æœºè¿ç§»åˆ° XState v5]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5"/>
        <updated>2024-02-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[è¿ç§»çŽ°æœ‰ XState v4 çŠ¶æ€æœºåˆ° XState v5 çš„æŒ‡å—]]></summary>
        <content type="html"><![CDATA[<p>æˆ‘ä»¬æœ€è¿‘<a href="https://ouweiya.github.io/xstate-zh/blog/2023-12-01-xstate-v5">å®£å¸ƒå‘å¸ƒ XState v5</a>! åœ¨å…¶æµ‹è¯•é˜¶æ®µï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<a href="https://ouweiya.github.io/xstate-zh/docs/migration">è¿ç§»æŒ‡å—</a>ï¼Œä¸“é—¨æŒ‡å‡ºé‡å¤§å˜åŒ–ï¼Œå¹¶ä¸ºå¼€å‘äººå‘˜æä¾›æœ‰å…³ API æ›´æ”¹çš„æŒç»­æ›´æ–°ã€‚æœ¬ç¯‡æ–‡ç« æ˜¯ä»Ž v4 è¿ç§»åˆ° v5 çš„çŽ°æœ‰ XState çŠ¶æ€æœºçš„æŒ‡å—ï¼Œæ—¨åœ¨ä½œä¸ºè¿ç§»æŒ‡å—çš„é€æ­¥ä¼´ä¾£ã€‚å®ƒè¿˜ä¾§é‡äºŽè¿ç§»<a href="https://ouweiya.github.io/xstate-zh/docs/typescript">ä½¿ç”¨ TypeScript çš„ XState çŠ¶æ€æœº</a>ã€‚</p>
<!-- -->
<aside class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>é˜…è¯»<a href="https://ouweiya.github.io/xstate-zh/blog/2023-12-01-xstate-v5">David å…³äºŽ XState v5 å‘å¸ƒçš„åšå®¢æ–‡ç« </a>ã€‚</p><p>å–œæ¬¢è§†é¢‘ï¼Ÿ<a href="https://www.youtube.com/live/TRVjeil-y74" target="_blank" rel="noopener noreferrer">è§‚çœ‹æˆ‘ä»¬åœ¨ YouTube ä¸Šçš„ XState v5 ç½‘ç»œç ”è®¨ä¼š</a>:</p><div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div></div></aside>
<p>æˆ‘ä»¬åœ¨ Stately çš„ <a href="https://stately.ai/studio" target="_blank" rel="noopener noreferrer">Stately Studio</a> ä»£ç åº“ä¸­æœ‰æ•°åä¸ª XState çŠ¶æ€æœºï¼Œå¹¶ä¸”ä¹Ÿåœ¨å°†å®ƒä»¬è¿ç§»åˆ° XState v5ã€‚åœ¨å’¨è¯¢äº†æˆ‘çš„ä¸“å®¶é˜Ÿå‹ Mateusz åŽï¼Œæˆ‘å­¦åˆ°äº†å¾ˆå¤šå…³äºŽè¿ç§»è¿‡ç¨‹çš„çŸ¥è¯†ï¼Œå¹¶å¸Œæœ›åˆ†äº«ä¸€äº›ç»éªŒï¼Œä»¥ä½¿æ‚¨çš„è¿ç§»è¿‡ç¨‹æ›´åŠ é¡ºåˆ©ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ‚¨å¯ä»¥éµå¾ªçš„ä¸€ç³»åˆ—æ­¥éª¤ï¼Œä»¥å°†çŽ°æœ‰çš„ XState v4 çŠ¶æ€æœºè¿ç§»åˆ° XState v5ã€‚é¡ºåºä»…æ˜¯å»ºè®®ï¼Œè€Œä¸æ˜¯è¦æ±‚ã€‚</p>
<ol>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#1-install-xstate-v5-and-dependencies">å®‰è£… XState v5 å’Œä¾èµ–é¡¹</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#2-move-types-to-setup-and-remove-typegen">å°†ç±»åž‹ç§»è‡³ <code>setup()</code> å¹¶ç§»é™¤ typegen</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#3-convert-action-and-guard-strings-to-parameterized-objects">å°†åŠ¨ä½œå’Œå®ˆå«å­—ç¬¦ä¸²è½¬æ¢ä¸ºå‚æ•°åŒ–å¯¹è±¡</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#4-include-implementations-or-stubs-in-setup">åœ¨ <code>setup()</code> ä¸­åŒ…å«å®žçŽ°æˆ–å­˜æ ¹</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#5-provide-concrete-implementations">æä¾›å…·ä½“å®žçŽ°</a></li>
</ol>
<aside class="theme-admonition theme-admonition-tip alert alert--tip admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18h6m-5 4h4m1.09-8c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 1 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"></path></svg></span></div><div class="admonitionContent_vXIg"><p>å¯¹äºŽæ­¥éª¤ 2-5ï¼Œæ‚¨å¯èƒ½ä¼šå‘çŽ°æ›´å®¹æ˜“å¤„ç†çŽ°æœ‰çŠ¶æ€æœºçš„ä¸€å°éƒ¨åˆ†ï¼Œä¾‹å¦‚ä¸€ä¸ªå•ä¸€çš„äº‹ä»¶æˆ–åŠ¨ä½œï¼Œå¹¶åœ¨æ­¥éª¤ 2-5 ä¸­å®Œå…¨è¿ç§»å®ƒï¼Œä»¥ä¾¿åœ¨è¿‡ç¨‹ä¸­éš”ç¦» TypeScript é”™è¯¯çš„åŽŸå› å’Œä¿®å¤ã€‚</p></div></aside>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-å®‰è£…-xstate-v5-å’Œä¾èµ–é¡¹">1. å®‰è£… XState v5 å’Œä¾èµ–é¡¹<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#1-%E5%AE%89%E8%A3%85-xstate-v5-%E5%92%8C%E4%BE%9D%E8%B5%96%E9%A1%B9" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>ç¬¬ä¸€æ­¥æ˜¯<a href="https://ouweiya.github.io/xstate-zh/docs/xstate#installation">å®‰è£… XState v5</a>ã€‚å¦‚æžœæ‚¨ä½¿ç”¨çš„æ˜¯æ¡†æž¶æˆ–åº“ï¼Œæ‚¨è¿˜å¯ä»¥å®‰è£…å…¶ä¸­ä¸€ä¸ªé›†æˆåŒ…ï¼š</p>
<ul>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/xstate-react">React</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/xstate-vue">Vue</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/xstate-svelte">Svelte</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åŒæ—¶å®‰è£…-xstate-v4-å’Œ-v5">åŒæ—¶å®‰è£… XState v4 å’Œ v5<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E5%90%8C%E6%97%B6%E5%AE%89%E8%A3%85-xstate-v4-%E5%92%8C-v5" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>å¦‚æžœæ‚¨æœ‰è®¸å¤šçŠ¶æ€æœºï¼Œå¹¶å¸Œæœ›é€æ­¥å°†å®ƒä»¬è¿ç§»åˆ° v5ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§<a href="https://ouweiya.github.io/xstate-zh/docs/migration#how-can-i-use-both-xstate-v4-and-v5">è¿™é‡Œåˆ—å‡ºçš„è¿ç§»æ­¥éª¤</a>åŒæ—¶å®‰è£… v4 å’Œ v5ã€‚å®Œæˆè¿™äº›æ­¥éª¤åŽï¼Œæ‚¨å°†åœ¨ <code>package.json</code> ä¸­åŒæ—¶æ‹¥æœ‰è¿™ä¸¤ä¸ªä¾èµ–é¡¹ã€‚</p>
<p>ä¸ºäº†å®‰è£…é›†æˆåŒ…ï¼Œæ‚¨éœ€è¦<a href="https://ouweiya.github.io/xstate-zh/docs/migration#how-can-i-use-both-xstate-v4-and-v5">è¿è¡Œä¸€ä¸ªè„šæœ¬</a>ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œåº“å›ºå®šåœ¨æ’°å†™æœ¬æ–‡æ—¶çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä½†å¦‚æžœæ‚¨æ„¿æ„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>npm:xstate@latest</code>ã€‚</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">// å®Œæˆè¿ç§»æŒ‡å—ä¸­çš„æ­¥éª¤åŽçš„ package.json</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">{</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  dependencies: {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    xstate: '4.38.2',</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    xstate5: 'npm:xstate@5.6.0',</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    '@xstate/react': '3.2.2',</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    '@xstate/react5': 'npm:@xstate/react@4.0.3',</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  },</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<aside class="theme-admonition theme-admonition-tip alert alert--tip admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18h6m-5 4h4m1.09-8c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 1 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"></path></svg></span></div><div class="admonitionContent_vXIg"><p>æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥å°† <code>xstate</code> é»˜è®¤è®¾ç½®ä¸º v5ï¼Œå¹¶å°† v4 ç”¨äºŽ <code>xstate4</code>ã€‚</p></div></aside>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä»Žç‰ˆæœ¬åŒ–åŒ…ä¸­å¯¼å…¥">ä»Žç‰ˆæœ¬åŒ–åŒ…ä¸­å¯¼å…¥<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E4%BB%8E%E7%89%88%E6%9C%AC%E5%8C%96%E5%8C%85%E4%B8%AD%E5%AF%BC%E5%85%A5" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>å¦‚æžœåŒæ—¶ä½¿ç”¨åŒé‡å®‰è£…ï¼ˆv4 å’Œ v5ï¼‰ï¼Œæˆ–è€…å³ä½¿ä»…ä½¿ç”¨ v5ï¼Œæ‚¨éƒ½éœ€è¦ç¡®ä¿ä»Ž v5 åŒ…ä¸­å¯¼å…¥ XState å‡½æ•°ã€‚åœ¨æ–‡ä»¶çš„é¡¶éƒ¨ï¼Œä»Ž <code>xstatev5</code> åŒ…ä¸­å¯¼å…¥ <code>setup</code>ã€<code>assign</code> å’Œå…¶ä»–åŠ¨ä½œåˆ›å»ºå™¨ç­‰å‡½æ•°ã€‚</p>
<aside class="theme-admonition theme-admonition-warning alert alert--danger admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v4m0 4h.01m9.72 1-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2.001 2.001 0 0 0 1.73-3Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>é¿å…ä¸åŒ¹é…ï¼ä»Ž XState v5 è°ƒç”¨ <code>createMachine({})</code>ï¼Œä½†ä»Ž v4 å¯¼å…¥çš„ XState å‡½æ•°ï¼ˆå¦‚ <code>assign</code>ï¼‰å¯èƒ½ä¼šå¯¼è‡´ç±»åž‹é”™è¯¯ã€‚</p></div></aside>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// åœ¨ v5 æœºå™¨ä¸­...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    prop</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'defaultValue'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  on</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    next</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç¡®ä¿ä»Ž v5 åŒ…ä¸­å¯¼å…¥ assign</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// è€Œä¸æ˜¯ä»Ž v4ï¼</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">assign</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> prop</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'value'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-å°†ç±»åž‹ç§»è‡³-setup-å¹¶ç§»é™¤-typegen">2. å°†ç±»åž‹ç§»è‡³ <code>setup()</code> å¹¶ç§»é™¤ typegen<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#2-%E5%B0%86%E7%B1%BB%E5%9E%8B%E7%A7%BB%E8%87%B3-setup-%E5%B9%B6%E7%A7%BB%E9%99%A4-typegen" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>åŸºäºŽé‡å¤§å˜åŒ–çš„ç¬¬ä¸€ä¸ªè¿ç§»æ­¥éª¤ä¹‹ä¸€æ˜¯ä»Ž v4 çš„æœºå™¨é…ç½®çš„ <code>schema</code> å±žæ€§ä¸­ç§»é™¤ä»»ä½• TypeScript ç±»åž‹ã€‚è¿™äº›ç±»åž‹çŽ°åœ¨åº”è¯¥åŒ…å«åœ¨ä¼ é€’ç»™æ–°çš„ <code>setup({})</code> å‡½æ•°çš„å¯¹è±¡ä¸­çš„æ–° <code>types</code> å±žæ€§ä¸‹ã€‚</p>
<p>åœ¨ v5 ä¸­ä»ç„¶æ”¯æŒå°†ç±»åž‹ä¼ é€’ç»™ <code>createMachine({ schema: {} })</code>ï¼Œç„¶è€Œï¼Œä¼ é€’å®ƒä»¬ç»™ <code>setup({})</code> æ˜¯é¦–é€‰ï¼Œå› ä¸ºå®ƒè‡ªåŠ¨å°†å®žçŽ°ï¼ˆä»¥åŠæ›´å¤šï¼‰ç±»åž‹åŒ–ã€‚</p>
<div class="tabs-container tabList_TRJ7"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_hGfb tabs__item--active">XState v4</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_hGfb">XState v5</li></ul><div class="padding-top--s"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  tsTypes</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'./myMachine.typegen'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">Typegen0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  schema</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    events</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'next'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        value</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'back'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        value</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    services</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      fetchUserDetails</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        data</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> email</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> name</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> setup </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  types</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    events</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'next'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          value</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'back'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          value</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/* å®žçŽ° */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  guards</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Actor è¾“å…¥å’Œè¾“å‡ºç±»åž‹å°†åŒ…å«åœ¨è¿™é‡Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  actors</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/* æœºå™¨é…ç½® */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>å®šä¹‰ç±»åž‹æ—¶ï¼Œæ‚¨å¯èƒ½å·²ç»åœ¨ä¹‹å‰çš„ç¤ºä¾‹ä¸­æ³¨æ„åˆ°ï¼Œé€šå¸¸ä¼šå°†ä¸€ä¸ªç©ºå¯¹è±¡å¼ºåˆ¶è½¬æ¢ä¸ºæ‚¨å¸Œæœ›çš„æ¯ä¸ªå±žæ€§çš„ç±»åž‹ï¼Œä¾‹å¦‚ <code>events</code> å’Œ <code>actions</code>ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  types</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    events</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'next'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'next'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™ä»ç„¶æœ‰æ•ˆï¼Œä½†æ›´ç®€å•çš„æ–¹æ³•æ˜¯å°†æ•´ä¸ªç±»åž‹å¯¹è±¡ä¸€æ¬¡æ€§å¼ºåˆ¶è½¬æ¢ä¸º <code>types: {} as {}</code>ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  types</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    events</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'next'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">|</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'next'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<aside class="theme-admonition theme-admonition-warning alert alert--danger admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v4m0 4h.01m9.72 1-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2.001 2.001 0 0 0 1.73-3Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>åœ¨ v5 ä¸­é“¾æŽ¥ <code>setup({ types: {} }).createMachine({})</code> æ—¶ï¼Œæˆ‘ä»¬åªèƒ½åœ¨ä¼ é€’ç»™ <code>setup</code> çš„å¯¹è±¡ä¸Šå®šä¹‰ç±»åž‹ï¼Œè€Œä¸èƒ½åœ¨ä¼ é€’ç»™ <code>createMachine</code> çš„é…ç½®å¯¹è±¡ä¸Šå®šä¹‰ç±»åž‹ã€‚</p></div></aside>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ç§»é™¤-typegen">ç§»é™¤ typegen<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E7%A7%BB%E9%99%A4-typegen" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Typegen åœ¨ XState v5 ä¸­ä¸å†æ”¯æŒï¼Œå› æ­¤æ‚¨å¯ä»¥ä»Žæœºå™¨é…ç½®ä¸­ç§»é™¤ <code>tsTypes</code>ã€‚æ²¡æœ‰ typegen çš„æƒ…å†µä¸‹ï¼Œåœ¨åŠ¨ä½œå’Œå®ˆå«ä¸­é”®å…¥äº‹ä»¶å¿…é¡»é€šè¿‡åœ¨å®žçŽ°å‡½æ•°ä¸­æ‰‹åŠ¨è¿›è¡Œç±»åž‹ç¼©å°æ¥å®Œæˆã€‚ç„¶è€Œï¼Œä»¥ä¸‹éƒ¨åˆ†å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•é”®å…¥ä¼ é€’ç»™è¿™äº›å®žçŽ°çš„æ–° <code>params</code> å‚æ•°ï¼Œå¹¶è·³è¿‡æ‰‹åŠ¨ç±»åž‹ç¼©å°ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-å°†åŠ¨ä½œå’Œå®ˆå«å­—ç¬¦ä¸²è½¬æ¢ä¸ºå‚æ•°åŒ–å¯¹è±¡">3. å°†åŠ¨ä½œå’Œå®ˆå«å­—ç¬¦ä¸²è½¬æ¢ä¸ºå‚æ•°åŒ–å¯¹è±¡<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#3-%E5%B0%86%E5%8A%A8%E4%BD%9C%E5%92%8C%E5%AE%88%E5%8D%AB%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%8F%82%E6%95%B0%E5%8C%96%E5%AF%B9%E8%B1%A1" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>æˆ‘ä»¬å¯ä»¥å°†æœºå™¨é…ç½®ä¸­çš„åŠ¨ä½œå’Œå®ˆå«å­—ç¬¦ä¸²è½¬æ¢ä¸ºå‚æ•°åŒ–å¯¹è±¡ã€‚å¦‚æžœå®ƒä»¬éœ€è¦ä½¿ç”¨ <code>event</code> å±žæ€§ï¼Œè¿™å¯¹äºŽè½¬æ¢ä¸Šçš„åŠ¨ä½œå’Œå®ˆå«ç‰¹åˆ«æœ‰å¸®åŠ©ã€‚è¿™å…è®¸æ‚¨æ˜¾å¼åœ°å°† <code>event</code> å±žæ€§æ˜ å°„åˆ°å®žçŽ°å‡½æ•°çš„ <code>params</code> å¯¹è±¡ï¼Œä»¥ä¾¿å®ƒä»¬è‡ªåŠ¨é”®å…¥ï¼Œå¹¶ä¸”ä¸éœ€è¦é¢å¤–çš„<a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html" target="_blank" rel="noopener noreferrer">ç±»åž‹ç¼©å°</a>ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œå¦‚æžœå®ƒä»¬ä»…ä½¿ç”¨ <code>context</code> å€¼ï¼ˆå·²é”®å…¥ï¼‰ï¼Œæ‚¨å¯ä»¥ç»§ç»­ä½¿ç”¨å¼•ç”¨å­—ç¬¦ä¸²å‘½åçš„ <code>entry</code> å’Œ <code>exit</code> åŠ¨ä½œæˆ–å®ˆå«ã€‚ç”šè‡³å¯ä»¥åœ¨é…ç½®ä¸­ä½¿ç”¨å†…è”å‡½æ•°ã€‚</p>
<p>ä¾‹å¦‚ï¼Œè¿™äº›äº‹ä»¶åœ¨ XState v5 ä¸­ä»ç„¶å®Œå…¨å¯ä»¥åƒåœ¨ v4 ä¸­ä¸€æ ·ä½¿ç”¨ï¼š</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> setup </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  types</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  states</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    first</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      entry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'track'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">exit</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> context </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'is already typed'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¯¹äºŽè½¬æ¢äº‹ä»¶å’Œå®ˆå«ï¼Œæˆ‘ä»¬å¯ä»¥<a href="https://ouweiya.github.io/xstate-zh/docs/migration#use-params-to-pass-params-to-actions--guards">å°†å‘½åçš„åŠ¨ä½œæˆ–å®ˆå«å­—ç¬¦ä¸²è½¬æ¢ä¸ºåŠ¨ä½œå¯¹è±¡</a>ï¼Œè¿™å…è®¸æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ˜¾å¼çš„ <code>params</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†åœ¨è¿è¡Œæ—¶ç”±æˆ‘ä»¬çš„å®žçŽ°å‡½æ•°æŽ¥æ”¶ã€‚æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼š</p>
<ol>
<li>æˆ‘ä»¬å¯ä»¥å°† <code>params</code> å®šä¹‰ä¸º<a href="https://ouweiya.github.io/xstate-zh/docs/actions#action-objects">é™æ€å€¼</a></li>
<li>ä½¿ç”¨<a href="https://ouweiya.github.io/xstate-zh/docs/actions#dynamic-action-parameters">åŠ¨æ€åŠ¨ä½œå‚æ•°</a>ï¼Œè¿™æ˜¯ä¸€ä¸ªæŽ¥æ”¶ <code>context</code> å’Œ/æˆ– <code>event</code> çš„å‡½æ•°ï¼Œå…è®¸æ‚¨å°†è¿™äº›å€¼æ˜ å°„åˆ° <code>params</code> å¯¹è±¡ã€‚</li>
</ol>
<div class="tabs-container tabList_TRJ7"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_hGfb tabs__item--active">XState v4</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_hGfb">XState v5</li></ul><div class="padding-top--s"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  on</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    next</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string" style="color:hsl(119, 34%, 47%)">'track'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    back</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token string" style="color:hsl(119, 34%, 47%)">'track'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  on</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    next</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'track'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// é™æ€å®šä¹‰çš„å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> response</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'good'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        back</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'track'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// åŠ¨æ€å®šä¹‰çš„å‚æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            rating</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">rating</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>è¿™åœ¨ v5 ä¸­å¯èƒ½æ˜¾å¾—æœ‰äº›å†—é•¿ï¼Œä½†å®ƒå°†å…è®¸æˆ‘ä»¬åœ¨å®žçŽ°å‡½æ•°ä¸­è·³è¿‡æ‰‹åŠ¨ç±»åž‹ç¼©å°ã€‚<code>params</code> å¯¹è±¡å°†æ ¹æ®æˆ‘ä»¬æ˜ å°„åˆ°å®ƒçš„ <code>event</code> å±žæ€§è‡ªåŠ¨é”®å…¥ã€‚</p>
<aside class="theme-admonition theme-admonition-tip alert alert--tip admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18h6m-5 4h4m1.09-8c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 1 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"></path></svg></span></div><div class="admonitionContent_vXIg"><p>åœ¨æ˜ å°„ <code>event</code> å±žæ€§æ—¶ï¼Œæ‚¨å®šä¹‰çš„åŠ¨ä½œæˆ–å®ˆå« <code>params</code> æŠ€æœ¯ä¸Šå¯ä»¥æ˜¯ä»»ä½•å€¼ï¼Œè€Œä¸ä»…ä»…æ˜¯å¯¹è±¡ã€‚ä½†å»ºè®®ä½¿ç”¨å¯¹è±¡ä»¥ä¿æŒä¸€è‡´æ€§ï¼Œå¹¶æ˜Žç¡®å®žçŽ°å‡½æ•°å°†æŽ¥æ”¶ä»€ä¹ˆã€‚</p></div></aside>
<p>ä»¥ä¸‹æ˜¯å°†åŠ¨ä½œå­—ç¬¦ä¸²è½¬æ¢ä¸ºå‚æ•°åŒ–åŠ¨ä½œçš„æ›´å®Œæ•´ç¤ºä¾‹ï¼š</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> setup </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  types</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">as</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    events</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'next'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      prop3</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">boolean</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/* æ›´å¤šè®¾ç½® */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  on</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    next</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'first'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          guard</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'is this ready'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> ready</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">ready </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'doThis'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç¨åŽï¼ŒåŠ¨ä½œå®žçŽ°å‡½æ•°å°†åœ¨ç¬¬äºŒä¸ªå‚æ•° params ä¸­æŽ¥æ”¶è¿™ä¸ªå­—ç¬¦ä¸²å€¼ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> prop1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop1 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'doThat'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç¨åŽï¼ŒåŠ¨ä½œå®žçŽ°å‡½æ•°å°†åœ¨ç¬¬äºŒä¸ªå‚æ•° params ä¸­æŽ¥æ”¶è¿™ä¸ªæ•°å€¼ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> prop2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop2 </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        states</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        first</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          entry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'whenEntering'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç¨åŽï¼ŒåŠ¨ä½œå®žçŽ°å‡½æ•°å°†åœ¨ç¬¬äºŒä¸ªå‚æ•° params ä¸­ä»…æŽ¥æ”¶è¿™ä¸¤ä¸ªå€¼ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            prop1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            prop2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          exit</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'whenExiting'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ç¨åŽï¼ŒåŠ¨ä½œå®žçŽ°å‡½æ•°å°†åœ¨ç¬¬äºŒä¸ªå‚æ•° params ä¸­ä»…æŽ¥æ”¶è¿™ä¸¤ä¸ªå€¼ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          prop2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          prop3</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-åœ¨-setup-ä¸­åŒ…å«å®žçŽ°æˆ–å­˜æ ¹">4. åœ¨ <code>setup()</code> ä¸­åŒ…å«å®žçŽ°æˆ–å­˜æ ¹<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#4-%E5%9C%A8-setup-%E4%B8%AD%E5%8C%85%E5%90%AB%E5%AE%9E%E7%8E%B0%E6%88%96%E5%AD%98%E6%A0%B9" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>æˆ‘ä»¬å¿…é¡»åœ¨ä¼ é€’ç»™ <code>setup()</code> çš„å¯¹è±¡ä¸­<a href="https://ouweiya.github.io/xstate-zh/docs/machines#providing-implementations">æä¾›åŠ¨ä½œã€å®ˆå«å’Œæ¼”å‘˜çš„å®žçŽ°</a>ã€‚å¦‚æžœçŠ¶æ€æœºæ‹¥æœ‰æ‰§è¡Œè¿™äº›å®žçŽ°æ‰€éœ€çš„ä¸€åˆ‡ï¼Œé‚£ä¹ˆè¿™äº›å°†æ˜¯å®žé™…çš„å®žçŽ°ã€‚ç„¶è€Œï¼Œå¦‚æžœçŠ¶æ€æœºéœ€è¦å¼•ç”¨å¤–éƒ¨ä¸–ç•Œçš„ä¾èµ–é¡¹ï¼Œé‚£ä¹ˆè¿™äº›å°†ä½œä¸ºç¨åŽè¢«è¦†ç›–çš„å­˜æ ¹ã€‚å°†å­˜æ ¹å’Œå…·ä½“å®žçŽ°çš„ç»„åˆä¼ é€’ç»™ <code>setup()</code> æ˜¯å®Œå…¨å¯ä»¥çš„ã€‚</p>
<aside class="theme-admonition theme-admonition-warning alert alert--danger admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v4m0 4h.01m9.72 1-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2.001 2.001 0 0 0 1.73-3Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>åœ¨ XState v5 ä¸­ï¼Œå®žçŽ°å‡½æ•°çš„æ–¹æ³•ç­¾åå·²æ›´æ”¹ã€‚ç¬¬ä¸€ä¸ªå‚æ•°çŽ°åœ¨æ˜¯ä¸€ä¸ªåŒ…å« <code>context</code> å’Œ <code>event</code> å±žæ€§çš„å¯¹è±¡ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ <code>params</code> å¯¹è±¡ã€‚</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> context</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> YourParamsType</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ä½¿ç”¨ TypeScript æ—¶ï¼Œæœ‰å¿…è¦å¯¹ä¼ é€’ç»™æ¯ä¸ªå®žçŽ°å‡½æ•°çš„ç¬¬äºŒä¸ª <code>params</code> å‚æ•°è¿›è¡Œç±»åž‹å®šä¹‰ã€‚</p></div></aside>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å­˜æ ¹åŠ¨ä½œ">å­˜æ ¹åŠ¨ä½œ<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E5%AD%98%E6%A0%B9%E5%8A%A8%E4%BD%9C" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">æ‰§è¡Œæ­¤æ“ä½œ</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> prop</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ‚¨å¯ä»¥åœ¨æ­¤å¤„åŒ…å«å…·ä½“å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å­˜æ ¹å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">æ‰§è¡Œé‚£æ“ä½œ</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> prop</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">è¿›å…¥æ—¶</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> prop1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> prop2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// æ‚¨å¯ä»¥åœ¨æ­¤å¤„åŒ…å«å…·ä½“å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prop1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> prop2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å­˜æ ¹å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">whenExiting</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> prop2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> prop3</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">boolean</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<aside class="theme-admonition theme-admonition-tip alert alert--tip admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 18h6m-5 4h4m1.09-8c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 1 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"></path></svg></span></div><div class="admonitionContent_vXIg"><p>å­˜æ ¹åŠ¨ä½œåº”å®šä¹‰ä¸ºç©ºå‡½æ•°ä½“ <code>() =&gt; {}</code>ï¼Œæˆ–è€…å¯ä»¥å®šä¹‰ä¸ºæŠ›å‡ºé”™è¯¯ï¼Œä»¥å¼ºåˆ¶å®ƒä»¬ç¨åŽè¢«è¦†ç›–ã€‚</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">actionName: (_, params: { prop: string }) =&gt; {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  throw new Error('Not implemented');</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">},</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></aside>
<p>ä»»ä½•ä¼ é€’ç»™ <code>setup()</code> çš„ <code>assign</code> åŠ¨ä½œéƒ½ä¸åº”éœ€è¦æœºå™¨é…ç½®ä¹‹å¤–çš„ä»»ä½•å†…å®¹ï¼Œå› ä¸ºå®ƒä»¬åŸºäºŽä¸Šä¸‹æ–‡æˆ–ç±»åž‹åŒ–çš„ <code>params</code> è®¾ç½®å€¼ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å­˜æ ¹å®ˆå«">å­˜æ ¹å®ˆå«<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E5%AD%98%E6%A0%B9%E5%AE%88%E5%8D%AB" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  guards</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string-property property" style="color:hsl(5, 74%, 59%)">'is this ready'</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> ready</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">boolean</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å…·ä½“å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> ready</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å­˜æ ¹å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token string-property property" style="color:hsl(5, 74%, 59%)">'are we there yet'</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> distance</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<aside class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>å­˜æ ¹å®ˆå«å¿…é¡»è¿”å›žä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå³ <code>true</code> æˆ– <code>false</code>ã€‚</p></div></aside>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å­˜æ ¹æ¼”å‘˜">å­˜æ ¹æ¼”å‘˜<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E5%AD%98%E6%A0%B9%E6%BC%94%E5%91%98" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>å¯ä»¥ä½¿ç”¨å®žé™…çš„æ¼”å‘˜åˆ›å»ºè¾…åŠ©å‡½æ•°æ¥å­˜æ ¹è°ƒç”¨çš„æ¼”å‘˜ï¼Œè¿™å°†åœ¨å®žé™…å®žçŽ°ä¸­ä½¿ç”¨ã€‚è¿™é‡Œçš„ä¸»è¦ç›®çš„æ˜¯é”®å…¥æ¼”å‘˜çš„ <code>input</code> å’Œ <code>output</code>ã€‚æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼š</p>
<p>ç¬¬ä¸€ç§æ–¹æ³•æ›´é€‚ç”¨äºŽå…¶ä»–ç±»åž‹çš„é€»è¾‘åˆ›å»ºè€…ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  actors</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    doSomethingAsync</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">fromPromise</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        input</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          inputProp1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          inputProp2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">Promise</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">Item</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'Not implemented'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<aside class="theme-admonition theme-admonition-warning alert alert--danger admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v4m0 4h.01m9.72 1-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2.001 2.001 0 0 0 1.73-3Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>å­˜æ ¹çš„æ¼”å‘˜å¿…é¡»æŠ›å‡ºé”™è¯¯ï¼Œä»¥å¼ºåˆ¶å®ƒä»¬ç¨åŽè¢«è¦†ç›–ã€‚</p></div></aside>
<p>ç¬¬äºŒç§æ–¹æ³•æ›´çŸ­ä¸”æ›´é€‚ç”¨äºŽ <code>fromPromise</code>ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  actors</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    doSomethingAsync</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token generic-function function" style="color:hsl(221, 87%, 60%)">fromPromise</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">      </span><span class="token generic-function generic class-name comment" style="color:hsl(230, 4%, 64%)">// Promise-wrapped output</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">      Item</span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">      </span><span class="token generic-function generic class-name comment" style="color:hsl(230, 4%, 64%)">// input</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">      </span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">        inputProp1</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> </span><span class="token generic-function generic class-name builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">        inputProp2</span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"> </span><span class="token generic-function generic class-name builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">      </span><span class="token generic-function generic class-name punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token generic-function generic class-name" style="color:hsl(35, 99%, 36%)">    </span><span class="token generic-function generic class-name operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token keyword" style="color:hsl(301, 63%, 40%)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">throw</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">new</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(35, 99%, 36%)">Error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'Not implemented'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å‡å°‘å¤–éƒ¨ä¾èµ–">å‡å°‘å¤–éƒ¨ä¾èµ–<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E5%87%8F%E5%B0%91%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>å³ä½¿æ˜¯çŠ¶æ€æœºå¤–éƒ¨çš„ä¾èµ–é¡¹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€ä½¿å…¶åœ¨çŠ¶æ€æœºä¸­å¯ç”¨ï¼š</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ä½¿ç”¨-input-æ³¨å…¥å¤–éƒ¨ä¾èµ–">ä½¿ç”¨ <code>input</code> æ³¨å…¥å¤–éƒ¨ä¾èµ–<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E4%BD%BF%E7%94%A8-input-%E6%B3%A8%E5%85%A5%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4>
<p>å¦‚æžœä¾èµ–é¡¹åœ¨çŠ¶æ€æœºçš„ç”Ÿå‘½å‘¨æœŸå†…ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å°†å®ƒä»¬ä½œä¸º <code>input</code> ä¼ é€’ç»™ <code>setup()</code>ï¼Œå®ƒä»¬å°†åœ¨çŠ¶æ€æœºå†…éƒ¨å¯ç”¨ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  input</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    externalDependency1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> someRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    externalDependency2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> anotherRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="é€šè¿‡å‘é€äº‹ä»¶æ³¨å…¥å¤–éƒ¨ä¾èµ–">é€šè¿‡å‘é€äº‹ä»¶æ³¨å…¥å¤–éƒ¨ä¾èµ–<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E9%80%9A%E8%BF%87%E5%8F%91%E9%80%81%E4%BA%8B%E4%BB%B6%E6%B3%A8%E5%85%A5%E5%A4%96%E9%83%A8%E4%BE%9D%E8%B5%96" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4>
<p>å¦‚æžœä¾èµ–é¡¹é¢„è®¡ä¼šéšç€æ—¶é—´å˜åŒ–ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å°†è¿™äº›æ›´æ–°ä½œä¸ºäº‹ä»¶å‘é€åˆ°çŠ¶æ€æœºã€‚ä¾‹å¦‚ï¼ŒåŒ…å«ä¾èµ–é¡¹å¼•ç”¨çš„äº‹ä»¶å¯ä»¥å­˜å‚¨åœ¨ <code>context</code> ä¸­ï¼Œä»¥ä¾›çŠ¶æ€æœºä½¿ç”¨ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">send</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'refs.inject'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  externalDependency</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ³¨å…¥ä¾èµ–é¡¹å¹¶ä¸å¯è¡Œæˆ–æ–¹ä¾¿ã€‚å¯èƒ½æœ‰å¤ªå¤šçš„ä¾èµ–é¡¹ï¼Œæˆ–è€…æ‚¨å¯èƒ½å¸Œæœ›é¿å…å°†å®ƒä»¬ä¸ŽçŠ¶æ€æœºç´§å¯†è€¦åˆã€‚ä¸‹ä¸€èŠ‚æè¿°äº†å¦‚ä½•åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­æŒ‰éœ€æä¾›å…·ä½“å®žçŽ°ï¼Œä»¥è¦†ç›–å­˜æ ¹å®žçŽ°ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-æä¾›å…·ä½“å®žçŽ°">5. æä¾›å…·ä½“å®žçŽ°<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#5-%E6%8F%90%E4%BE%9B%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Stately Studio æ˜¯ä¸€ä¸ª NextJS åº”ç”¨ç¨‹åºï¼Œå› æ­¤æˆ‘ä»¬åœ¨ React ç»„ä»¶ä¸­ä½¿ç”¨ <a href="https://ouweiya.github.io/xstate-zh/docs/xstate-react">@xstate/react</a> åŒ…ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>useActorRef()</code> é’©å­ä¸ºæˆ‘ä»¬çš„å­˜æ ¹æä¾›å…·ä½“å®žçŽ°ã€‚æ­¤é’©å­å…è®¸æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªçŠ¶æ€æœºå¹¶æŽ¥æ”¶ä¸€ä¸ª actor å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥å¼•ç”¨å‘çŠ¶æ€æœºå‘é€äº‹ä»¶ã€‚æˆ‘ä»¬å¯ä»¥å‘çŠ¶æ€æœºæä¾›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„å…·ä½“å®žçŽ°ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> useActorRef </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/react'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> actorRef </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useActorRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  machine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">provide</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">æ‰§è¡Œé‚£æ“ä½œ</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> prop2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å…·ä½“å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prop2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">whenExiting</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å…·ä½“å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<aside class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>è°ƒç”¨ <code>machine.provide()</code> è¿”å›žç›¸åŒçš„ <code>machine</code>ï¼Œä½†å¸¦æœ‰æä¾›çš„å®žçŽ°ã€‚å¦‚æžœæ‚¨å¸Œæœ›åœ¨åº”ç”¨ç¨‹åºçš„å¤šä¸ªåœ°æ–¹ä¸ºåŒä¸€ä¸ªæœºå™¨çš„ä¸åŒå®žä¾‹æä¾›ä¸åŒçš„å®žçŽ°ï¼Œè¿™å°†éžå¸¸æœ‰ç”¨ã€‚</p></div></aside>
<p>åœ¨å…¶ä»–ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨ä¸Šä¸‹æ–‡æä¾›è€…åœ¨ç»„ä»¶æ ‘çš„å„ä¸ªå±‚æ¬¡æä¾›å¯¹ <code>actorRef</code> çš„è®¿é—®ã€‚å¯ä»¥ä½¿ç”¨æœºå™¨åˆ›å»ºä¸€ä¸ªæœºå™¨ä¸Šä¸‹æ–‡æä¾›è€…ï¼š</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'./machine'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createActorContext </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/react'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/* è®¾ç½®é…ç½® */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/* æœºå™¨é…ç½® */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> MachineContext </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createActorContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ç„¶åŽå¯ä»¥åœ¨ç»„ä»¶æ ‘ä¸­å¯¼å…¥å¹¶ä½¿ç”¨ï¼š</p>
<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">MachineContext</span><span class="token imports"> </span><span class="token imports punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'./machine'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">App</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token maybe-class-name">MachineContext</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access maybe-class-name">Provider</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      logic</span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">machine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">provide</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">æ‰§è¡Œé‚£æ“ä½œ</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> prop2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å…·ä½“å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token console class-name" style="color:hsl(35, 99%, 36%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">prop2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">whenExiting</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å…·ä½“å®žçŽ°</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token console class-name" style="color:hsl(35, 99%, 36%)">console</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token method function property-access" style="color:hsl(221, 87%, 60%)">log</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">prop2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token property-access">prop3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&lt;/</span><span class="token tag class-name" style="color:hsl(35, 99%, 36%)">MachineContext.Provider</span><span class="token tag punctuation" style="color:hsl(119, 34%, 47%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<a href="https://ouweiya.github.io/xstate-zh/docs/xstate-react#createactorcontextlogic">provider è¢«ä¼ é€’äº†ä¸€ä¸ª <code>logic</code> prop</a>ï¼Œå…¶å€¼æ˜¯å…·æœ‰æä¾›çš„å®žçŽ°çš„æœºå™¨ã€‚åœ¨ç»„ä»¶æ ‘çš„æœ€åº•å±‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="https://ouweiya.github.io/xstate-zh/docs/xstate-react#useactorrefmachine-options"><code>useActorRef()</code> é’©å­</a> æ¥è®¿é—® <code>actorRef</code> å¹¶å‘æœºå™¨å‘é€äº‹ä»¶ã€‚</p>
<aside class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>è¿™äº›å®žçŽ°å‡½æ•°ä¸éœ€è¦åœ¨è¿™é‡Œå†æ¬¡æ˜¾å¼é”®å…¥ï¼Œå› ä¸ºä¼ é€’ç»™å®ƒä»¬çš„ <code>params</code> å‚æ•°å·²ç»é€šè¿‡<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#4-include-implementations-or-stubs-in-setup">åœ¨ä¸Šä¸€æ­¥ä¸­ä¼ é€’ç»™ <code>setup()</code> å‡½æ•°çš„å®žçŽ°</a>è¿›è¡Œäº†é”®å…¥ã€‚</p></div></aside>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æä¾›æ¼”å‘˜å®žçŽ°">æä¾›æ¼”å‘˜å®žçŽ°<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E6%8F%90%E4%BE%9B%E6%BC%94%E5%91%98%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>å¿…é¡»å®šä¹‰ä»¥ä¸‹ä¸‰ä»¶äº‹ï¼š</p>
<ol>
<li>åœ¨ <code>setup()</code> ä¸­æä¾›<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#stubbing-actors">æ¼”å‘˜åˆ›å»ºå‡½æ•°çš„å…·ä½“å®žçŽ°æˆ–å­˜æ ¹</a>ã€‚</li>
<li>åœ¨ä¸»æœºå™¨é…ç½®ä¸­çš„çŠ¶æ€å†…æ³¨å†Œ <code>invoke</code>ã€‚</li>
<li>å¦‚æžœå°šæœªä¼ é€’ç»™ <code>setup()</code>ï¼Œåˆ™ä¸ºæ¼”å‘˜æä¾›å…·ä½“å®žçŽ°ã€‚</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="åœ¨ä¸»æœºå™¨é…ç½®ä¸­çš„çŠ¶æ€å†…æ³¨å†Œ-invoke">åœ¨ä¸»æœºå™¨é…ç½®ä¸­çš„çŠ¶æ€å†…æ³¨å†Œ <code>invoke</code><a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E5%9C%A8%E4%B8%BB%E6%9C%BA%E5%99%A8%E9%85%8D%E7%BD%AE%E4%B8%AD%E7%9A%84%E7%8A%B6%E6%80%81%E5%86%85%E6%B3%A8%E5%86%8C-invoke" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4>
<p>è¿™ç±»ä¼¼äºŽåœ¨ v4 ä¸­æ³¨å†Œè°ƒç”¨çš„æ¼”å‘˜ã€‚ä¸»è¦åŒºåˆ«åœ¨äºŽæˆ‘ä»¬è¿˜åœ¨è¿™é‡Œå®šä¹‰äº† <code>input</code>ï¼Œå°†äº‹ä»¶å€¼æ˜ å°„åˆ°è¾“å…¥å€¼ã€‚ä½¿ç”¨ <code>onDone</code> å’Œ <code>onError</code> æ³¨å†Œçš„åŠ¨ä½œä¹Ÿè¢«å®šä¹‰ä¸ºå¸¦æœ‰ <code>params</code> çš„å¯¹è±¡ï¼Œå°±åƒ<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#3-convert-action-and-guard-strings-to-parameterized-objects">æˆ‘ä»¬ä¹‹å‰åœ¨è½¬æ¢åŠ¨ä½œå’Œè¿›å…¥/é€€å‡ºåŠ¨ä½œä¸­çœ‹åˆ°çš„é‚£æ ·</a>ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/* æœºå™¨é…ç½® */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  states</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:hsl(230, 4%, 64%)">/* å…¶ä»–çŠ¶æ€ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    someState</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      invoke</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        src</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'doSomethingAsync'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¿…éœ€</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        id</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'doSomethingAsync'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// å¯é€‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">input</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          inputProp1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          inputProp2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">prop2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        onDone</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'Idle'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'showSuccessToast'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'handleOutputOnSuccess'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              </span><span class="token function-variable function" style="color:hsl(221, 87%, 60%)">params</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> event </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">output</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        onError</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          target</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'Idle'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'showErrorToast'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="å¦‚æžœå°šæœªä¼ é€’ç»™-setupåˆ™ä¸ºæ¼”å‘˜æä¾›å…·ä½“å®žçŽ°">å¦‚æžœå°šæœªä¼ é€’ç»™ <code>setup()</code>ï¼Œåˆ™ä¸ºæ¼”å‘˜æä¾›å…·ä½“å®žçŽ°<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E5%A6%82%E6%9E%9C%E5%B0%9A%E6%9C%AA%E4%BC%A0%E9%80%92%E7%BB%99-setup%E5%88%99%E4%B8%BA%E6%BC%94%E5%91%98%E6%8F%90%E4%BE%9B%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h4>
<p>å¦‚æžœæˆ‘ä»¬ä»…åœ¨ <code>setup()</code> ä¸­å®šä¹‰äº†æ¼”å‘˜åˆ›å»ºå‡½æ•°çš„å­˜æ ¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»ä¸Žå…¶ä»–å…·ä½“å®žçŽ°ä¸€èµ·ä¸ºæ¼”å‘˜æä¾›å…·ä½“å®žçŽ°ã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> useActorRef </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@xstate/react'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> actorRef </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">useActorRef</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  machine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">provide</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    actors</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      doSomethingAsync</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">fromPromise</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          input</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            inputProp1</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">string</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            inputProp2</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(119, 34%, 47%)">number</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">          </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> trpcProxyClient</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">stuff</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">asyncstuff</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">mutate</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">input</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ¸…ç†å’Œæ•…éšœæŽ’é™¤">æ¸…ç†å’Œæ•…éšœæŽ’é™¤<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E6%B8%85%E7%90%86%E5%92%8C%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ç§»é™¤-preserveactionorder-å’Œ-predictableactionarguments">ç§»é™¤ <code>preserveActionOrder</code> å’Œ <code>predictableActionArguments</code><a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E7%A7%BB%E9%99%A4-preserveactionorder-%E5%92%8C-predictableactionarguments" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>æ‚¨çŽ°åœ¨å¯ä»¥ä»Žæœºå™¨é…ç½®ä¸­ç§»é™¤ <a href="https://ouweiya.github.io/xstate-zh/docs/migration#actions-ordered-by-default-predictableactionarguments-no-longer-needed"><code>preserveActionOrder</code> å’Œ <code>predictableActionArguments</code></a>ï¼Œå› ä¸ºåœ¨ XState v5 ä¸­å®ƒä»¬ä¸å†éœ€è¦ã€‚åŠ¨ä½œçŽ°åœ¨é»˜è®¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸” <a href="https://ouweiya.github.io/xstate-zh/docs/actions#assign-action"><code>assign</code> åŠ¨ä½œ</a> å°†å§‹ç»ˆæŒ‰å®šä¹‰çš„é¡ºåºè¿è¡Œã€‚</p>
<div class="tabs-container tabList_TRJ7"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_hGfb tabs__item--active">XState v4</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_hGfb">XState v5</li></ul><div class="padding-top--s"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:hsl(230, 4%, 64%)">// âŒ å·²å¼ƒç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createMachine </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  preserveActionOrder</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  predictableActionArguments</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> setup </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// preserveActionOrder å’Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// predictableActionArguments å·²è¢«ç§»é™¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> machine </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">setup</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token operator" style="color:hsl(221, 87%, 60%)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æŽ’æŸ¥-typescript-é”™è¯¯">æŽ’æŸ¥ TypeScript é”™è¯¯<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E6%8E%92%E6%9F%A5-typescript-%E9%94%99%E8%AF%AF" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>åœ¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œæ‚¨å¯èƒ½ä¼šé‡åˆ°è®¸å¤š TypeScript é”™è¯¯ï¼Œä¸è¦æ°”é¦ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†å®Œå…¨è¿ç§»æœºå™¨ä¸­çš„ä»»ä½•ä¸€ä¸ª <code>action</code>ï¼Œæ‚¨å¯èƒ½éœ€è¦å°†å…¶è½¬æ¢ä¸ºæœºå™¨é…ç½®ä¸­çš„å‚æ•°åŒ–å¯¹è±¡ï¼Œå¹¶åœ¨ <code>setup()</code> ä¸­æä¾›ç±»åž‹åŒ–çš„å®žçŽ°ï¼Œä»¥ä¿®å¤ TypeScript é”™è¯¯ã€‚</p>
<p>æ­¤å¤–ï¼ŒTypeScript å¯èƒ½ä¼šç»§ç»­å¯¹ä¼ é€’ç»™ <code>setup()</code> çš„ <code>actions</code> å®žçŽ°è¿›è¡ŒæŠ±æ€¨ï¼Œç›´åˆ°æœ€åŽä¸€ä¸ªåŠ¨ä½œè¢«æ­£ç¡®åŒ…å«å’Œç±»åž‹åŒ–ã€‚è¿™æ˜¯å› ä¸º TypeScript ä¼šä¸€æ¬¡æ€§æ£€æŸ¥æ•´ä¸ªæœºå™¨é…ç½®åŠå…¶æ‰€æœ‰å®žçŽ°ã€‚</p>
<aside class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4m0-4h.01M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>å¦‚æžœæ‚¨åœ¨æœºå™¨é…ç½®ä¸­çš„æŸä¸ªçŠ¶æ€åç§°ä¸‹çœ‹åˆ° TypeScript é”™è¯¯ï¼Œå¾ˆå¯èƒ½æ˜¯è¯¥çŠ¶æ€å†…çš„ <code>action</code> æˆ– <code>guard</code> å­˜åœ¨ç±»åž‹é”™è¯¯ã€‚</p></div></aside>
<p>TypeScript å¯èƒ½éš¾ä»¥å‡†ç¡®å®šä½æœºå™¨é…ç½®ä¸­çš„é”™è¯¯ä½ç½®ï¼Œå› æ­¤å®ƒé€šå¸¸ä¼šçªå‡ºæ˜¾ç¤ºçŠ¶æ€åç§°ã€‚</p>
<p><img loading="lazy" alt="è¯¯å¯¼æ€§çš„ TypeScript é”™è¯¯ï¼Œçªå‡ºæ˜¾ç¤ºçŠ¶æ€ï¼Œè€Œå…¶å†…éƒ¨åŠ¨ä½œç±»åž‹æ˜¯é—®é¢˜æ‰€åœ¨" src="https://ouweiya.github.io/xstate-zh/assets/images/misleading-typescript-error-38a2f69b394c27778aa3d1e3c9898be2.png" width="1000" height="178" class="img_ev3q"></p>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œé”™è¯¯çš„çœŸæ­£æ¥æºæ˜¯ <code>trackUpgradeModalLearnMoreClick</code> åŠ¨ä½œå°šæœªè½¬æ¢ä¸ºåŠ¨ä½œå¯¹è±¡ã€‚ä¿®å¤è¯¥é—®é¢˜åŽï¼Œâ€œç‚¹å‡»äº†è§£æ›´å¤šâ€çŠ¶æ€åç§°ä¸‹çš„é”™è¯¯å°±ä¼šæ¶ˆå¤±ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ€»ç»“">æ€»ç»“<a href="https://ouweiya.github.io/xstate-zh/blog/2024-02-02-migrating-machines-to-xstate-v5#%E6%80%BB%E7%BB%93" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>é€šè¿‡éµå¾ªä¸Šè¿°æ­¥éª¤ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿå°†çŽ°æœ‰çš„ XState v4 æœºå™¨è¿ç§»åˆ° XState v5ï¼Œå¹¶ä½¿æ‰€æœ‰ç±»åž‹æ­£å¸¸å·¥ä½œï¼Œè€Œæ— éœ€é€šè¿‡æ–­è¨€æˆ–ç±»åž‹å®ˆå«è¿›è¡Œç±»åž‹ç¼©å°ã€‚</p>
<p>å¸Œæœ›æœ¬æŒ‡å—å¯¹æ‚¨å°†çŽ°æœ‰çš„ XState v4 æœºå™¨è¿ç§»åˆ° XState v5 æœ‰æ‰€å¸®åŠ©ã€‚å¦‚æžœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–åé¦ˆï¼Œè¯·<a href="https://discord.gg/xstate" target="_blank" rel="noopener noreferrer">åœ¨æˆ‘ä»¬çš„ Discord ä¸Šè”ç³»æˆ‘ä»¬</a>ã€‚</p>]]></content>
        <author>
            <name>Kevin Maes</name>
            <uri>https://github.com/kevinmaes</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="studio" term="studio"/>
        <category label="é‡å¤§å˜åŒ–" term="é‡å¤§å˜åŒ–"/>
        <category label="è¿ç§»" term="è¿ç§»"/>
        <category label="XState v5" term="XState v5"/>
        <category label="çŠ¶æ€æœº" term="çŠ¶æ€æœº"/>
        <category label="xstate" term="xstate"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Changelog Week 5 2024]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-30-changelog</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-30-changelog"/>
        <updated>2024-01-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Embedding Figma frames has arrived in Stately Studio! Weâ€™ve also made more improvements and squashed some bugs. And have you tried Stately Agent yet?]]></summary>
        <content type="html"><![CDATA[<p>Embedding Figma frames has arrived in Stately Studio! Weâ€™ve also made more improvements and squashed some bugs. And have you tried <a href="https://www.youtube.com/live/c05bOPeinSA?si=Ti3otk_1-CE2mm00&amp;t=122" target="_blank" rel="noopener noreferrer">Stately Agent</a> yet?</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="embed-figma-frames">Embed Figma frames<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-30-changelog#embed-figma-frames" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Last week, we released our Figma integration, so you can now embed your Figma frames in Stately states. Your frames stay in sync with Figma, so you can be sure you always have the latest version of the design and your whole team is working from the same source of truth. <a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-25-embed-figma">Read more about the launch of our Figma integration</a>.</p>
<p><img loading="lazy" alt="Figma showing a frame with a mockup for a power button. Stately Studio showing that same frame embedded in the power off state." src="https://ouweiya.github.io/xstate-zh/assets/images/figma-embed-a8bbe50045df55906353107da95083ce.png" width="3352" height="1884" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-30-changelog#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li>We improved the modals for premium features so you can quickly learn more about what these features do and how they work.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-30-changelog#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li>We fixed the issue where importing code could result in the creation of extra empty machines.</li>
<li>You can now change the selected machine even if there was an error saving your machine.</li>
<li>The exported code implementations will no longer include unused guards, actors, and actions.</li>
<li>Interacting with a machine from the structure panel will no longer cause an error when changing repos synced with GitHub.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="wed-love-your-feedback">Weâ€™d love your feedback<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-30-changelog#wed-love-your-feedback" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Do you have a feature request you want to share with us? <a href="https://github.com/statelyai/feedback" target="_blank" rel="noopener noreferrer">Submit and upvote feature requests on our dedicated GitHub feedback repo</a>. Want to be the first to find out new features? Join us at our next office hours live stream. Find out when streams are planned by subscribing to <a href="https://www.youtube.com/@Statelyai" target="_blank" rel="noopener noreferrer">our YouTube channel</a> or <a href="https://www.twitch.tv/statelyai" target="_blank" rel="noopener noreferrer">Twitch channel</a> or <a href="https://www.linkedin.com/company/statelyai/" target="_blank" rel="noopener noreferrer">following us on LinkedIn</a>.</p>]]></content>
        <author>
            <name>Laura Kalbag</name>
            <uri>https://github.com/laurakalbag</uri>
        </author>
        <category label="changelog" term="changelog"/>
        <category label="new" term="new"/>
        <category label="figma" term="figma"/>
        <category label="embed" term="embed"/>
        <category label="improvements" term="improvements"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Building backend workflows with Stately: Credit checking flow]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-24-building-backend-workflows-credit-checking</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-24-building-backend-workflows-credit-checking"/>
        <updated>2024-01-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Join Gavin as he details an example backend credit reporting flow built with XState and Stately tooling. In this demo, he covers parallel states, final states, and conditional guards.]]></summary>
        <content type="html"><![CDATA[<p>Join Gavin as he details an example backend credit reporting flow built with XState and Stately tooling. In this demo, he covers parallel states, final states, and conditional guards.</p>
<!-- -->
<div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>
<p><a href="https://github.com/statelyai/xstate/tree/main/examples/mongodb-credit-check-api" target="_blank" rel="noopener noreferrer">Get the code for this example from the XState GitHub repo</a>.</p>
<p>Be the first to find out about our video by subscribing to <a href="https://www.youtube.com/@Statelyai" target="_blank" rel="noopener noreferrer">our YouTube channel</a>.</p>]]></content>
        <author>
            <name>Gavin Bauman</name>
            <uri>https://github.com/gavination</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="studio" term="studio"/>
        <category label="xstate" term="xstate"/>
        <category label="xstate v5" term="xstate v5"/>
        <category label="backend" term="backend"/>
        <category label="workflows" term="workflows"/>
        <category label="example" term="example"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Embed Figma designs in Stately]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-24-embed-figma</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-24-embed-figma"/>
        <updated>2024-01-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[You can now embed Figma frames in Stately states]]></summary>
        <content type="html"><![CDATA[<p>We already kicked off 2024 with several major updates to Stately such as <a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-15-stately-inspector">inspecting live XState code</a>, <a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync">syncing with GitHub</a>, and <a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources">writing code for actions and actors in the Studio</a>. Today weâ€™re excited to announce that weâ€™ve also launched an integration with Figma!</p>
<p>You can now attach Figma frames to states in Stately.</p>
<p><img src="https://ouweiya.github.io/blog/2024-01-24-embed-figma/figma-light.png" alt="Three Figma frames displayed in three Stately states for a music player. The ready state shows a record stack app view, following the openAlbum event, the viewingAlbum state shows the Wild Winds album coverart and information, from the viewingAlbum state, thereâ€™s a play event that takes you to the playingAlbum state which shows the album list for the Wild Winds album and a player progress bar. The pause event returns from the playingAlbum state to the viewingAlbum state." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-24-embed-figma/figma-dark.png" alt="Three Figma frames displayed in three Stately states for a music player. The ready state shows a record stack app view, following the openAlbum event, the viewingAlbum state shows the Wild Winds album coverart and information, from the viewingAlbum state, thereâ€™s a play event that takes you to the playingAlbum state which shows the album list for the Wild Winds album and a player progress bar. The pause event returns from the playingAlbum state to the viewingAlbum state." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improve-your-team-workflows-by-combining-stately-and-figma">Improve your team workflows by combining Stately and Figma<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-24-embed-figma#improve-your-team-workflows-by-combining-stately-and-figma" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Embedding Figma into Stately can significantly streamline and enhance a teamâ€™s workflow.</p>
<p>Being able to view mockups of the states you are discussing makes it easy to <em>see</em> what might be missing and to identify potential improvements. It allows team members to view designs directly as part of the app logic itself.</p>
<p>Two examples of how this can work are:</p>
<ul>
<li>
<p>Engineers can import state machine code, then designers can fill out images for each state of the actual logic in the code.</p>
</li>
<li>
<p>Designers, PMs, and other stakeholders can create the expected behavior by embedding Figma frames into a Stately diagram, then engineers can continue adding the functionality from the automatically scaffolded code.</p>
</li>
</ul>
<p>This seamless integration can speed up the design process and ensure all team members are on the same page. Team members can easily share design details, run critiques, and iterate with people across different specializations.</p>
<p>It also ensures that everyone is always looking at the most up-to-date design, as changes made in Figma are reflected in the embedded view. And with <a href="https://ouweiya.github.io/xstate-zh/blog/blog/2024-01-09-introducing-bidirectional-github-sync">GitHub Sync</a> enabled, changes to the code can even automatically update how the Figma frames are organized in Stately.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-embed-figma-frames">How to embed Figma frames<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-24-embed-figma#how-to-embed-figma-frames" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Figma embedding is part of our <a href="https://ouweiya.github.io/xstate-zh/docs/studio-pro-plan">Pro plan</a>. You can <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">try all our premium features for free with our free trial</a>.</p>
<p>To embed Figma frames in Stately, first you need to authenticate using a personal access token.</p>
<ol>
<li><a href="https://help.figma.com/hc/en-us/articles/8085703771159-Manage-personal-access-tokens" target="_blank" rel="noopener noreferrer">Get a personal access token</a> from Figma. Set "File content" to "Allow Read-only access" so Stately can get the images.</li>
<li>Enter this token in Stately by opening a project, finding the <strong>Stately menu</strong> in the top left, selecting <strong>Account</strong>, opening <strong>Settings</strong>, and clicking the <strong>Figma</strong> tab.</li>
</ol>
<p>Then you can link frames to states.</p>
<ol start="3">
<li>In Figma, right click on the frame you want to embed, select <strong>Copy/Paste as</strong>, then <strong>Copy link</strong>.</li>
<li>In Stately, select a state, open the <strong>+</strong> menu, choose <strong>Embed Figma</strong>, and paste your link.</li>
</ol>
<p><a href="https://www.youtube.com/live/c05bOPeinSA?si=qyUlnx7f7_StLDZ_&amp;t=1006" target="_blank" rel="noopener noreferrer">Watch a video of how embedding Figma frames works</a> from our recent Office Hours.</p>
<p><img loading="lazy" alt="Frame inside Figma showing the menu for copy/paste as, and copy link. Alongside a frame in Stately showing the plus menu and the Embed Figma option." src="https://ouweiya.github.io/xstate-zh/assets/images/figmatostately-86f0456e3e4ea8ae871c0bb77061fe3f.png" width="1600" height="547" class="img_ev3q"></p>
<p>Now any changes to this frame in Figma will be automatically reflected in Stately after each page load.</p>
<p>You can delete the embed or adjust the size of the image by selecting the state and finding the controls at the top right of the embedded image.</p>
<p>A few more details to get you rolling:</p>
<ul>
<li>Stately supports linking to any type of Figma node that you can get, not just frames. But we recommend generally using frames due to how well they correspond to states.</li>
<li>Figma embeds are a new type of <strong>asset</strong> in Stately. We also support <a href="https://ouweiya.github.io/xstate-zh/docs/assets">attaching images, videos, documents, and PDFs to states as assets</a>. You can feature a single asset on the canvas at a time. To feature a different asset, open the state details panel and drag that asset to the first position in the assets list.</li>
<li>Stately embeds Figma frames as SVG images. This means fast load times and great scaling quality across different sizes. However, a few features of Figma (like background blur) are not supported in svg exports. When you notice an issue and high visual fidelity is important, you can export the frame as a PNG image and then attach the image itself as an image asset to the Stately state (rather than as a Figma embed from a link). It just wonâ€™t be automatically synced.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="try-it-out">Try it out!<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-24-embed-figma#try-it-out" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>We are excited to see what you do with this feature. There is a lot of potential for reducing silos between roles and helping make communication smoother.</p>
<p>Please share your feedback with us on our <a href="https://discord.stately.ai/" target="_blank" rel="noopener noreferrer">social platforms</a> or in our regular <a href="https://www.youtube.com/watch?v=-Jf9N-EaUx0&amp;list=PLvWgkXBB3dd6PXbSoctwDXjWX-AQrxhds" target="_blank" rel="noopener noreferrer">office hours live streams</a>. If you want help getting started with embedding Figma frames or getting your team set up with Stately and XState, <a href="https://stately.ai/pricing#services" target="_blank" rel="noopener noreferrer">the Stately team is available for workshops and consulting</a>, and you can <a href="https://calendly.com/d/yc8-3hq-rpc/request-a-demo" target="_blank" rel="noopener noreferrer">book a demo call</a> with us to learn more about how Stately can work for your team.</p>]]></content>
        <author>
            <name>Nick Perich</name>
            <uri>https://github.com/cirephe</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="studio" term="studio"/>
        <category label="figma" term="figma"/>
        <category label="design" term="design"/>
        <category label="statecharts" term="statecharts"/>
        <category label="state machines" term="state machines"/>
        <category label="xstate" term="xstate"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[State Machines - Whatâ€™s in a name?]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name"/>
        <updated>2024-01-23T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[An overview of naming conventions for state machines, including tips and guidlines for naming]]></summary>
        <content type="html"><![CDATA[<p>State machines and visual diagrams are such a powerful way to organize, and convey information. All of those lovely â€œboxes and arrowsâ€ convey meaningful relationships, indicate sequential order, and direct flows in a way thatâ€™s easier to understand since it's visual. Add to that the ability to <a href="https://stately.ai/docs/assets" target="_blank" rel="noopener noreferrer">attach assets to your diagrams</a> and youâ€™re well on your way towards creating truly expressive, executable software diagrams. But thereâ€™s still one thing that state machines have that should make them easy to understand. Text.</p>
<!-- -->
<p>When I say text, Iâ€™m largely referring to <strong>names</strong>. States, events, actors, actions, and guards all have names. These are important since theyâ€™re included in the executable code or other <a href="https://stately.ai/docs/export-as-code" target="_blank" rel="noopener noreferrer">formats that are exported from Studio</a>, so they can't be arbitrary or merely decorative. Users often ask us for guidance on naming conventions in <a href="https://stately.ai/docs/xstate" target="_blank" rel="noopener noreferrer">XState</a> and how to name the parts of their state machines.</p>
<p>We can break down some of these questions into two categories:</p>
<ol>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#what-or-how-should-i-name-this-thing">What or how should I name this thing</a>?</li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#what-style-should-that-name-be-in">What style should that name be in</a>?</li>
</ol>
<iframe loading="lazy" src="https://stately.ai/registry/editor/embed/9fa24cc0-3026-41be-bb22-9afc3980fefc?machineId=db0e655e-f16f-4a30-97a7-a0081b73d532&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/9fa24cc0-3026-41be-bb22-9afc3980fefc?machineId=db0e655e-f16f-4a30-97a7-a0081b73d532">View the <em>A state machine demonstrating a particular naming convention with states using Title Case, events using dot.case, actions and actors using camelCase and guards using lower case.</em> machine in Stately Studio</a>.</iframe>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-or-how-should-i-name-this-thing">What or how should I name this thing?<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#what-or-how-should-i-name-this-thing" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>This question is largely about semantics and in this case that means how do the names used in a state machine convey the purpose and meaning of the elements and their role in a state machine? Should a state be named <strong><code>Load</code></strong>, <strong><code>Loader</code></strong>, <strong><code>Loading</code></strong>, or <strong><code>Loaded</code></strong>? Should an event be named <strong><code>Submit</code></strong>, <strong><code>Submit form</code></strong>, <strong><code>Form submitted</code></strong>, <strong><code>On submit</code></strong>, or <strong><code>Form submission</code></strong>? There are indeed many options to choose from and there's no one right answer. But there are some guidelines that can help you make the best choice.</p>
<p><strong>Mapping parts of speech to state machines</strong></p>
<p>One useful way to think about naming in state machines is to roughly map its elements to various parts of speech. This is what that might look like:</p>
<ol>
<li><strong>States</strong>: typically nouns or adjectives<!-- -->
<ul>
<li>States represent different conditions or modes of being. Therefore, they are often named with nouns or adjectives that describe the status or quality of the system. For example, <strong><code>idle</code></strong>, <strong><code>loading</code></strong>, <strong><code>authenticated</code></strong>, or <strong><code>error</code></strong>.</li>
</ul>
</li>
<li><strong>Events/transitions</strong>: Usually verbs<!-- -->
<ul>
<li>Events are triggers that cause state transitions. They are actions or occurrences, so they are best named with verbs. Examples include <strong><code>submit</code></strong>, <strong><code>cancel</code></strong>, <strong><code>fail</code></strong>, <strong><code>load</code></strong>, <strong><code>sign in</code></strong>, or <strong><code>clear form data</code></strong>.</li>
</ul>
</li>
<li><strong>Actions</strong>: verbs or verb phrases<!-- -->
<ul>
<li>Actions are operations executed in response to events or state transitions. They should be verbs or verb phrases that describe what action is being taken. For instance, <strong><code>sendRequest</code></strong>, <strong><code>displayError</code></strong>, <strong><code>updateData</code></strong>.</li>
</ul>
</li>
<li><strong>Guards</strong>: Often adjectives or past participles<!-- -->
<ul>
<li>Guards are conditional checks that determine if a transition should occur. They can be named with adjectives or past participles that describe the condition being met. Examples include <strong><code>isLoggedIn</code></strong>, <strong><code>hasValidData</code></strong>, <strong><code>isExpired</code></strong>. Youâ€™ll notice these are similar to how you might name boolean variables in code.</li>
</ul>
</li>
<li><strong>Parent states</strong>: Compound Nouns<!-- -->
<ul>
<li>For nested states, these can also be nouns like regular states or they could be adjectives indicating a subordinate level of the parent state which is a noun. An example might be a state called <strong><code>Viewing Shopping Cart</code></strong> with child states <strong><code>Empty</code></strong> and <strong><code>Populated</code></strong>.</li>
</ul>
</li>
<li><strong>Invoked Actors</strong>: nouns or gerunds<!-- -->
<ul>
<li>When a state machine invokes a service (like an API call), these are often named with nouns or gerunds (nouns derived from verbs and ending in -ing) that describe the service's function. Examples are <strong><code>fetchingData</code></strong>, <strong><code>userAuthentication</code></strong>.</li>
</ul>
</li>
</ol>
<p>By aligning the names in state machines with these parts of speech, the structure and functionality of the state machine becomes more intuitive and easier to understand, facilitating better communication and documentation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="be-brief-yet-specific">Be brief yet specific<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#be-brief-yet-specific" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Just like with naming anything in code, itâ€™s helpful to pick names that are brief, not generic, yet contain just enough information to be unambiguous. Make names â€œminimally meaningfulâ€.</p>
<p>State name examples:</p>
<ul>
<li><strong><code>Idle</code></strong> instead of <strong><code>State1</code></strong></li>
<li><strong><code>Door Closed</code></strong> instead of <strong><code>Closed</code></strong></li>
<li><strong><code>Payment Processing</code></strong> instead of <strong><code>State_Awaiting_Payment</code></strong></li>
</ul>
<p>Event name examples:</p>
<ul>
<li><strong><code>Submit</code></strong> or <strong><code>submit</code></strong> instead of <strong><code>Event1</code></strong></li>
<li><strong><code>Receive payment</code></strong> instead of <strong><code>Event_Payment_Received</code></strong></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-style-should-that-name-be-in">What style should that name be in?<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#what-style-should-that-name-be-in" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>When statecharts were first introduced in <a href="https://www.inf.ed.ac.uk/teaching/courses/seoc/2005_2006/resources/statecharts.pdf" target="_blank" rel="noopener noreferrer">â€œStatecharts: A visual formalism for complex systemsâ€ (Harel, 1987)</a>, there was relatively little discussion of naming conventions and many of the diagrams used letters and numbers to represent states and events. The innovations that statecharts introduced were focused on visually representing relationships needed to support real world software use cases such as hierarchy, parallelism, history states, etc.</p>
<p><img loading="lazy" alt="An example of parallel states taken from Statecharts: A visual formalism for complex systems by David Harel." src="https://ouweiya.github.io/xstate-zh/assets/images/orthogonality-a8b2be3e9745e05cc6351ce3be31bf33.png" width="1000" height="645" class="img_ev3q"></p>
<p>Some of the examples later in the paper did demonstrate the use of state and event labels but these were usually single words or short phrases without attention paid to style. Interestingly enough, this example makes use of a <strong><code>dot.case</code></strong> style for event names which you can <a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#xstate-v5-and-dotcase">jump ahead and read about here</a>.</p>
<p><img loading="lazy" alt="An example of states and events from a statechart depicting the alarm on a Citizen Quartz watch." src="https://ouweiya.github.io/xstate-zh/assets/images/watch-batteries-e2bc9d67fda2bab196f62dce083508a4.png" width="1000" height="446" class="img_ev3q"></p>
<p>By the time the book, "Constructing the User Interface with Statecharts" (Horrocks, 1999) was published, more descriptive state and event labels were present in elaborate examples of statecharts used to model hardware and software systems. This example of a CD player (remember those?) is rather detailed and also quite clear in its use of names and text annotations on the statechart. You can <a href="https://stately.ai/registry/editor/9fa24cc0-3026-41be-bb22-9afc3980fefc?machineId=5b186011-088e-4c1c-be95-9a489a126b13" target="_blank" rel="noopener noreferrer">view this state machine inspired by this example</a> or <a href="https://stately.ai/registry/editor/9fa24cc0-3026-41be-bb22-9afc3980fefc?machineId=24adba0d-a6ac-4e79-836c-e0d91bb7ab85" target="_blank" rel="noopener noreferrer">see the full example</a> borrowed from the book.</p>
<p><img loading="lazy" alt="Part of a statechart for a physical CD player including states for when the CD is playing, stopped, paused, and events transitioning the machine from state to state." src="https://ouweiya.github.io/xstate-zh/assets/images/horrocks-cd-c03fecea0d9b3d854e8f17bf429f8c11.png" width="1000" height="941" class="img_ev3q"></p>
<p>Over the decades since those early writings on statecharts, the emergence of nearly all of the major programming languages in use today have popularized a number of naming conventions for code. Here are some of the most common styles you can choose from when naming states, events, actions, and guards in XState:</p>
<ul>
<li><strong><code>Title Case</code></strong></li>
<li><strong><code>Sentence case</code></strong></li>
<li><strong><code>lower case</code></strong></li>
<li><strong><code>UPPER CASE</code></strong></li>
<li><strong><code>PascalCase</code></strong></li>
<li><strong><code>camelCase</code></strong></li>
<li><strong><code>snake_case</code></strong></li>
<li><strong><code>kebab-case</code></strong></li>
</ul>
<p>When XState was released in 2016, many of the early examples demonstrated use of <strong><code>UPPER_CASE</code></strong> for event names (also in fashion for Redux action types) and <strong><code>camelCase</code></strong> for nearly everything else like states, actions, guards, etc. But <a href="https://stately.ai/docs/xstate" target="_blank" rel="noopener noreferrer">XState</a> doesn't enforce any particular convention and it's up to you to decide what works best for you and your team. Space-separated styles like <strong><code>Title Case</code></strong>, <strong><code>Sentence case</code></strong>, and <strong><code>lower case</code></strong> are valid options you can wrap them in quotes to use as JavaScript or TypeScript XState object keys. <a href="https://stately.ai/docs/export-as-code" target="_blank" rel="noopener noreferrer">Stately Studio will export code</a> with your names in quotes as well.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="xstate-v5-and-dotcase">XState v5 and <code>dot.case</code><a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#xstate-v5-and-dotcase" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Fast forward to 2024, with the <a href="https://stately.ai/blog/2023-12-01-xstate-v5" target="_blank" rel="noopener noreferrer">recent release of XState v5</a>, one particular style convention for event names is strongly encouraged and that's <strong><code>dot.case</code></strong>. If you recall in the image of the Quartz watch, above, there were events similar to <strong><code>battery.inserted</code></strong>, <strong><code>battery.removed</code></strong>, and <strong><code>weak battery.dies</code></strong>. This style allows for a <a href="https://stately.ai/docs/transitions#wildcard-transitions" target="_blank" rel="noopener noreferrer">new feature in XState v5 called wildcard transitions</a>. For example, if you had an action called <code>logBatteryStatus</code> you could register that action with any number of events matching <strong><code>battery.*</code></strong>, a wildcard transition:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">states</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  Running</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    on</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token string-property property" style="color:hsl(5, 74%, 59%)">'battery.*'</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        actions</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'logBatteryStatus'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I personally like this convention for events because it visually distinguishes them from other name in the state machine and its lack of heavy capitalization make it look more <strong><code>streamlined.for.action</code></strong>, like events should be!</p>
<aside class="theme-admonition theme-admonition-warning alert alert--danger admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 24 24"><path stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v4m0 4h.01m9.72 1-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2.001 2.001 0 0 0 1.73-3Z"></path></svg></span></div><div class="admonitionContent_vXIg"><p>Unlike for event names, it is currently not possible to include a <code>.</code> when naming states or machines. Please do not do this.</p></div></aside>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="other-tips">Other tips<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#other-tips" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Here are some additional considerations to think about when choosing a naming style for use with XState to make your state machines more readable and easier to understand.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="improved-readability">Improved readability<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#improved-readability" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>One of my favorite tips for state machine naming is to use contrasting styles. Contrast is a key ingredient for many things we love from food to color, art, and music. The readability of state machines can also benefit from contrast. If you use <strong><code>SHOUTY_UPPERCASE</code></strong> event names then please donâ€™t also use that case for state names orâ€¦ anything else in the same machine really. At the same time, donâ€™t just name every state, event, and action in <strong><code>plain old lower case</code></strong> unless you want your state machine to be read like the equivalent of a bored teen with â€œvocal fryâ€. Differentiation can help readers distinguish certain elements of the state machine from others and this applies to readability on the editor canvas as well as in code.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="know-your-audience">Know your audience<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#know-your-audience" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>The fact that Statey Studio can turn these executable diagrams into code is certainly powerful but what if much of your intended audience is less technical and will be viewing your state machines in the Studio? Some viewers may be more accustomed to reading some of the naming styles more than others, for example, <strong><code>Sentence case</code></strong> as opposed to <strong><code>snake_case</code></strong>. Users on the <a href="https://stately.ai/docs/studio-pro-plan" target="_blank" rel="noopener noreferrer">Studio Pro Plan</a> can make use of <a href="https://stately.ai/docs/versions" target="_blank" rel="noopener noreferrer">Version History</a> to create differently styled version of the same state machines and share them with different audiences either by <a href="https://stately.ai/docs/url#copy-the-url-from-the-browser-address-bar" target="_blank" rel="noopener noreferrer">sharing the URL to a specific machine version</a> or by <a href="https://stately.ai/docs/export-as-code" target="_blank" rel="noopener noreferrer">exporting to markdown, Stories, tests, etc</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="consistency-is-key">Consistency is Key<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#consistency-is-key" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Choose whatever you want but try to be consistent. Readers will hopefully understand your chosen naming convention and will come to rely on it. If you name states <strong><code>Waiting</code></strong>, <strong><code>Downloading</code></strong>, <strong><code>Synchronizing</code></strong> then when they see another word ending in <strong><code>ing</code></strong> theyâ€™ll probably assume itâ€™s also a state as opposed to an event. Similarly, if you name actions using <strong><code>camelCase</code></strong>, you might consider naming all actions in that way, whether theyâ€™re entry/exit actions on states or actions on transitions. So remember, consistency is key here.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="conventions-and-maintenance">Conventions and maintenance<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#conventions-and-maintenance" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>From consistency, conventions often emerge. These could be conventions adhered to across a state machine, an entire project or across all of the projects of a particular user or team. This makes the work easier to understand and easier to maintain, thereby facilitating collaboration.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-23-state-machines-whats-in-a-name#summary" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Naming conventions and namings styles are a matter of taste but also an opportunity for customization and personalization at the individual or team level. The most important thing is readability, consistency and using naming to convey meaning.</p>
<iframe loading="lazy" src="https://stately.ai/studio/editor/embed/9fa24cc0-3026-41be-bb22-9afc3980fefc?mode=design&amp;machineId=5b186011-088e-4c1c-be95-9a489a126b13&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/studio/editor/embed/9fa24cc0-3026-41be-bb22-9afc3980fefc?mode=design&amp;machineId=5b186011-088e-4c1c-be95-9a489a126b13">View the <em>A state machine for part of the CD player example showing states for when the CD is loaded and the CD is stopped, playing, and paused.</em> machine in Stately Studio</a>.</iframe>
<p>Sometimes putting attention into the little details goes a long way towards ensuring that machines not only look good but are as understandable as possible. And remember, when your state machines look good, you look good too!</p>]]></content>
        <author>
            <name>Kevin Maes</name>
            <uri>https://github.com/kevinmaes</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="studio" term="studio"/>
        <category label="coding conventions" term="coding conventions"/>
        <category label="naming" term="naming"/>
        <category label="semantics" term="semantics"/>
        <category label="style" term="style"/>
        <category label="statecharts" term="statecharts"/>
        <category label="state machines" term="state machines"/>
        <category label="xstate" term="xstate"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Changelog Week 3 2024]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-19-changelog</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-19-changelog"/>
        <updated>2024-01-19T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This week, the headline is Stately Inspector! But weâ€™ve also made some improvements and fixed a few bugs in Stately Studio.]]></summary>
        <content type="html"><![CDATA[<p>This week, the headline is Stately Inspector! But weâ€™ve also made some improvements and fixed a few bugs in Stately Studio.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stately-inspector">Stately Inspector<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-19-changelog#stately-inspector" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>This week, we released Stately Inspector in beta. Stately Inspector is a tool that allows you to inspect your applicationâ€™s state visually. It primarily works with frontend applications using XState but can also work with backend code and code that uses any state management solution. <a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-15-stately-inspector">Read more about the launch of Stately Inspector</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-19-changelog#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li>Weâ€™ve made it much clearer that you cannot change machines during a save.</li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/stately-sky-getting-started">Workflows</a> are now started after a deploy.</li>
<li>Users who have downgraded their subscription can now change their read-only Private projects to Public projects to gain full editing access.</li>
<li><a href="https://stately.ai/docs/import-from-github" target="_blank" rel="noopener noreferrer">GitHub sync</a> now only shows a separate â€œunsynced machinesâ€ section if the user can edit the connected project.</li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/descriptions">Descriptions</a> now work more predictably and will automatically receive focus when creating a new description.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-19-changelog#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li>We fixed a bug where changing repos after interacting with the file tree would cause an error. This was due to the change in the file tree structure from the newly selected repo.</li>
<li>Copy-pasting an action block will no longer crash the editor.</li>
<li>We also fixed a bug where the <strong>Fit to content</strong> or <strong>Fit to selection</strong> buttons were disabled when the zoom level was 10%.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="wed-love-your-feedback">Weâ€™d love your feedback<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-19-changelog#wed-love-your-feedback" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Do you have any questions about these features? Want to be the first to find out new features? Join us at our next office hours live stream. Find out when streams are planned by subscribing to <a href="https://www.youtube.com/@Statelyai" target="_blank" rel="noopener noreferrer">our YouTube channel</a> or <a href="https://www.twitch.tv/statelyai" target="_blank" rel="noopener noreferrer">Twitch channel</a> or <a href="https://www.linkedin.com/company/statelyai/" target="_blank" rel="noopener noreferrer">following us on LinkedIn</a>.</p>]]></content>
        <author>
            <name>Laura Kalbag</name>
            <uri>https://github.com/laurakalbag</uri>
        </author>
        <category label="changelog" term="changelog"/>
        <category label="new" term="new"/>
        <category label="stately inspector" term="stately inspector"/>
        <category label="improvements" term="improvements"/>
        <category label="bug fixes" term="bug fixes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Stately Office Hours 79]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-19-office-hours</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-19-office-hours"/>
        <updated>2024-01-19T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Watch our latest office hours live stream where we cover Stately Agent, Figma Embed, and more.]]></summary>
        <content type="html"><![CDATA[<p>Watch our latest office hours live stream where we cover Stately Agent, Figma Embed, and more.</p>
<!-- -->
<div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="chapters">Chapters<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-19-office-hours#chapters" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Watch the video to find out about our new features and plans for 2024. Use the links below to jump straight to that chapter in the video:</p>
<ul>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=0s" target="_blank" rel="noopener noreferrer">0:00 Intro</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=24s" target="_blank" rel="noopener noreferrer">0:24 Team intros</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=72s" target="_blank" rel="noopener noreferrer">1:12 What is XState?</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=122s" target="_blank" rel="noopener noreferrer">02:02 Stately Agent (alpha)</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=954s" target="_blank" rel="noopener noreferrer">15:54 When will the XState VS Code extensiom be upgraded?</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=1006s" target="_blank" rel="noopener noreferrer">16:46 Embed Figma frames</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=1668s" target="_blank" rel="noopener noreferrer">27:48 Can I input different models with Stately Agent?</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=1786s" target="_blank" rel="noopener noreferrer">29:46 Stately Inspector</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=1956s" target="_blank" rel="noopener noreferrer">32:36 Will there be a GitLab integration?</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=1997s" target="_blank" rel="noopener noreferrer">33:17 Does actor.subscribe provide the same details as the inspect feature?</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=2048s" target="_blank" rel="noopener noreferrer">34:08 XState V5 support in Stately Studio</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=2096s" target="_blank" rel="noopener noreferrer">34:56 Does Stately Inspect already work with React?</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=2124s" target="_blank" rel="noopener noreferrer">35:24 Services from the Stately team</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=2177s" target="_blank" rel="noopener noreferrer">36:17 THAT conference</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=2227s" target="_blank" rel="noopener noreferrer">37:07 Catch up on the Stately teams' conference talks</a></li>
<li><a href="https://youtube.com/watch?v=c05bOPeinSA&amp;t=2282s" target="_blank" rel="noopener noreferrer">38:02 Wrap up</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="links-from-this-weeks-office-hours">Links from this weekâ€™s office hours<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-19-office-hours#links-from-this-weeks-office-hours" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=-Jf9N-EaUx0" target="_blank" rel="noopener noreferrer">Last office hours</a></li>
<li><a href="https://stately.ai/blog/2024-01-09-introducing-bidirectional-github-sync" target="_blank" rel="noopener noreferrer">GitHub Sync</a></li>
<li><a href="https://stately.ai/blog/2024-01-09-introducing-sources" target="_blank" rel="noopener noreferrer">Sources</a></li>
<li><a href="https://github.com/statelyai/agent" target="_blank" rel="noopener noreferrer">Stately Agent</a></li>
<li><a href="https://stately.ai/docs/assets" target="_blank" rel="noopener noreferrer">State assets</a></li>
<li><a href="https://stately.ai/blog/2024-01-15-stately-inspector/" target="_blank" rel="noopener noreferrer">Stately Inspector</a></li>
<li><a href="https://stately.ai/docs/inspector" target="_blank" rel="noopener noreferrer">Stately Inspector docs</a></li>
<li><a href="https://thatconference.com/tx/2024/" target="_blank" rel="noopener noreferrer">THAT conference</a></li>
<li><a href="https://feedback.stately.ai/" target="_blank" rel="noopener noreferrer">Feedback and feature requests</a></li>
<li><a href="https://github.com/statelyai/feedback/issues/384" target="_blank" rel="noopener noreferrer">Feature request for GitLab sync</a></li>
<li><a href="https://www.youtube.com/watch?v=FamZ0grhyK8&amp;list=PLvWgkXBB3dd63Pp8cFAY61FwjND9ROwXx" target="_blank" rel="noopener noreferrer">Stately talks playlist</a></li>
</ul>
<p>Got any questions for the team? Want to share how youâ€™re using Stately or XState? Join us live, or share your questions in our <a href="https://discord.stately.ai/" target="_blank" rel="noopener noreferrer">Discordâ€™s office-hours channel</a>.</p>
<p>Be the first to find out about our next office hours by subscribing to <a href="https://www.youtube.com/@Statelyai" target="_blank" rel="noopener noreferrer">our YouTube channel</a>, <a href="https://www.twitch.tv/statelyai" target="_blank" rel="noopener noreferrer">Twitch channel</a>, or <a href="https://www.linkedin.com/company/statelyai/" target="_blank" rel="noopener noreferrer">following us on LinkedIn</a>.</p>]]></content>
        <author>
            <name>Laura Kalbag</name>
            <uri>https://github.com/laurakalbag</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="studio" term="studio"/>
        <category label="office hours" term="office hours"/>
        <category label="xstate" term="xstate"/>
        <category label="github sync" term="github sync"/>
        <category label="figma" term="figma"/>
        <category label="state assets" term="state assets"/>
        <category label="stately inspector" term="stately inspector"/>
        <category label="VS Code extension" term="VS Code extension"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Introducing Stately Inspector]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-15-stately-inspector</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-15-stately-inspector"/>
        <updated>2024-01-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Stately Inspector is a universal tool that enables you to visually inspect the state of any application, frontend or backend, with the visualization of Statelyâ€™s editor.]]></summary>
        <content type="html"><![CDATA[<p>One of the most popular features of our legacy Stately Viz was its ability to inspect your app in real-time using the previous <code>@xstate/inspect</code> and Stately Viz tools. We wanted to bring this functionality into a universal tool that enables you to visually inspect the state of any application, frontend or backend, with the visualization of <a href="https://state.new/" target="_blank" rel="noopener noreferrer">Statelyâ€™s editor</a>. So we built Stately Inspector.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-stately-inspector">What is Stately Inspector?<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-15-stately-inspector#what-is-stately-inspector" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Stately Inspector is a tool that allows you to inspect your applicationâ€™s state visually. It primarily works with frontend applications using XState but can also work with backend code and code that uses any state management solution.</p>
<p><a href="https://www.youtube.com/live/-Jf9N-EaUx0?feature=shared&amp;t=408" target="_blank" rel="noopener noreferrer">Watch a demo of Stately Inspector in our most recent office hours</a>:</p>
<div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-stately-inspect">Installing Stately Inspect<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-15-stately-inspector#installing-stately-inspect" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>To inspect applications with Stately Inspector, install <a href="https://github.com/statelyai/inspect" target="_blank" rel="noopener noreferrer">Stately Inspect</a> from npm via <code>@statelyai/inspect</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">npm install @statelyai/inspect</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then, import the relevant inspector creator into your app. The creator is used to create an inspector (e.g., a browser or WebSocket inspector) to connect to XState actors and/or manually send inspection events to Stately Inspector:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createActor </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'xstate'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createBrowserInspector </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@statelyai/inspect'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> machine </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'./machine'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> inspector </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createBrowserInspector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> actor </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createActor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token plain">machine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  inspect</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> inspector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token plain">inspect</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ... other actor options</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">actor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">start</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, when you run your app, you should see a new tab or popup open in your browser that looks something like this:</p>
<p><img src="https://ouweiya.github.io/blog/2024-01-15-introducing-stately-inspector/inspector.png" alt="The Stately Inspector view, showing a state machine for the pizza ordering process. The current state and available event is highlighted in green." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-15-introducing-stately-inspector/inspector-dm.png" alt="The Stately Inspector view, showing a state machine for the pizza ordering process. The current state and available event is highlighted in green." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sending-inspection-events">Sending inspection events<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-15-stately-inspector#sending-inspection-events" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>The <code>@statelyai/inspect</code> package will send inspection events to the connected Stately Inspector. There are currently three kinds of events sent:</p>
<ul>
<li>Actor creation events</li>
<li>Actor-to-actor communication events</li>
<li>Actor snapshot changes</li>
</ul>
<p>When you pass in the <code>inspect</code> option to the actor options in XStateâ€™s <code>createActor(machine, options)</code> function, it will automatically send all of these inspection events.</p>
<p>For usage with other state management solutions, you can manually send inspection events using the following methods:</p>
<ul>
<li><code>inspector.actor(actor, snapshot, info)</code> - send actor creation events</li>
<li><code>inspector.event(actor, event, info)</code> - send actor-to-actor communication events</li>
<li><code>inspector.snapshot(actor, snapshot, info)</code> - send actor snapshot changes</li>
</ul>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token keyword" style="color:hsl(301, 63%, 40%)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> createBrowserInspector </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'@statelyai/inspect'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token plain"> inspector </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> </span><span class="token function" style="color:hsl(221, 87%, 60%)">createBrowserInspector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// Imagine a todo app...</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">inspector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">actor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'todos'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// When a todo is created</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">inspector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">actor</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'todo-1'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> status</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'active'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// When a user completes a todo</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">inspector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'todo-1'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'todo.complete'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// When a todo changes</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">inspector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">snapshot</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'todo-1'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  context</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> status</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'completed'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// When the todos actor (not the user) sends an event to a todo</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">inspector</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">.</span><span class="token function" style="color:hsl(221, 87%, 60%)">event</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token string" style="color:hsl(119, 34%, 47%)">'todo-1'</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> type</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'todo.update'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  source</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'todos'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:hsl(230, 4%, 64%)">// ... etc.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The above is a contrived example demonstrating how you can instrument inspector events at any time from any part of your app. The three types of inspection events contain everything that Stately Inspector needs to generate two kinds of real-time diagrams automatically:</p>
<ul>
<li><strong>State machine diagrams</strong> (if a state machine definition is provided)</li>
<li><strong>Sequence diagrams</strong></li>
</ul>
<p><img src="https://ouweiya.github.io/blog/2024-01-15-introducing-stately-inspector/machine-and-sequence-diagram.png" alt="The Stately Inspector view, showing a state machine and a sequence diagram for the pizza ordering process side-by-side." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-15-introducing-stately-inspector/machine-and-sequence-diagram-dm.png" alt="The Stately Inspector view, showing a state machine and a sequence diagram for the pizza ordering process side-by-side." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="coming-soon">Coming soon<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-15-stately-inspector#coming-soon" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>The goal of Stately Inspector is to be a universal tool that enables you to visually inspect the state of any application, frontend or backend. Right now, itâ€™s optimized for XState (with <code>inspector.inspect</code>) or non-XState (with <code>inspector.actor(...)</code>, <code>inspector.event(...)</code>, <code>inspector.snapshot(...)</code>) state management solutions in frontend applications. We would love your feedback so that we can prioritize:</p>
<ul>
<li><strong><a href="https://github.com/statelyai/feedback/issues/387" target="_blank" rel="noopener noreferrer">A websocket inspector creator</a></strong>: inspect frontend and/or backend applications remotely.</li>
<li><strong><a href="https://github.com/statelyai/feedback/issues/388" target="_blank" rel="noopener noreferrer">Bidirectional communication</a></strong>: send events from Stately Inspector to your live application.</li>
<li><strong><a href="https://github.com/statelyai/feedback/issues/389" target="_blank" rel="noopener noreferrer">Middleware for popular libraries</a></strong>: e.g., Redux, MobX, Zustand, and more.</li>
<li><strong><a href="https://github.com/statelyai/feedback/issues/390" target="_blank" rel="noopener noreferrer">Sync with Stately Studio</a></strong>: enrich inspected machines with information (layouts, colors, assets, annotations, etc.) from Stately Studio.</li>
<li><strong><a href="https://github.com/statelyai/feedback/issues/391" target="_blank" rel="noopener noreferrer">Analytics</a></strong>: view real-time analytics of flows in your application.</li>
</ul>
<p><a href="https://discord.stately.ai/" target="_blank" rel="noopener noreferrer">Let us know your thoughts on our Discord server</a> or <a href="https://feedback.stately.ai/" target="_blank" rel="noopener noreferrer">submit a feature request on our GitHub board</a>. Want to be the first to know about upcoming features? Subscribe to our <a href="https://www.youtube.com/@Statelyai" target="_blank" rel="noopener noreferrer">YouTube channel</a> or <a href="https://www.linkedin.com/company/statelyai/" target="_blank" rel="noopener noreferrer">follow us on LinkedIn</a> to avoid missing our next office hours live stream.</p>]]></content>
        <author>
            <name>David Khourshid</name>
            <uri>https://github.com/davidkpiano</uri>
        </author>
        <category label="inspector" term="inspector"/>
        <category label="stately" term="stately"/>
        <category label="xstate" term="xstate"/>
        <category label="actors" term="actors"/>
        <category label="devtools" term="devtools"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[XState: Exploring actors live stream]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-12-xstate-exploring-actors</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-12-xstate-exploring-actors"/>
        <updated>2024-01-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Watch our latest live stream where we cover actors in XState. Learn more about common use cases, more complex state machines, and the actor model.]]></summary>
        <content type="html"><![CDATA[<p>Watch our latest live stream where we cover actors in XState. Learn more about common use cases, more complex state machines, and the actor model.</p>
<!-- -->
<div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="chapters">Chapters<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-12-xstate-exploring-actors#chapters" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Watch the video to find out about actors in XState V5:</p>
<ul>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=0s" target="_blank" rel="noopener noreferrer">0:00 Intro</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=70s" target="_blank" rel="noopener noreferrer">1:10 Team intros</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=92s" target="_blank" rel="noopener noreferrer">1:32 XState V5: actor first</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=128s" target="_blank" rel="noopener noreferrer">2:08 Modeling a cocoa dispensing machine in the Studio</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=634s" target="_blank" rel="noopener noreferrer">10:34 Modeling actors</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=743s" target="_blank" rel="noopener noreferrer">12:23 Actor sequence diagram</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=932s" target="_blank" rel="noopener noreferrer">15:32 Adding implementation details</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=1321s" target="_blank" rel="noopener noreferrer">22:01 Spawning actors</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=1575s" target="_blank" rel="noopener noreferrer">26:15 Callback actors</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=1777s" target="_blank" rel="noopener noreferrer">29:37 Inspect your actor system</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=2040s" target="_blank" rel="noopener noreferrer">34:00 Actor communication</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=2277s" target="_blank" rel="noopener noreferrer">37:57 Difference between invoked and spawned actors</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=2329s" target="_blank" rel="noopener noreferrer">38:49 Generating a React app from your machine</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=2369s" target="_blank" rel="noopener noreferrer">39:29 Spawning arrays of actors</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=2544s" target="_blank" rel="noopener noreferrer">42:24 Managing and modeling spawned actors</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=2973s" target="_blank" rel="noopener noreferrer">49:33 Enqueue actions</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=3139s" target="_blank" rel="noopener noreferrer">52:19 Why are actions not called effects?</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=3193s" target="_blank" rel="noopener noreferrer">53:13 What is a good example of output from a child actor to a parent actor?</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=3661s" target="_blank" rel="noopener noreferrer">1:01:01 Migrating from XState V4 to V5</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=3701s" target="_blank" rel="noopener noreferrer">1:01:41 Promise actors</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=3817s" target="_blank" rel="noopener noreferrer">1:03:37 Transition actors</a></li>
<li><a href="https://youtube.com/watch?v=Rj7lOvDwcYs&amp;t=3883s" target="_blank" rel="noopener noreferrer">1:04:43 Wrap up</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="links-and-further-resources">Links and further resources<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-12-xstate-exploring-actors#links-and-further-resources" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=TRVjeil-y74" target="_blank" rel="noopener noreferrer">Want to get into the basics of XState?</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2023-12-01-xstate-v5">XState V5 release blog post</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/announcing-xstate-v5-beta#partial-event-descriptors">Partial event descriptors</a></li>
<li><a href="https://www.tldraw.com/" target="_blank" rel="noopener noreferrer">TLDraw</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2023-11-20-stately-studio-2-0#generate-ui-prototypes">Generate React app with Stately</a></li>
<li><a href="https://codesandbox.io/p/sandbox/beautiful-rgb-x3q94p?file=%2Fmachine.ts" target="_blank" rel="noopener noreferrer">CodeSandbox code</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/typescript#specifying-types">Use setup(...) to specify types</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources">Blog post on Sources</a></li>
<li><a href="https://feedback.stately.ai/" target="_blank" rel="noopener noreferrer">Request features at</a></li>
<li><a href="https://github.com/statelyai/inspect" target="_blank" rel="noopener noreferrer">Stately Inspector</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/migration">Migrating to XState V5 docs</a></li>
<li><a href="https://youtube.com/live/s-nqoIbIZac" target="_blank" rel="noopener noreferrer">Migrating to XState V5 webinar</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/promise-actors">Promise actors</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/transition-actors">Transition actors</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/observable-actors">Observable actors</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/docs/callback-actors">Callback actors</a></li>
<li><a href="https://stately.ai/" target="_blank" rel="noopener noreferrer">Stately Studio</a></li>
<li><a href="https://discord.stately.ai/" target="_blank" rel="noopener noreferrer">Join our Discord</a></li>
</ul>
<p>Be the first to find out about our next live stream by subscribing to <a href="https://www.youtube.com/@Statelyai" target="_blank" rel="noopener noreferrer">our YouTube channel</a>, <a href="https://www.twitch.tv/statelyai" target="_blank" rel="noopener noreferrer">Twitch channel</a>, or <a href="https://www.linkedin.com/company/statelyai/" target="_blank" rel="noopener noreferrer">following us on LinkedIn</a>.</p>]]></content>
        <author>
            <name>Laura Kalbag</name>
            <uri>https://github.com/laurakalbag</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="studio" term="studio"/>
        <category label="video" term="video"/>
        <category label="live stream" term="live stream"/>
        <category label="xstate" term="xstate"/>
        <category label="xstate v5" term="xstate v5"/>
        <category label="actors" term="actors"/>
        <category label="inspect" term="inspect"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Building backend workflows with Stately: Media scanning]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-11-building-backend-workflows</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-11-building-backend-workflows"/>
        <updated>2024-01-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Watch Gavin as he covers an example backend media scanning workflow defined and implemented with XState and Stately tooling.]]></summary>
        <content type="html"><![CDATA[<p>Watch Gavin as he covers an example backend media scanning workflow defined and implemented with XState and Stately tooling.</p>
<!-- -->
<div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>
<p><a href="https://github.com/statelyai/xstate/tree/main/examples/workflow-media-scanner" target="_blank" rel="noopener noreferrer">Get the code for this example from the XState GitHub repo</a>.</p>
<p>Be the first to find out about our video by subscribing to <a href="https://www.youtube.com/@Statelyai" target="_blank" rel="noopener noreferrer">our YouTube channel</a>.</p>]]></content>
        <author>
            <name>Gavin Bauman</name>
            <uri>https://github.com/gavination</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="studio" term="studio"/>
        <category label="xstate" term="xstate"/>
        <category label="xstate v5" term="xstate v5"/>
        <category label="backend" term="backend"/>
        <category label="workflows" term="workflows"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Changelog Week 2 2024]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-11-changelog</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-11-changelog"/>
        <updated>2024-01-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Weâ€™ve had a busy start to 2024 with the release of GitHub Sync, sources, and draft projects. Weâ€™ve also made plenty of improvements and fixed a few bugs.]]></summary>
        <content type="html"><![CDATA[<p>Weâ€™ve had a busy start to 2024 with the release of GitHub Sync, sources, and draft projects. Weâ€™ve also made plenty of improvements and fixed a few bugs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="github-sync">GitHub Sync<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-11-changelog#github-sync" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>You can connect a GitHub repo to a new project in Stately Studio, keeping updates between GitHub and Stately Studio in sync. Connecting a GitHub repo allows you to import your existing machines from GitHub and push changes to your machines back to your repo as pull requests. <a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync">Read more about GitHub Sync in our recent blog post</a>.</p>
<p><em>GitHub Sync is a premium feature of Stately Studio. You can try Stately Studioâ€™s premium plans with a free trial. <a href="https://ouweiya.github.io/xstate-zh/docs/studio-pro-plan">Check out the features on our Pro plan</a>, <a href="https://ouweiya.github.io/xstate-zh/docs/studio-team-plan">Team plan</a>, <a href="https://ouweiya.github.io/xstate-zh/docs/studio-enterprise-plan">Enterprise plan</a> or <a href="https://stately.ai/registry/billing" target="_blank" rel="noopener noreferrer">upgrade your existing plan</a>.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sources">Sources<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-11-changelog#sources" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Using the <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg> <strong>Sources</strong> panel, you can now provide source code for your actions, actors, and guards implementations inside Statelyâ€™s editor. You can add custom source code from the <strong>Sources</strong> panel to suit your needs or choose from logic templates. Your source code will be included in your <a href="https://ouweiya.github.io/xstate-zh/docs/stately-sky-getting-started">live actors</a>, <a href="https://ouweiya.github.io/xstate-zh/docs/import-from-github">synced projects</a>, and <a href="https://ouweiya.github.io/xstate-zh/docs/export-as-code">exported code</a>, as found in the <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg> <strong>Code</strong> panel. <a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources">Read more about sources in our recent blog post</a>.</p>
<p>To complement sources, you can also now add <a href="https://ouweiya.github.io/xstate-zh/docs/actions#dynamic-action-parameters">parameters</a> to your actions and input to your actors! When adding or editing an action or actor on the canvas, you can use the button to add <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus"><path d="M5 12h14"></path><path d="M12 5v14"></path></svg> <strong>parameter</strong> or add <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus"><path d="M5 12h14"></path><path d="M12 5v14"></path></svg> <strong>input</strong>. From here, you can add key-value pairs as dynamic input for your source code. Parameters donâ€™t just open the possibility for more reusable actions and actors; in the future, <a href="https://ouweiya.github.io/xstate-zh/docs/simulation-mode">Simulation mode</a> and live actors will be able to use these parameters to execute actions based on different inputs when simulating your machine.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="draft-projects">Draft projects<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-11-changelog#draft-projects" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>When you visit <a href="https://state.new/" target="_blank" rel="noopener noreferrer">state.new</a>, we will now automatically create a new Drafts project for your machine or add your machine to your existing Drafts project. The last machine you created at state.new will also be migrated to your Drafts project the first time you visit state.new. You will now also be directed to sign in when you visit state.new unless youâ€™re already signed in.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-11-changelog#improvements" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li>Weâ€™ve added support in Statelyâ€™s editor for inline guards, inline actors and action parameters. These will now be imported, displayed in your machine, and exported correctly. Imported inline actors, actions, and guards are now given a unique ID. <a href="https://ouweiya.github.io/xstate-zh/docs/sources#unnamed-actions-actors-and-guards">Read the sources docs for more information about naming actions, actors, and guards</a>.</li>
<li>You can now give your workflows custom names when deploying them with Stately Sky.</li>
<li>You can now use Simulate mode in your embedded machines.</li>
<li><a href="https://stately.ai/registry/login" target="_blank" rel="noopener noreferrer">The signup and login page</a> now has a new look.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-11-changelog#bug-fixes" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li>We now always show the lock button in the machine Details panel as active (not disabled) and added a spinner to indicate when the lock status is changing.</li>
<li>We fixed a bug where the editor would not work on reload if you had added a <code>.</code> to a node name.</li>
<li>We fixed an error where creating invoked actors could sometimes crash the editor.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="wed-love-your-feedback">Weâ€™d love your feedback<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-11-changelog#wed-love-your-feedback" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Are you using any of our new or beta features? Weâ€™d love to hear your feedback. You can <a href="https://discord.stately.ai/" target="_blank" rel="noopener noreferrer">chat with us on Discord</a> or <a href="https://github.com/orgs/statelyai/projects/2" target="_blank" rel="noopener noreferrer">leave a feature request on our GitHub feedback board</a>.</p>]]></content>
        <author>
            <name>Laura Kalbag</name>
            <uri>https://github.com/laurakalbag</uri>
        </author>
        <category label="changelog" term="changelog"/>
        <category label="new" term="new"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Bidirectional GitHub Sync is now here!]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync"/>
        <updated>2024-01-09T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Watch our latest office hours live stream where we cover new features including Stately Inspect, GitHub Sync, Sources, and our roadmap for 2024.]]></summary>
        <content type="html"><![CDATA[<p>The team at Stately is proud to release an exciting new feature to kick off 2024, <a href="https://stately.ai/docs/import-from-github" target="_blank" rel="noopener noreferrer">GitHub Sync with Stately Studio</a>! This feature has been highly requested by users and it prompted us to initially launch <a href="https://stately.ai/docs/import-from-github#sync-changes-to-machines-from-github" target="_blank" rel="noopener noreferrer">GitHub Import</a> as a Pro feature over a year ago. But GitHub Sync goes beyond just importing as it enables a completely bidirectional workflow between GitHub repositories and Stately Studio. View the <a href="https://www.youtube.com/watch?v=x-F1TPjz_lI&amp;t=318s" target="_blank" rel="noopener noreferrer">short demo of GitHub Sync</a> from our Office Hours last month.</p>
<!-- -->
<p><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/connect-github-button.png" alt="Connect a project to a GitHub repository by clicking the Connect GitHub button." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/connect-github-button-dm.png" alt="Connect a project to a GitHub repository by clicking the Connect GitHub button." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual-syncing-is-so-2023">Manual syncing is so 2023<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#manual-syncing-is-so-2023" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Adoption of state machines and <a href="https://stately.ai/docs/xstate" target="_blank" rel="noopener noreferrer">XState</a> in the TypeScript/JavaScript community has steadily grown over the years and there are thousands of repositories on GitHub alone that use XState in projects. Stately Studio also continues to gain adoption as its free and premium features make working with state machines and XState even more powerful and intuitive. Until now, users have sought to synchronize work between their repositories and Studio, in either or both directions, but it hasnâ€™t always been easy. This often involved copy/pasting code while <a href="https://stately.ai/docs/import-from-code" target="_blank" rel="noopener noreferrer">importing machines to Studio</a> or <a href="https://stately.ai/docs/export-as-code" target="_blank" rel="noopener noreferrer">exporting machines as code</a>, and reconciling multiple sources of truth. GitHub Sync seeks to eliminate those pain points.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="project-code-enhanced-by-stately-studio">Project code enhanced by Stately Studio<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#project-code-enhanced-by-stately-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Stately Studio is packed with powerful features like its robust editor for visualizing state machines as diagrams, flow simulation, export options, and test generation. The Studio also allows for easily <a href="https://stately.ai/docs/projects" target="_blank" rel="noopener noreferrer">organizing machines into projects</a>, <a href="https://stately.ai/docs/versions" target="_blank" rel="noopener noreferrer">saving versions</a>, and collaborating with other team members. Many XState users have been able to use the diagramming features of our VSCode extension but now GitHub Sync makes it easier to enjoy all of the Studio features while using any code editor and remaining connected to the GitHub repo as a source of truth.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-synced-for-the-entire-team">Code synced for the entire team<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#code-synced-for-the-entire-team" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Depending on the type of software being developed or depending on team size, XState may only be used in a portion of the projectâ€™s code. The projectâ€™s repo may be used by many other team members who arenâ€™t yet using Stately Studioâ€™s features. Changes to the code could be made directly by those contributors to the GitHub repo and they need to be synchronized with the Studio on an ongoing basis. For users on a <a href="https://stately.ai/docs/studio-team-plan" target="_blank" rel="noopener noreferrer">Team plan</a> who already collaborate in the Studio, their machines also need to be synced back to their repos. Git and GitHub already include intuitive tools for merging code and for conflict resolution so the Studio is now able to leverage those to keep everything in sync.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-included-in-the-new-github-sync-release">Whatâ€™s included in the new GitHub Sync release?<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#whats-included-in-the-new-github-sync-release" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<ul>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#a-more-robust-importing-process">A more robust importing process</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#the-editing-power-of-stately-studio">The editing power of Stately Studio</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#staying-in-sync-with-the-github-repo">Staying in sync with the GitHub repo</a></li>
<li><a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#creating-pull-requests-back-to-the-repo">Creating pull requests back to the repo</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-more-robust-importing-process">A more robust importing process<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#a-more-robust-importing-process" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Importing from a GitHub Repo is now easier and more robust. Users can automatically <a href="https://stately.ai/docs/import-from-github#sync-changes-to-machines-from-github" target="_blank" rel="noopener noreferrer">authorize Stately Studio</a> with a single click or they can choose to use a customized GitHub access token with fine grained repository access and permissions. Access allows users to then choose one of their GitHub repositories, including a specific branch, and then select which files and folders to include for import and even <a href="https://stately.ai/docs/import-from-github#sync-changes-to-machines-from-github" target="_blank" rel="noopener noreferrer">specify a path</a> for <a href="https://stately.ai/docs/import-from-github#sync-changes-to-machines-from-github" target="_blank" rel="noopener noreferrer">new machines created in the Studio</a>. The Studio will identify all of the XState machines in the repo files, extract them, and create a connected project. Connected projects work just like other Studio projects but with additional GitHub-related features.</p>
<p><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/github-select-files.png" alt="Importing allows users to choose a repository, a branch, and to select individual files or entire folders to sync with Stately Studio." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/github-select-files-dm.png" alt="Importing allows users to choose a repository, a branch, and to select individual files or entire folders to sync with Stately Studio." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="editing-power-of-stately-studio">Editing power of Stately Studio<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#editing-power-of-stately-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Once a connected project has been created, its machines can be edited just like with other projects and machines. Use the visual editor to add or modify states and transitions. Effects can be added and a machineâ€™s layout can be automatically or manually adjusted. Flows can be created or modified with AI generation. With a <a href="https://stately.ai/docs/studio-pro-plan" target="_blank" rel="noopener noreferrer">Stately Studio Pro plan</a>, <a href="https://stately.ai/docs/versions#save-a-version" target="_blank" rel="noopener noreferrer">machine versions can be saved</a> and machines can even be run via <a href="https://stately.ai/docs/stately-sky-getting-started" target="_blank" rel="noopener noreferrer">Stately Sky</a>.</p>
<p><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/premium-feature-version-history.png" alt="Stately Studio has offers powerful free and premium features for working with your state machines after importing them from a GitHub repository, like using Version History." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/premium-feature-version-history-dm.png" alt="Stately Studio has offers powerful free and premium features for working with your state machines after importing them from a GitHub repository, like using Version History." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<p>The Studio also provides a number of other features like test generation and export options to code, markdown, or to external editors. But this work can all be in coordination with the underlying GitHub repo.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="staying-in-sync-with-the-github-repo">Staying in sync with the GitHub repo<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#staying-in-sync-with-the-github-repo" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>By default, connected projects will <a href="https://stately.ai/docs/import-from-github#sync-changes-to-machines-from-github" target="_blank" rel="noopener noreferrer">automatically be synchronized with the GitHub repo</a> every time the project loads. New files added to selected folders in the repository will appear in the Studio. Weâ€™ll also warn of any deleted files that might cause machines to be deleted in the Studio. Itâ€™s possible to opt out of this and to perform syncs manually but we recommend that this still be done fairly often to prevent potential conflicts.</p>
<p><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/github-auto-sync.png" alt="By default, connected repos are auto-synced with the GitHub repo but this can be disabled if you want to manually sync instead." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/github-auto-sync-dm.png" alt="By default, connected repos are auto-synced with the GitHub repo but this can be disabled if you want to manually sync instead." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<p>A connected project starts out <a href="https://stately.ai/docs/import-from-github#sync-changes-to-machines-from-github" target="_blank" rel="noopener noreferrer">in sync with the branch</a> that was specified during the import process via the projectâ€™s <a href="https://stately.ai/docs/import-from-github#auto-sync" target="_blank" rel="noopener noreferrer">auto-sync setting</a>. However, it is also possible to <a href="https://stately.ai/docs/import-from-github#sync-changes-to-machines-from-github" target="_blank" rel="noopener noreferrer">connect to additional repo branches</a>. Under the hood, these branch connections are considered a different version of the connected project and itâ€™s easy to switch between them, add new branches, or delete branch connections.</p>
<p>At any time, new machines can be added directly to a connected project or existing machines can be moved or forked into a connected project. Those can all be <a href="https://stately.ai/docs/import-from-github#sync-new-machines-created-in-stately-studio" target="_blank" rel="noopener noreferrer">added to the GitHub repo</a> as part of the pull request process.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-pull-requests-back-to-the-repo">Creating pull requests back to the repo<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#creating-pull-requests-back-to-the-repo" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>The key feature required to complete a bidirectional workflow between GitHub and Stately Studio is the ability to <a href="https://stately.ai/docs/import-from-github#create-pull-request" target="_blank" rel="noopener noreferrer">create pull requests</a> back to the original repository and thatâ€™s now easy to do directly from the Studio. Connected projects have a GitHub Settings panel where you can manage the GitHub connection to your project, including creating a pull request which can target any other branch in the repository.</p>
<p><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/github-settings.png" alt="Connected projects have a GitHub Settings panel where users can create new pull requests targeting any branch in the connected repository." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/github-settings-dm.png" alt="Connected projects have a GitHub Settings panel where users can create new pull requests targeting any branch in the connected repository." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<p>Once a pull request is made, the process becomes the same as it is for any other GitHub pull request where it can be reviewed, modified, approved, and merged. Subsequent changes can be added to existing pull requests with the <a href="https://stately.ai/docs/import-from-github#update-pull-request" target="_blank" rel="noopener noreferrer">Update pull request feature</a>. This allows for greater productivity in the Studio while knowing that changes will make their way back into the GitHub repo.</p>
<p><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/github-pull-request.png" alt="Pull requests appear on GitHub just as they normally would and can be reviewed, modified, approved, and merged." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-bidirectional-github-sync/github-pull-request-dm.png" alt="Pull requests appear on GitHub just as they normally would and can be reviewed, modified, approved, and merged." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">Whatâ€™s next?<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-bidirectional-github-sync#whats-next" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>We canâ€™t wait for you to try out GitHub Sync with your Studio machines and repositories. If youâ€™re a Pro user you can get started immediately. <a href="https://stately.ai/docs/studio-community-plan" target="_blank" rel="noopener noreferrer">Community plan</a> users can <a href="https://stately.ai/docs/upgrade" target="_blank" rel="noopener noreferrer">get a free trial</a> for our Pro or Team plans during which time you can import machines into Stately Studio to use GitHub Sync along with all of our other <a href="https://stately.ai/docs/studio-pro-plan" target="_blank" rel="noopener noreferrer">Pro features</a> or <a href="https://stately.ai/docs/studio-team-plan" target="_blank" rel="noopener noreferrer">Team features</a>.</p>
<p>But the fun doesnâ€™t stop there. It will soon be possible to modify file and folder selections after importing from a GitHub repo into a connected project. Another feature we are considering is the ability to convert existing Studio projects into connected projects which would create a new GitHub repository or add new branches to an existing repo. Weâ€™d love to hear how <a href="https://stately.ai/docs/import-from-github" target="_blank" rel="noopener noreferrer">GitHub Sync</a> is working for you and also what <a href="https://github.com/statelyai/feedback/issues/new/choose" target="_blank" rel="noopener noreferrer">other features would be useful for you</a> and your team.</p>]]></content>
        <author>
            <name>Kevin Maes</name>
            <uri>https://github.com/kevinmaes</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="studio" term="studio"/>
        <category label="GitHub" term="GitHub"/>
        <category label="sync" term="sync"/>
        <category label="git" term="git"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Unlock bidirectional editing with sources]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources"/>
        <updated>2024-01-09T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[With sources, you can now provide implementation code for your actions, actors, and guards, making syncing between the editor and your codebase a breeze.]]></summary>
        <content type="html"><![CDATA[<p>Weâ€™re excited to share a feature that unlocks a whole new level of power and flexibility in Statelyâ€™s editor: sources. With sources, you can now provide implementation source code for your actions, actors, and guards, making syncing between the editor and your codebase a breeze.</p>
<!-- -->
<p>One of the most significant benefits of using our Stately editor is using your state machines as a source of truth. Using your state machines as live documentation relies upon bi-directionally syncing between visualizing your state machine and integrating the implementation code in your codebase. Previously, we had workarounds for bi-directional work; you could use the <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">XState VS Code extension</a> or add your implementation code <em>after</em> exporting your machine. You could even keep your machine in a separate file from your implementations to make it easier to replace your machine code with the exported code without overwriting your implementations. But you couldnâ€™t provide implementation code in the editor, and importing your implementations from an existing machine would lose them. But that has all now changed with the introduction of sources!</p>
<p><em>Watch a demo of sources from our office hours at the end of December:</em></p>
<div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>
<p><em>â–¶ï¸ <a href="https://www.youtube.com/watch?v=x-F1TPjz_lI&amp;t=318s" target="_blank" rel="noopener noreferrer">Jump straight to the video chapter on sources</a>.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-sources">What are sources?<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources#what-are-sources" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Using the <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg> <strong>Sources</strong> panel, you can now provide source code for your actions, actors, and guards implementations from inside Statelyâ€™s editor.</p>
<p>You can add custom source code from the <strong>Sources</strong> panel to suit your needs or choose from logic templates. Your source code will be included in your <a href="https://ouweiya.github.io/xstate-zh/docs/stately-sky-getting-started">live actors</a>, <a href="https://ouweiya.github.io/xstate-zh/docs/import-from-github">synced projects</a>, and <a href="https://ouweiya.github.io/xstate-zh/docs/export-as-code">exported code</a>, as found in the <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg> <strong>Code</strong> panel. When an action, actor, or guard is selected, the <strong>Sources</strong> panel shows its source code. When no item is selected on the canvas, the <strong>Sources</strong> panel shows all the sources for your current machine.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="logic-templates">Logic templates<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources#logic-templates" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>You can also choose from logic templates when editing the sources for your actions, actors, or guards. Use the template buttons to quickly add the implementation code for XStateâ€™s <a href="https://ouweiya.github.io/xstate-zh/docs/actors#actor-logic-creators">logic creators</a>, <a href="https://ouweiya.github.io/xstate-zh/docs/guards#higher-level-guards">higher-level guards</a>, and <a href="https://ouweiya.github.io/xstate-zh/docs/actions">built-in actions</a>, and the correct XState imports will be added to your code for sync or export.</p>
<p><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-sources/sources.png" alt="The sources panel open for a pizzaRecieced entry action. In the source code, the sendTo action is being used to send an event of pizzaRecieved to the reviewApp actor." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-sources/sources-dm.png" alt="The sources panel open for a pizzaRecieced entry action. In the source code, the sendTo action is being used to send an event of pizzaRecieved to the reviewApp actor." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<p>And yes, this means that we can now import your existing source code from your state machines, visualize them on the canvas, show them as sources in the studio, and keep your original code intact when exporting or syncing back to your codebase. <strong>In short, if youâ€™re going back and forth between your codebase and Statelyâ€™s editor, you donâ€™t have to worry about the implementation code getting lost or overwritten</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="xstate-built-in-actions">XState built-in actions<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources#xstate-built-in-actions" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Previously, when you added an action to your machine in the editor, youâ€™d have the option to make it a custom action or choose from one of XStateâ€™s built-in actions, including <a href="https://ouweiya.github.io/xstate-zh/docs/actions#assign-action"><code>assign()</code></a>, <a href="https://ouweiya.github.io/xstate-zh/docs/actions#raise-action"><code>raise()</code></a>, and <a href="https://ouweiya.github.io/xstate-zh/docs/actions#send-to-action"><code>sendTo()</code></a>. Those built-in actions are now shown as fully editable <a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources#logic-templates">logic templates</a> in the sources panel, and built-in actions are still shown with their action type on the canvas.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="actions-actors-and-guards-are-now-named">Actions, actors, and guards are now named<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources#actions-actors-and-guards-are-now-named" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Previously, not all actions, actors, and guards had names, especially if you had imported <a href="https://ouweiya.github.io/xstate-zh/docs/actions#inline-actions">inline actions</a> or <a href="https://ouweiya.github.io/xstate-zh/docs/guards#inline-guards">inline guards</a> from your XState machines. Now, when creating new actions, actors, or guards on the canvas, youâ€™ll be prompted to give them a name, which is an important addition when importing source code from existing XState machines.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="importing-sources-from-existing-xstate-machines">Importing sources from existing XState machines<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources#importing-sources-from-existing-xstate-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>When importing a machine from your codebase, weâ€™ll give your unnamed actions, actors, and guards a default name based on their position in your machine config. For example, the following action:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function" style="color:hsl(221, 87%, 60%)">createMachine</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">states</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">a</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">states</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">b</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">entry</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token function" style="color:hsl(221, 87%, 60%)">assign</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:hsl(5, 74%, 59%)">name</span><span class="token operator" style="color:hsl(221, 87%, 60%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(119, 34%, 47%)">'laura'</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">  </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">}</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Would be given a default name of <code>inline:(machine).a.b#entry[0]</code>. These default names are not visible in the editor but will be used in the synced or exported code unless you give your action, actor, or guard a name. <code>inline:</code> is prepended to the name to make them more readable and easier to find in your code. After first importing your machine, we recommend you give all your actions, actors, and guards a name. Naming is a one-time step, and you can always rename them later. Giving your sources distinct names also means that multiple actors, actions, or guards can reference them, which can be really useful when combined with parameters.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="action-parameters">Action parameters<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources#action-parameters" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>You can now add <a href="https://ouweiya.github.io/xstate-zh/docs/actions#dynamic-action-parameters">parameters</a> to your actions! When adding or editing an action on the canvas, you can use the button to Add <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus"><path d="M5 12h14"></path><path d="M12 5v14"></path></svg> <strong>parameter</strong>. From here, you can add key-value pairs as parameters for dynamic input that can be used in your source code. Parameters donâ€™t just open the possibility for more reusable actions; in the future, <a href="https://ouweiya.github.io/xstate-zh/docs/simulation-mode">Simulation mode</a> and live actors will be able to use these parameters to execute actions based on different inputs when simulating your machine.</p>
<p><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-sources/action-params.png" alt="The confirm_order event with a setOrderStatus transition action thatâ€™s open showing the options to add parameters, with a parameter added using the key of status and the value of confirmed." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-09-introducing-sources/action-params-dm.png" alt="The confirm_order event with a setOrderStatus transition action thatâ€™s open showing the options to add parameters, with a parameter added using the key of status and the value of confirmed." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<p>Actor inputs are also coming soonâ€¦&nbsp;enabling you to provide dynamic input to the actor when it executes. Actor inputs will be a game-changing combination with sources for deployed workflows in Stately Sky!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bi-directional-editing-with-sources-and-github-sync">Bi-directional editing with sources and GitHub sync<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources#bi-directional-editing-with-sources-and-github-sync" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>If you havenâ€™t checked it out yet, <a href="https://www.youtube.com/live/x-F1TPjz_lI?feature=shared&amp;t=602" target="_blank" rel="noopener noreferrer">watch Kevinâ€™s demo of GitHub Sync</a>, which weâ€™re also releasing this week. <a href="https://ouweiya.github.io/xstate-zh/docs/import-from-github">GitHub Sync</a> and sources are a powerful combination. With GitHub Sync, you donâ€™t even need to use the export button to sync your machine with your codebase. And sources ensure that your code stays intact when syncing bi-directionally between your codebase and the editor.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sources-make-stately-sky-more-powerful">Sources make Stately Sky more powerful<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources#sources-make-stately-sky-more-powerful" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Sources also bring huge benefits to <a href="https://ouweiya.github.io/xstate-zh/docs/stately-sky-getting-started">Stately Sky</a>, as your live actors can now execute the source code from your actions, actors, and guards in the cloud.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-future">The future<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-09-introducing-sources#the-future" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>Weâ€™re excited about sources because of all the features they enable in Stately Studio and your overall developer experience, helping Stately Studio become the visual collaborative source of truth for your app logic and workflows.</p>
<p>Using sources is free on all our plans, and you can <a href="https://stately.ai/pricing" target="_blank" rel="noopener noreferrer">try our premium features, including GitHub Sync and Stately Sky, for free</a> on a <a href="https://ouweiya.github.io/xstate-zh/docs/studio-pro-plan">Pro plan</a> or with your team on a <a href="https://ouweiya.github.io/xstate-zh/docs/studio-team-plan">Team plan</a>. You can <a href="https://ouweiya.github.io/xstate-zh/docs/sources">read more about sources in our docs</a>, and please share your feedback with us on our <a href="https://discord.stately.ai/" target="_blank" rel="noopener noreferrer">social platforms</a> or in our regular <a href="https://www.youtube.com/watch?v=-Jf9N-EaUx0&amp;list=PLvWgkXBB3dd6PXbSoctwDXjWX-AQrxhds" target="_blank" rel="noopener noreferrer">office hours live streams</a>. If you want help getting started with sources or getting your team set up with Stately and XState, <a href="https://stately.ai/pricing#services" target="_blank" rel="noopener noreferrer">the Stately team is available for workshops and consulting</a>, and you can <a href="https://calendly.com/d/yc8-3hq-rpc/request-a-demo" target="_blank" rel="noopener noreferrer">book a demo call</a> with us to learn more about how Stately can work for your team.</p>]]></content>
        <author>
            <name>Farzad Yousefzadeh</name>
            <uri>https://github.com/farskid</uri>
        </author>
        <author>
            <name>Laura Kalbag</name>
            <uri>https://github.com/laurakalbag</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="editor" term="editor"/>
        <category label="xstate" term="xstate"/>
        <category label="state machines" term="state machines"/>
        <category label="sources" term="sources"/>
        <category label="actions" term="actions"/>
        <category label="actors" term="actors"/>
        <category label="guards" term="guards"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[A look back at Stately in 2023]]></title>
        <id>https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023</id>
        <link href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023"/>
        <updated>2024-01-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[As we start 2024, we wanted to look back at what the Stately team accomplished in 2023 and take a sneak peek at what you can expect from Stately in 2024.]]></summary>
        <content type="html"><![CDATA[<p>As we start 2024, we wanted to look back at what the Stately team accomplished in 2023 and take a sneak peek at what you can expect from Stately in 2024.</p>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2023-highlights">2023 highlights<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#2023-highlights" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>2023 was a huge year for Stately. Among the many features we released to Stately Studio, we checked <strong>42 requested features</strong> (big and small) off our <a href="https://github.com/orgs/statelyai/projects/2" target="_blank" rel="noopener noreferrer">feature requests to-do list</a>, and we cut <strong>229 releases</strong> (thatâ€™s a release every 1.6 days!) We also did <strong>39 <a href="https://www.youtube.com/@Statelyai/streams" target="_blank" rel="noopener noreferrer">live streams</a></strong>, shared <strong>54 <a href="https://ouweiya.github.io/xstate-zh/blog">blog posts</a></strong>, and released the massive <a href="https://stately.ai/blog/2023-12-01-xstate-v5" target="_blank" rel="noopener noreferrer">XState V5</a>.</p>
<p>Some of our favorite features include:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-to-the-cloud-with-stately-sky">Deploying to the cloud with Stately Sky<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#deploying-to-the-cloud-with-stately-sky" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Our <a href="https://ouweiya.github.io/xstate-zh/blog/2023-11-13-introducing-stately-sky">launch of Stately Sky last year</a> brought executable machines to the Studio. With Stately Sky, you can run your machines in the cloud, automate onboarding flows with state machines, execute and monitor backend workflows, persist frontend state between refreshes, and create and manage multi-user sessions.</p>
<p>Check out our docs for <a href="https://ouweiya.github.io/xstate-zh/docs/stately-sky-getting-started">a comprehensive guide to starting with Stately Sky</a>, and <a href="https://www.youtube.com/watch?v=FamZ0grhyK8" target="_blank" rel="noopener noreferrer">watch my talk from NodeConf EU</a>, where I demoed using Stately Sky for a collaborative soundscape.</p>
<div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stately-ai">Stately AI<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#stately-ai" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>One of our biggest highlights of 2023 was the introduction of AI-assisted features to Stately Studio, which we nicknamed <strong>Stately AI</strong>. With Stately AI, you can generate complex state machines from simple text descriptions.</p>
<p>For example, I generated the following machine with the text prompt â€œ<em>A booking system for pet grooming. Pet owners can book, reschedule, and cancel appointments. When appointments have been made, pet owners get a notification, as well as a reminder of their appointment 24 hours before the appointment time.</em>â€:</p>
<iframe loading="lazy" src="https://stately.ai/registry/editor/embed/092bf401-2d65-48ae-969c-99b4a7eeb87f?machineId=f6aea607-9319-462c-a241-0736a1d2b001&amp;colorMode=light" class="embed_rxbU"><a href="https://stately.ai/registry/editor/embed/092bf401-2d65-48ae-969c-99b4a7eeb87f?machineId=f6aea607-9319-462c-a241-0736a1d2b001">View the <em></em> machine in Stately Studio</a>.</iframe>
<p>You can also use Stately AI to <a href="https://ouweiya.github.io/xstate-zh/blog/2023-11-20-stately-studio-2-0#generate-summary">generate a summary</a> of your machine, which is really useful for documentation. I used this feature to generate the following summary of the machine above:</p>
<blockquote>
<p>This state machine represents a pet grooming booking system. It helps pet owners book, reschedule, and cancel appointments for their pets. The system has different states that represent different stages of the booking process. The initial state is "Idle", which means the system is waiting for a pet owner to start the booking process. When a pet owner wants to book an appointment, they trigger the "book" event. This transitions the system to the "Appointment Booked" state, indicating that an appointment has been successfully booked. From the "Appointment Booked" state, the pet owner can choose to reschedule or cancel the appointment. If they choose to reschedule, the system transitions to the "Appointment Rescheduled" state, indicating that the appointment has been rescheduled to a new time. If they choose to cancel, the system transitions to the "Appointment Canceled" state, indicating that the appointment has been canceled. Additionally, the system can send a reminder to the pet owner 24 hours before the appointment from the "Appointment Booked" or "Appointment Rescheduled" states. This transitions the system to the "Reminder Sent" state. From the "Reminder Sent" state, if the pet owner wants to book a new appointment, they can trigger the "book" event, which transitions the system back to the "Appointment Booked" state. Each state has associated actions that are performed when transitioning to that state. These actions include notifying the pet owner about the booking, rescheduling, cancellation, or sending a reminder. Overall, this state machine helps manage the pet grooming booking process, ensuring that appointments are booked, rescheduled, or canceled smoothly, and reminders are sent to pet owners.</p>
</blockquote>
<p>But that isnâ€™t all!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="generating-react-prototypes-based-on-your-machines">Generating React prototypes based on your machines<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#generating-react-prototypes-based-on-your-machines" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>We also released the ability to <a href="https://ouweiya.github.io/xstate-zh/docs/generate-react">generate React app code</a> based on your machines, which is a great way to prototype your app logic quickly. Stately AI adds more magic to your React prototypes with the option to <strong>Enhance app</strong> once generated, which builds out a UI for your app and enables you to go from a text description to a working prototype in less than a minute.</p>
<p><img src="https://ouweiya.github.io/blog/2024-01-08-a-look-back-at-2023/generate-react-app.png" alt="Enhancing an app in Statelyâ€™s editor, showing a pet grooming appointment app in the appointment booked state, with colored buttons generated for reschedule, cancel, and send reminder." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2024-01-08-a-look-back-at-2023/generate-react-app-dm.png" alt="Enhancing an app in Statelyâ€™s editor, showing a pet grooming appointment app in the appointment booked state, with colored buttons generated for reschedule, cancel, and send reminder." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="import-any-app-logic">Import any app logic<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#import-any-app-logic" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>We want to make it easy to visualize app logic from any code as a state machine. So weâ€™ve started with Zustand, Redux, and Redux Toolkit. You can now import your logic from any of these libraries into Stately Studio, and weâ€™ll visualize it as a state machine. Import your existing app logic to generate up-to-date diagrams and customizable documentation for your logic, easily detect logical errors, and quickly generate test cases.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-assets-to-states">Adding assets to states<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#adding-assets-to-states" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Stately Studio has been able to add images to state and event descriptions for a while now, but you had to upload the images somewhere in the cloud and then add the image using markdown. Now, you can <a href="https://ouweiya.github.io/xstate-zh/docs/assets">drag an image on to a state</a>, and itâ€™s automatically uploaded and added to your machine. And youâ€™re not just limited to images; you can drag any file onto your state, and it will be displayed as a linked asset. Assets are a game-changer for improving documentation and easily linking to other resources.</p>
<p><img src="https://ouweiya.github.io/blog/2023-11-20-stately-studio-2-0/drag-assets.png" alt="State machine for a color picker where an image of an expanded color picker is being dragged into the open state." class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://ouweiya.github.io/blog/2023-11-20-stately-studio-2-0/drag-assets-dm.png" alt="State machine for a color picker where an image of an expanded color picker is being dragged into the open state." class="themedComponent_mlkZ themedComponent--dark_xIcU"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stately-inspector">Stately inspector<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#stately-inspector" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Since Stately Studio succeeded the old Stately viz, weâ€™ve been working to bring some of our favorite features from the viz into the editor. One of the last things we released in 2023 was a new package for <a href="https://github.com/statelyai/inspect" target="_blank" rel="noopener noreferrer">@statelyai/inspect</a>, which builds upon the old XState inspector, enabling developers to visually inspect state transitions <em>and</em> actor communication in any JavaScript/TypeScript app. You can visualize your state machines and generate sequence diagrams for how your actors communicate. You can use Stately Inspect with or without XState, with any framework or library, or none at all. <a href="https://www.youtube.com/watch?v=x-F1TPjz_lI&amp;t=103s" target="_blank" rel="noopener noreferrer">Watch our last office hours from 2023 for Davidâ€™s demo of the Stately inspector</a>.</p>
<div style="margin:20px 0"><div data-testid="general-observer" class="mdx-embed"><div style="height:0;width:100%"></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-enhanced-editor-experience-of-stately-studio-20">The enhanced editor experience of Stately Studio 2.0<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#the-enhanced-editor-experience-of-stately-studio-20" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>If you havenâ€™t tried the Studio in the last few months, youâ€™ll notice a considerable difference in the editor experience. Weâ€™ve reorganized the panels, header, and footer, so youâ€™ll get more information about your machine visible to you when you want it. Weâ€™ve also made it easier for you to quickly create and edit your flows with quick actions and fewer clicks required to get to the actions you use most. There are also new options for you when you create a new machine to start with a blank canvas or starter template, import your existing app logic (not just from XState!), or generate a machine from a text description using AI.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="improved-autolayout">Improved autolayout<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#improved-autolayout" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Another massive change youâ€™ll notice in the editor is that autolayout is better than ever. Weâ€™ve improved the algorithm so imported machines are laid out more logically in a way thatâ€™s much easier to read, and transition lines now try to re-route around states and events as you move them to keep your machine tidy and readable.</p>
<p><img loading="lazy" alt="Using autolayout to turn a spaghetti state machine with many overlapping transition lines, to a clearer state machine where each state is separated and itâ€™s easy to follow the transition lines." src="https://ouweiya.github.io/xstate-zh/assets/images/autolayout-optimised-f08706863d11ec91a2383ead14fd5144.gif" width="1160" height="720" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="xstate-version-5">XState version 5<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#xstate-version-5" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>And, of course, after five years of hard work, we also <a href="https://ouweiya.github.io/xstate-zh/blog/2023-12-01-xstate-v5">released XState version 5</a>. You can already import and export XState V5 machines in Stately Studio, and weâ€™re working on full support and more advanced features for the Studio to improve the developer experience even more in 2024, so you can visualize your app logic, whether itâ€™s written in XState or not.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2024-roadmap">2024 roadmap<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#2024-roadmap" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>The Stately team has hit the ground running in 2024. Weâ€™re not even one week into 2024 yet, and weâ€™ve already released GitHub Sync and sources for actions, actors, and guards. Stay tuned for blog posts about those features.</p>
<p>Weâ€™ve got big plans for the next year; hereâ€™s a sneak peek at what you can expect from Stately in 2024:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="update-to-xstate-vs-code-extension">Update to XState VS Code extension<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#update-to-xstate-vs-code-extension" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Our focus for the beginning of 2024 is improving the features already in Stately and XState, which means our first priority for 2024 is bringing the <a href="https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode" target="_blank" rel="noopener noreferrer">XState VS Code extension</a> up to date with Stately Studio. Weâ€™ll add full support for XState V5 and work towards extensions for other IDEs.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="improved-xstate-v5-support-in-the-studio">Improved XState V5 support in the Studio<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#improved-xstate-v5-support-in-the-studio" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Stately Studio already supports XState V5 machines, allowing you to import your XState V5 machines into the Studio and export machines as XState V5. But weâ€™re working on even greater support for XState V5 in the Studio. Look out for a blog post on sources for actions, actors, and guards later this week. And this is just the beginning of what we have planned.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sequence-diagram">Sequence diagram<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#sequence-diagram" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>One of the features that always gets folks excited in <a href="https://www.youtube.com/playlist?list=PLvWgkXBB3dd6PXbSoctwDXjWX-AQrxhds" target="_blank" rel="noopener noreferrer">our office hours live streams</a> are sequence diagrams for your app logic. <a href="https://www.youtube.com/live/x-F1TPjz_lI?si=w1PcBQQWQPe-20WT&amp;t=318" target="_blank" rel="noopener noreferrer">Check out an early version of the sequence diagram</a> as part of Stately Inspect. You can look forward to sequence diagrams like this in Stately Studio very soon!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="visualizing-actor-hierarchy">Visualizing actor hierarchy<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#visualizing-actor-hierarchy" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>With <a href="https://stately.ai/blog/2023-12-01-xstate-v5#everything-is-an-actor" target="_blank" rel="noopener noreferrer">XStateâ€™s greater focus on the actor model</a>, weâ€™ll continue to make it easier for you to visualize your app logic in Stately Studio, enabling you to visualize the hierarchy of your actors and how they communicate with each other.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="export-to-png-and-svg">Export to PNG and SVG<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#export-to-png-and-svg" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Weâ€™ve had a basic export to PNG feature in Stately Studio for a while now, but weâ€™re working on a more advanced export feature, making it even easier for you to share your state machines with your team. Weâ€™ll improve the export to PNG feature and add the ability to export to SVG. Your documentation will never look better!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="import-from-mermaid-diagrams">Import from Mermaid diagrams<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#import-from-mermaid-diagrams" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h3>
<p>Last year, we introduced the option to <a href="https://stately.ai/blog/2023-07-20-export-to-mermaid" target="_blank" rel="noopener noreferrer">export to Mermaid</a>. In 2024, we want to add the option to import from Mermaid and even more of your favorite formats. We want to make it easy for you to visualize your app logic in Stately Studio.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-do-you-want-from-stately-in-2024">What do you want from Stately in 2024?<a href="https://ouweiya.github.io/xstate-zh/blog/2024-01-08-a-look-back-at-stately-in-2023#what-do-you-want-from-stately-in-2024" class="hash-link" aria-label="Direct link to heading" title="Direct link to heading">â€‹</a></h2>
<p>In 2024, our ultimate goal is for Stately to be the best visual collaborative source of truth for your app logic and workflows. Have you got a feature request? <a href="https://feedback.stately.ai/" target="_blank" rel="noopener noreferrer">Share your feature request on our new feature request board</a>. Do you want to share how your team is using Stately and XState? <a href="https://discord.stately.ai/" target="_blank" rel="noopener noreferrer">Join our Discord</a>. Do you want a custom tour of Stately Studio for your team? <a href="https://calendly.com/d/yc8-3hq-rpc/request-a-demo" target="_blank" rel="noopener noreferrer">Book a demo with the Stately team</a>.</p>]]></content>
        <author>
            <name>Laura Kalbag</name>
            <uri>https://github.com/laurakalbag</uri>
        </author>
        <category label="stately" term="stately"/>
        <category label="studio" term="studio"/>
        <category label="xstate" term="xstate"/>
        <category label="highlights" term="highlights"/>
        <category label="roadmap" term="roadmap"/>
    </entry>
</feed>