"use strict";(self.webpackChunkstately_docs=self.webpackChunkstately_docs||[]).push([[4198],{34143:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>i,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var r=t(85893),c=t(11151);const s={title:"Actors"},o=void 0,a={id:"actors",title:"Actors",description:"\u5f53\u4f60\u8fd0\u884c\u4e00\u4e2a\u72b6\u6001\u673a\u65f6\uff0c\u5b83\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a actor\uff1a\u4e00\u4e2a\u53ef\u4ee5\u63a5\u6536\u4e8b\u4ef6\u3001\u53d1\u9001\u4e8b\u4ef6\u5e76\u6839\u636e\u63a5\u6536\u5230\u7684\u4e8b\u4ef6\u6539\u53d8\u5176\u884c\u4e3a\u7684\u8fd0\u884c\u8fc7\u7a0b\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4 actor \u4e4b\u5916\u7684\u6548\u679c\u3002",source:"@site/docs/actors.mdx",sourceDirName:".",slug:"/actors",permalink:"/xstate-zh/docs/actors",draft:!1,unlisted:!1,editUrl:"https://github.com/statelyai/docs/tree/main/docs/actors.mdx",tags:[],version:"current",frontMatter:{title:"Actors"},sidebar:"tutorialSidebar",previous:{title:"Actors",permalink:"/xstate-zh/docs/category/actors"},next:{title:"\u72b6\u6001\u673a\u6f14\u5458",permalink:"/xstate-zh/docs/state-machine-actors"}},i={},l=[{value:"Actor \u6a21\u578b",id:"actor-\u6a21\u578b",level:2},{value:"Actor \u903b\u8f91",id:"actor-\u903b\u8f91",level:2},{value:"\u521b\u5efa actors",id:"\u521b\u5efa-actors",level:2},{value:"\u8c03\u7528\u548c\u751f\u6210 actors",id:"\u8c03\u7528\u548c\u751f\u6210-actors",level:3},{value:"Actor \u5feb\u7167",id:"actor-\u5feb\u7167",level:2},{value:"\u8ba2\u9605",id:"\u8ba2\u9605",level:2},{value:"<code>waitFor</code>",id:"waitfor",level:2},{value:"\u9519\u8bef\u5904\u7406",id:"\u9519\u8bef\u5904\u7406",level:2},{value:"Actor \u903b\u8f91\u521b\u5efa\u5668",id:"actor-\u903b\u8f91\u521b\u5efa\u5668",level:2},{value:"Actor \u903b\u8f91\u529f\u80fd",id:"actor-\u903b\u8f91\u529f\u80fd",level:3},{value:"\u72b6\u6001\u673a\u903b\u8f91 (<code>createMachine(...)</code>)",id:"createmachine",level:3},{value:"Promise \u903b\u8f91 (<code>fromPromise(...)</code>)",id:"frompromise",level:3},{value:"\u8f6c\u6362\u51fd\u6570\u903b\u8f91 (<code>fromTransition(...)</code>)",id:"fromtransition",level:3},{value:"Observable \u903b\u8f91 (<code>fromObservable(...)</code>)",id:"fromobservable",level:3},{value:"\u4e8b\u4ef6 Observable \u903b\u8f91 (<code>fromEventObservable(...)</code>)",id:"fromeventobservable",level:3},{value:"\u56de\u8c03\u903b\u8f91 (<code>fromCallback(...)</code>)",id:"fromcallback",level:3},{value:"\u4f5c\u4e3a Promise \u7684 actors",id:"\u4f5c\u4e3a-promise-\u7684-actors",level:2},{value:"\u9ad8\u7ea7 actor \u903b\u8f91",id:"\u9ad8\u7ea7-actor-\u903b\u8f91",level:2},{value:"\u81ea\u5b9a\u4e49 actor \u903b\u8f91",id:"\u81ea\u5b9a\u4e49-actor-\u903b\u8f91",level:2},{value:"\u7a7a actor",id:"\u7a7a-actor",level:2},{value:"Actors \u548c TypeScript",id:"actors-\u548c-typescript",level:2},{value:"\u6d4b\u8bd5",id:"\u6d4b\u8bd5",level:2},{value:"Actors \u901f\u67e5\u8868",id:"actors-\u901f\u67e5\u8868",level:2},{value:"\u901f\u67e5\u8868\uff1a\u521b\u5efa\u4e00\u4e2a actor",id:"\u901f\u67e5\u8868\u521b\u5efa\u4e00\u4e2a-actor",level:3},{value:"\u901f\u67e5\u8868\uff1a\u72b6\u6001\u673a\u903b\u8f91",id:"\u901f\u67e5\u8868\u72b6\u6001\u673a\u903b\u8f91",level:3},{value:"\u901f\u67e5\u8868\uff1aPromise \u903b\u8f91",id:"\u901f\u67e5\u8868promise-\u903b\u8f91",level:3},{value:"\u901f\u67e5\u8868\uff1a\u8f6c\u6362\u51fd\u6570\u903b\u8f91",id:"\u901f\u67e5\u8868\u8f6c\u6362\u51fd\u6570\u903b\u8f91",level:3},{value:"\u901f\u67e5\u8868\uff1aObservable \u903b\u8f91",id:"\u901f\u67e5\u8868observable-\u903b\u8f91",level:3},{value:"\u901f\u67e5\u8868\uff1a\u4e8b\u4ef6 Observable \u903b\u8f91",id:"\u901f\u67e5\u8868\u4e8b\u4ef6-observable-\u903b\u8f91",level:3},{value:"\u901f\u67e5\u8868\uff1a\u56de\u8c03\u903b\u8f91",id:"\u901f\u67e5\u8868\u56de\u8c03\u903b\u8f91",level:3}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.a)(),...n.components},{YouTube:t}=e;return t||function(n,e){throw new Error("Expected "+(e?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("YouTube",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.p,{children:"\u5f53\u4f60\u8fd0\u884c\u4e00\u4e2a\u72b6\u6001\u673a\u65f6\uff0c\u5b83\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a actor\uff1a\u4e00\u4e2a\u53ef\u4ee5\u63a5\u6536\u4e8b\u4ef6\u3001\u53d1\u9001\u4e8b\u4ef6\u5e76\u6839\u636e\u63a5\u6536\u5230\u7684\u4e8b\u4ef6\u6539\u53d8\u5176\u884c\u4e3a\u7684\u8fd0\u884c\u8fc7\u7a0b\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4 actor \u4e4b\u5916\u7684\u6548\u679c\u3002"}),"\n",(0,r.jsxs)(e.p,{children:["\u5728\u72b6\u6001\u673a\u4e2d\uff0cactors \u53ef\u4ee5\u88ab ",(0,r.jsx)(e.strong,{children:"\u8c03\u7528"})," \u6216 ",(0,r.jsx)(e.strong,{children:"\u751f\u6210"}),"\u3002\u5b83\u4eec\u672c\u8d28\u4e0a\u662f\u76f8\u540c\u7684\uff0c\u552f\u4e00\u7684\u533a\u522b\u5728\u4e8e actor \u7684\u751f\u547d\u5468\u671f\u5982\u4f55\u63a7\u5236\u3002"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u4e00\u4e2a ",(0,r.jsx)(e.strong,{children:"\u8c03\u7528\u7684 actor"})," \u5728\u5176\u7236\u72b6\u6001\u673a\u8fdb\u5165\u5176\u8c03\u7528\u7684 ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/states",children:"\u72b6\u6001"})," \u65f6\u542f\u52a8\uff0c\u5e76\u5728\u8be5\u72b6\u6001\u9000\u51fa\u65f6\u505c\u6b62\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:["\u4e00\u4e2a ",(0,r.jsx)(e.strong,{children:"\u751f\u6210\u7684 actor"})," \u5728 ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/transitions",children:"\u8f6c\u6362"})," \u4e2d\u542f\u52a8\uff0c\u5e76\u5728\u4f7f\u7528 ",(0,r.jsxs)(e.a,{href:"/docs/actions/#stop-action",children:[(0,r.jsx)(e.code,{children:"stop(...)"})," \u52a8\u4f5c"]})," \u6216\u5176\u7236\u72b6\u6001\u673a\u505c\u6b62\u65f6\u505c\u6b62\u3002"]}),"\n"]}),"\n",(0,r.jsx)(e.admonition,{type:"studio",children:(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u5728\u6211\u4eec\u7684\u62d6\u653e\u5f0f Stately \u7f16\u8f91\u5668\u4e2d\u53ef\u89c6\u5316\u4f60\u7684\u72b6\u6001\u673a\u5e76\u8f7b\u677e\u8c03\u7528 actors\u3002",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/editor-actions-and-actors",children:"\u9605\u8bfb\u66f4\u591a\u5173\u4e8e\u5728 Stately \u7f16\u8f91\u5668\u4e2d\u8c03\u7528 actors \u7684\u4fe1\u606f"}),"\u3002"]})}),"\n",(0,r.jsx)(e.admonition,{type:"video",children:(0,r.jsxs)(e.p,{children:["\u89c2\u770b\u6211\u4eec\u5728 YouTube \u4e0a\u7684 ",(0,r.jsx)(e.a,{href:"https://www.youtube.com/watch?v=Rj7lOvDwcYs",children:"\u201cXState: \u63a2\u7d22 actors\u201d \u6df1\u5165\u89c6\u9891"}),"\u3002"]})}),"\n",(0,r.jsx)(t,{id:"Rj7lOvDwcYs"}),"\n",(0,r.jsx)(e.h2,{id:"actor-\u6a21\u578b",children:"Actor \u6a21\u578b"}),"\n",(0,r.jsx)(e.p,{children:"\u5728 Actor \u6a21\u578b\u4e2d\uff0cactors \u662f\u53ef\u4ee5\u76f8\u4e92\u901a\u4fe1\u7684\u5bf9\u8c61\u3002\u5b83\u4eec\u662f\u901a\u8fc7\u5f02\u6b65\u6d88\u606f\u4f20\u9012\u8fdb\u884c\u901a\u4fe1\u7684\u72ec\u7acb\u201c\u6d3b\u201d\u5b9e\u4f53\u3002\u5728 XState \u4e2d\uff0c\u8fd9\u4e9b\u6d88\u606f\u88ab\u79f0\u4e3a_\u4e8b\u4ef6_\u3002"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Actor \u5177\u6709\u81ea\u5df1\u7684\u5185\u90e8\u5c01\u88c5\u72b6\u6001\uff0c\u53ea\u80fd\u7531 actor \u81ea\u5df1\u66f4\u65b0\u3002actor \u53ef\u4ee5\u9009\u62e9\u5728\u63a5\u6536\u5230\u6d88\u606f\u65f6\u66f4\u65b0\u5176\u5185\u90e8\u72b6\u6001\uff0c\u4f46\u4e0d\u80fd\u88ab\u4efb\u4f55\u5176\u4ed6\u5b9e\u4f53\u66f4\u65b0\u3002"}),"\n",(0,r.jsx)(e.li,{children:"Actors \u901a\u8fc7\u5f02\u6b65\u53d1\u9001\u548c\u63a5\u6536\u4e8b\u4ef6\u4e0e\u5176\u4ed6 actors \u901a\u4fe1\u3002"}),"\n",(0,r.jsx)(e.li,{children:"Actors \u4e00\u6b21\u5904\u7406\u4e00\u6761\u6d88\u606f\u3002\u5b83\u4eec\u6709\u4e00\u4e2a\u5185\u90e8\u201c\u90ae\u7bb1\u201d\uff0c\u5145\u5f53\u4e8b\u4ef6\u961f\u5217\uff0c\u6309\u987a\u5e8f\u5904\u7406\u4e8b\u4ef6\u3002"}),"\n",(0,r.jsxs)(e.li,{children:["\u5185\u90e8 actor \u72b6\u6001\u4e0d\u5728 actors \u4e4b\u95f4\u5171\u4eab\u3002actor \u5171\u4eab\u5176\u5185\u90e8\u72b6\u6001\u7684\u552f\u4e00\u65b9\u5f0f\u662f\uff1a","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5411\u5176\u4ed6 actors \u53d1\u9001\u4e8b\u4ef6"}),"\n",(0,r.jsx)(e.li,{children:"\u6216\u8005\u53d1\u51fa\u5feb\u7167\uff0c\u8fd9\u53ef\u4ee5\u88ab\u89c6\u4e3a\u53d1\u9001\u7ed9\u8ba2\u9605\u8005\u7684\u9690\u5f0f\u4e8b\u4ef6\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"Actors \u53ef\u4ee5\u521b\u5efa\uff08\u751f\u6210/\u8c03\u7528\uff09\u65b0\u7684 actors\u3002"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"/xstate-zh/docs/actor-model",children:"\u9605\u8bfb\u66f4\u591a\u5173\u4e8e Actor \u6a21\u578b\u7684\u4fe1\u606f"})}),"\n",(0,r.jsx)(e.h2,{id:"actor-\u903b\u8f91",children:"Actor \u903b\u8f91"}),"\n",(0,r.jsxs)(e.p,{children:["Actor \u903b\u8f91\u662f actor \u7684\u903b\u8f91\u201c\u6a21\u578b\u201d\uff08\u5927\u8111\u3001\u84dd\u56fe\u3001DNA \u7b49\uff09\u3002\u5b83\u63cf\u8ff0\u4e86 actor \u5728\u63a5\u6536\u5230\u4e8b\u4ef6\u65f6\u5e94\u5982\u4f55\u6539\u53d8\u884c\u4e3a\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.a,{href:"#actor-logic-creators",children:"actor \u903b\u8f91\u521b\u5efa\u5668"})})," \u521b\u5efa actor \u903b\u8f91\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5728 XState \u4e2d\uff0cactor \u903b\u8f91\u7531\u5b9e\u73b0 ",(0,r.jsx)(e.code,{children:"ActorLogic"})," \u63a5\u53e3\u7684\u5bf9\u8c61\u5b9a\u4e49\uff0c\u5305\u542b ",(0,r.jsx)(e.code,{children:".transition(...)"}),"\u3001",(0,r.jsx)(e.code,{children:".getInitialSnapshot()"}),"\u3001",(0,r.jsx)(e.code,{children:".getPersistedSnapshot()"})," \u7b49\u65b9\u6cd5\u3002\u8fd9\u4e2a\u5bf9\u8c61\u544a\u8bc9\u89e3\u91ca\u5668\u5728 actor \u63a5\u6536\u5230\u4e8b\u4ef6\u65f6\u5982\u4f55\u66f4\u65b0\u5176\u5185\u90e8\u72b6\u6001\u4ee5\u53ca\u8981\u6267\u884c\u54ea\u4e9b\u6548\u679c\uff08\u5982\u679c\u6709\uff09\u3002"]}),"\n",(0,r.jsx)(e.h2,{id:"\u521b\u5efa-actors",children:"\u521b\u5efa actors"}),"\n",(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"createActor(actorLogic, options?)"})," \u521b\u5efa\u4e00\u4e2a actor\uff0c\u5b83\u662f\u67d0\u4e9b actor \u903b\u8f91\u7684\u201c\u6d3b\u201d\u5b9e\u4f8b\u3002",(0,r.jsx)(e.code,{children:"createActor(...)"})," \u51fd\u6570\u63a5\u53d7\u4ee5\u4e0b\u53c2\u6570\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"actorLogic"}),"\uff1a\u7528\u4e8e\u521b\u5efa actor \u7684 ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/actors#actor-logic",children:"actor \u903b\u8f91"})]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"options"}),"\uff08\u53ef\u9009\uff09\uff1aactor \u9009\u9879"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5f53\u4f60\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"createActor(actorLogic)"})," \u4ece actor \u903b\u8f91\u521b\u5efa\u4e00\u4e2a actor \u65f6\uff0c\u4f60\u9690\u5f0f\u5730\u521b\u5efa\u4e86\u4e00\u4e2a ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/system",children:"actor \u7cfb\u7edf"}),"\uff0c\u5176\u4e2d\u521b\u5efa\u7684 actor \u662f\u6839 actor\u3002\u4ece\u8fd9\u4e2a\u6839 actor \u53ca\u5176\u540e\u4ee3\u751f\u6210\u7684\u4efb\u4f55 actors \u90fd\u662f\u8be5 actor \u7cfb\u7edf\u7684\u4e00\u90e8\u5206\u3002actor \u5fc5\u987b\u901a\u8fc7\u8c03\u7528 ",(0,r.jsx)(e.code,{children:"actor.start()"})," \u542f\u52a8\uff0c\u8fd9\u4e5f\u5c06\u542f\u52a8 actor \u7cfb\u7edf\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { createActor } from 'xstate';\nimport { someActorLogic } from './someActorLogic.ts';\n\nconst actor = createActor(someActorLogic);\n\nactor.subscribe((snapshot) => {\n  console.log(snapshot);\n});\n\nactor.start();\n\n// \u73b0\u5728 actor \u53ef\u4ee5\u63a5\u6536\u4e8b\u4ef6\nactor.send({ type: 'someEvent' });\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528 ",(0,r.jsx)(e.code,{children:"actor.stop()"})," \u6765\u505c\u6b62\u6839 actor\uff0c\u8fd9\u4e5f\u5c06\u505c\u6b62 actor \u7cfb\u7edf\u53ca\u8be5\u7cfb\u7edf\u4e2d\u7684\u6240\u6709 actors\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"// \u505c\u6b62\u6839 actor\u3001actor \u7cfb\u7edf\u53ca\u7cfb\u7edf\u4e2d\u7684\u6240\u6709 actors\nactor.stop();\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u8c03\u7528\u548c\u751f\u6210-actors",children:"\u8c03\u7528\u548c\u751f\u6210 actors"}),"\n",(0,r.jsx)(e.p,{children:"\u4e00\u4e2a\u88ab\u8c03\u7528\u7684 actor \u4ee3\u8868\u4e00\u4e2a\u57fa\u4e8e\u72b6\u6001\u7684 actor\uff0c\u56e0\u6b64\u5f53\u8c03\u7528\u72b6\u6001\u9000\u51fa\u65f6\uff0c\u5b83\u4f1a\u505c\u6b62\u3002\u8c03\u7528\u7684 actors \u7528\u4e8e\u6709\u9650/\u5df2\u77e5\u6570\u91cf\u7684 actors\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4e00\u4e2a\u751f\u6210\u7684 actor \u4ee3\u8868\u53ef\u4ee5\u968f\u65f6\u542f\u52a8\u548c\u505c\u6b62\u7684\u591a\u4e2a\u5b9e\u4f53\u3002\u751f\u6210\u7684 actors \u662f\u57fa\u4e8e\u52a8\u4f5c\u7684\uff0c\u7528\u4e8e\u52a8\u6001\u6216\u672a\u77e5\u6570\u91cf\u7684 actors\u3002"}),"\n",(0,r.jsxs)(e.p,{children:["\u8c03\u7528\u548c\u751f\u6210 actors \u4e4b\u95f4\u7684\u533a\u522b\u53ef\u4ee5\u5728\u4e00\u4e2a\u5f85\u529e\u4e8b\u9879\u5e94\u7528\u4e2d\u4f53\u73b0\u3002\u5f53\u52a0\u8f7d\u5f85\u529e\u4e8b\u9879\u65f6\uff0c",(0,r.jsx)(e.code,{children:"loadTodos"})," actor \u5c06\u662f\u4e00\u4e2a\u88ab\u8c03\u7528\u7684 actor\uff1b\u5b83\u4ee3\u8868\u4e00\u4e2a\u5355\u4e00\u7684\u57fa\u4e8e\u72b6\u6001\u7684\u4efb\u52a1\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u6bcf\u4e2a\u5f85\u529e\u4e8b\u9879\u672c\u8eab\u53ef\u4ee5\u662f\u751f\u6210\u7684 actors\uff0c\u5e76\u4e14\u8fd9\u4e9b actors \u7684\u6570\u91cf\u662f\u52a8\u6001\u7684\u3002"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"/xstate-zh/docs/invoke",children:"\u9605\u8bfb\u66f4\u591a\u5173\u4e8e\u8c03\u7528 actors \u7684\u4fe1\u606f"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"/xstate-zh/docs/spawn",children:"\u9605\u8bfb\u66f4\u591a\u5173\u4e8e\u751f\u6210 actors \u7684\u4fe1\u606f"})}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"actor-\u5feb\u7167",children:"Actor \u5feb\u7167"}),"\n",(0,r.jsxs)(e.p,{children:["\u5f53\u4e00\u4e2a actor \u63a5\u6536\u5230\u4e00\u4e2a\u4e8b\u4ef6\u65f6\uff0c\u5b83\u7684\u5185\u90e8\u72b6\u6001\u53ef\u80fd\u4f1a\u6539\u53d8\u3002\u5f53\u72b6\u6001\u8f6c\u6362\u53d1\u751f\u65f6\uff0cactor \u53ef\u80fd\u4f1a\u53d1\u51fa\u4e00\u4e2a",(0,r.jsx)(e.strong,{children:"\u5feb\u7167"}),"\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"actor.getSnapshot()"})," \u540c\u6b65\u8bfb\u53d6 actor \u7684\u5feb\u7167\uff0c\u6216\u8005\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"actor.subscribe(observer)"})," \u8ba2\u9605\u5feb\u7167\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { fromPromise, createActor } from 'xstate';\n\nasync function fetchCount() {\n  return Promise.resolve(42);\n}\n\nconst countLogic = fromPromise(async () => {\n  const count = await fetchCount();\n\n  return count;\n});\n\nconst countActor = createActor(countLogic);\n\ncountActor.start();\n\ncountActor.getSnapshot(); // logs undefined\n\n// \u5728 promise \u89e3\u6790\u4e4b\u540e...\ncountActor.getSnapshot();\n// => {\n//   output: 42,\n//   status: 'done',\n//   ...\n// }\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u8ba2\u9605",children:"\u8ba2\u9605"}),"\n",(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"actor.subscribe(observer)"})," \u8ba2\u9605 actor \u7684\u5feb\u7167\u503c\u3002\u89c2\u5bdf\u8005\u5c06\u5728\u5feb\u7167\u503c\u53d1\u51fa\u65f6\u63a5\u6536\u5b83\u3002\u89c2\u5bdf\u8005\u53ef\u4ee5\u662f\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u4e00\u4e2a\u63a5\u6536\u6700\u65b0\u5feb\u7167\u7684\u666e\u901a\u51fd\u6570\uff0c\u6216"}),"\n",(0,r.jsxs)(e.li,{children:["\u4e00\u4e2a\u89c2\u5bdf\u8005\u5bf9\u8c61\uff0c\u5176 ",(0,r.jsx)(e.code,{children:".next(snapshot)"})," \u65b9\u6cd5\u63a5\u6536\u6700\u65b0\u5feb\u7167"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"// \u89c2\u5bdf\u8005\u4f5c\u4e3a\u666e\u901a\u51fd\u6570\nconst subscription = actor.subscribe((snapshot) => {\n  console.log(snapshot);\n});\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"// \u89c2\u5bdf\u8005\u4f5c\u4e3a\u5bf9\u8c61\nconst subscription = actor.subscribe({\n  next(snapshot) {\n    console.log(snapshot);\n  },\n  error(err) {\n    // ...\n  },\n  complete() {\n    // ...\n  },\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"actor.subscribe(observer)"})," \u7684\u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u5177\u6709 ",(0,r.jsx)(e.code,{children:".unsubscribe()"})," \u65b9\u6cd5\u7684\u8ba2\u9605\u5bf9\u8c61\u3002\u4f60\u53ef\u4ee5\u8c03\u7528 ",(0,r.jsx)(e.code,{children:"subscription.unsubscribe()"})," \u6765\u53d6\u6d88\u8ba2\u9605\u89c2\u5bdf\u8005\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const subscription = actor.subscribe((snapshot) => {\n  /* ... */\n});\n\n// \u53d6\u6d88\u8ba2\u9605\u89c2\u5bdf\u8005\nsubscription.unsubscribe();\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5f53 actor \u505c\u6b62\u65f6\uff0c\u6240\u6709\u7684\u89c2\u5bdf\u8005\u5c06\u81ea\u52a8\u53d6\u6d88\u8ba2\u9605\u3002"}),"\n",(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u901a\u8fc7\u5728 ",(0,r.jsx)(e.code,{children:"createActor(logic, options)"})," \u7684\u7b2c\u4e8c\u4e2a ",(0,r.jsx)(e.code,{children:"options"})," \u53c2\u6570\u4e2d\u4f20\u9012\u72b6\u6001\u6765\u5728\u7279\u5b9a\u7684\u6301\u4e45\u5316\u5feb\u7167\uff08\u72b6\u6001\uff09\u4e0b\u521d\u59cb\u5316 actor \u903b\u8f91\u3002\u5982\u679c\u72b6\u6001\u4e0e actor \u903b\u8f91\u517c\u5bb9\uff0c\u8fd9\u5c06\u521b\u5efa\u4e00\u4e2a\u5728\u8be5\u6301\u4e45\u5316\u72b6\u6001\u4e0b\u542f\u52a8\u7684 actor\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const persistedState = JSON.parse(localStorage.getItem('some-persisted-state'));\n\nconst actor = createActor(someLogic, {\n  // highlight-start\n  snapshot: persistedState,\n  // highlight-end\n});\n\nactor.subscribe(() => {\n  localStorage.setItem(\n    'some-persisted-state',\n    JSON.stringify(actor.getPersistedSnapshot()),\n  );\n});\n\n// Actor \u5c06\u4ece\u6301\u4e45\u5316\u72b6\u6001\u5f00\u59cb\nactor.start();\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u8bf7\u53c2\u9605 ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/persistence",children:"\u6301\u4e45\u5316"})," \u4e86\u89e3\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u3002"]}),"\n",(0,r.jsx)(e.h2,{id:"waitfor",children:(0,r.jsx)(e.code,{children:"waitFor"})}),"\n",(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"waitFor(actor, predicate, options?)"})," \u8f85\u52a9\u51fd\u6570\u7b49\u5f85 actor \u7684\u5feb\u7167\u6ee1\u8db3\u8c13\u8bcd\u3002",(0,r.jsx)(e.code,{children:"waitFor(...)"})," \u51fd\u6570\u8fd4\u56de\u4e00\u4e2a promise\uff0c\u8be5 promise \u4f1a\u5728\u4ee5\u4e0b\u60c5\u51b5\u4e0b\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u5f53\u53d1\u51fa\u7684\u5feb\u7167\u6ee1\u8db3 ",(0,r.jsx)(e.code,{children:"predicate"})," \u51fd\u6570\u65f6\u89e3\u6790"]}),"\n",(0,r.jsxs)(e.li,{children:["\u5982\u679c\u5f53\u524d\u5feb\u7167\u5df2\u7ecf\u6ee1\u8db3 ",(0,r.jsx)(e.code,{children:"predicate"})," \u51fd\u6570\uff0c\u5219\u7acb\u5373\u89e3\u6790"]}),"\n",(0,r.jsxs)(e.li,{children:["\u5982\u679c\u629b\u51fa\u9519\u8bef\u6216 ",(0,r.jsx)(e.code,{children:"options.timeout"})," \u503c\u5df2\u8fc7\u671f\uff0c\u5219\u88ab\u62d2\u7edd"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { waitFor } from 'xstate';\nimport { countActor } from './countActor.ts';\n\nconst snapshot = await waitFor(\n  countActor,\n  (snapshot) => {\n    return snapshot.context.count >= 100;\n  },\n  {\n    timeout: 10_000, // 10 seconds (10,000 milliseconds)\n  },\n);\n\nconsole.log(snapshot.output);\n// => 100\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u9519\u8bef\u5904\u7406",children:"\u9519\u8bef\u5904\u7406"}),"\n",(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u4f7f\u7528\u4f20\u9012\u7ed9 ",(0,r.jsx)(e.code,{children:"actor.subscribe()"})," \u7684\u89c2\u5bdf\u8005\u5bf9\u8c61\u4e2d\u7684 ",(0,r.jsx)(e.code,{children:"error"})," \u56de\u8c03\u6765\u8ba2\u9605 actor \u629b\u51fa\u7684\u9519\u8bef\u3002\u8fd9\u5141\u8bb8\u4f60\u5904\u7406\u7531 actor \u903b\u8f91\u53d1\u51fa\u7684\u9519\u8bef\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { createActor } from 'xstate';\nimport { someMachine } from './someMachine';\n\nconst actor = createActor(someMachine);\n\nactor.subscribe({\n  next: (snapshot) => {\n    // ...\n  },\n  // highlight-start\n  error: (err) => {\n    // \u5728\u8fd9\u91cc\u5904\u7406\u9519\u8bef\n    console.error(err);\n  }\n  // highlight-end\n});\n\nactor.start();\n"})}),"\n",(0,r.jsx)(e.h2,{id:"actor-\u903b\u8f91\u521b\u5efa\u5668",children:"Actor \u903b\u8f91\u521b\u5efa\u5668"}),"\n",(0,r.jsx)(e.p,{children:"\u4f60\u53ef\u4ee5\u4ece XState \u521b\u5efa\u7684 actor \u903b\u8f91\u7c7b\u578b\u6709\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsxs)(e.a,{href:"#createmachine",children:["\u72b6\u6001\u673a\u903b\u8f91 (",(0,r.jsx)(e.code,{children:"createMachine(...)"}),")"]})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsxs)(e.a,{href:"#frompromise",children:["Promise \u903b\u8f91 (",(0,r.jsx)(e.code,{children:"fromPromise(...)"}),")"]})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsxs)(e.a,{href:"#fromtransition",children:["\u8f6c\u6362\u51fd\u6570\u903b\u8f91 (",(0,r.jsx)(e.code,{children:"fromTransition(...)"}),")"]})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsxs)(e.a,{href:"#fromobservable",children:["Observable \u903b\u8f91 (",(0,r.jsx)(e.code,{children:"fromObservable(...)"}),")"]})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsxs)(e.a,{href:"#fromeventobservable",children:["\u4e8b\u4ef6 Observable \u903b\u8f91 (",(0,r.jsx)(e.code,{children:"fromEventObservable(...)"}),")"]})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsxs)(e.a,{href:"#fromcallback",children:["\u56de\u8c03\u903b\u8f91 (",(0,r.jsx)(e.code,{children:"fromCallback(...)"}),")"]})}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"actor-\u903b\u8f91\u529f\u80fd",children:"Actor \u903b\u8f91\u529f\u80fd"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{}),(0,r.jsx)(e.th,{children:"\u63a5\u6536\u4e8b\u4ef6"}),(0,r.jsx)(e.th,{children:"\u53d1\u9001\u4e8b\u4ef6"}),(0,r.jsx)(e.th,{children:"\u751f\u6210 actors"}),(0,r.jsx)(e.th,{children:"\u8f93\u5165"}),(0,r.jsx)(e.th,{children:"\u8f93\u51fa"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"/xstate-zh/docs/state-machine-actors",children:"\u72b6\u6001\u673a actors"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"/xstate-zh/docs/promise-actors",children:"Promise actors"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"cross mark",children:"\u274c"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"cross mark",children:"\u274c"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"/xstate-zh/docs/transition-actors",children:"\u8f6c\u6362 actors"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"cross mark",children:"\u274c"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"cross mark",children:"\u274c"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"/xstate-zh/docs/observable-actors",children:"Observable actors"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"cross mark",children:"\u274c"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"cross mark",children:"\u274c"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"cross mark",children:"\u274c"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.a,{href:"/xstate-zh/docs/callback-actors",children:"\u56de\u8c03 actors"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"cross mark",children:"\u274c"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"check mark button",children:"\u2705"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.span,{role:"img","aria-label":"cross mark",children:"\u274c"})})]})]})]}),"\n",(0,r.jsxs)(e.h3,{id:"createmachine",children:["\u72b6\u6001\u673a\u903b\u8f91 (",(0,r.jsx)(e.code,{children:"createMachine(...)"}),")"]}),"\n",(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u5c06 actor \u903b\u8f91\u63cf\u8ff0\u4e3a\u4e00\u4e2a",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/machines",children:"\u72b6\u6001\u673a"}),"\u3002\u4ece\u72b6\u6001\u673a actor \u903b\u8f91\u521b\u5efa\u7684 actors \u53ef\u4ee5\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u63a5\u6536\u4e8b\u4ef6"}),"\n",(0,r.jsx)(e.li,{children:"\u5411\u5176\u4ed6 actors \u53d1\u9001\u4e8b\u4ef6"}),"\n",(0,r.jsx)(e.li,{children:"\u8c03\u7528/\u751f\u6210\u5b50 actors"}),"\n",(0,r.jsx)(e.li,{children:"\u53d1\u51fa\u5176\u72b6\u6001\u7684\u5feb\u7167"}),"\n",(0,r.jsx)(e.li,{children:"\u5f53\u72b6\u6001\u673a\u8fbe\u5230\u5176\u9876\u7ea7\u6700\u7ec8\u72b6\u6001\u65f6\u8f93\u51fa\u4e00\u4e2a\u503c"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const toggleMachine = createMachine({\n  id: 'toggle',\n  initial: 'inactive',\n  states: {\n    inactive: {},\n    active: {},\n  },\n});\n\nconst toggleActor = createActor(toggleMachine);\n\ntoggleActor.subscribe((snapshot) => {\n  // \u5feb\u7167\u662f\u72b6\u6001\u673a\u7684\u72b6\u6001\n  console.log('state', snapshot.value);\n  console.log('context', snapshot.context);\n});\ntoggleActor.start();\n// \u8f93\u51fa 'inactive'\ntoggleActor.send({ type: 'toggle' });\n// \u8f93\u51fa 'active'\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u4e86\u89e3\u66f4\u591a\u5173\u4e8e ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/state-machine-actors",children:"\u72b6\u6001\u673a actors"})," \u7684\u4fe1\u606f\u3002"]}),"\n",(0,r.jsxs)(e.h3,{id:"frompromise",children:["Promise \u903b\u8f91 (",(0,r.jsx)(e.code,{children:"fromPromise(...)"}),")"]}),"\n",(0,r.jsx)(e.p,{children:"Promise actor \u903b\u8f91\u7531\u4e00\u4e2a\u5728\u4e00\u6bb5\u65f6\u95f4\u540e\u89e3\u6790\u6216\u62d2\u7edd\u7684\u5f02\u6b65\u8fc7\u7a0b\u63cf\u8ff0\u3002\u4ece promise \u903b\u8f91\u521b\u5efa\u7684 actors\uff08\u201cpromise actors\u201d\uff09\u53ef\u4ee5\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u53d1\u51fa promise \u7684\u89e3\u6790\u503c"}),"\n",(0,r.jsx)(e.li,{children:"\u8f93\u51fa promise \u7684\u89e3\u6790\u503c"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u53d1\u9001\u4e8b\u4ef6\u7ed9 promise actors \u5c06\u4e0d\u4f1a\u6709\u4efb\u4f55\u6548\u679c\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const promiseLogic = fromPromise(() => {\n  return fetch('https://example.com/...').then((data) => data.json());\n});\n\nconst promiseActor = createActor(promiseLogic);\npromiseActor.subscribe((snapshot) => {\n  console.log(snapshot);\n});\npromiseActor.start();\n// => {\n//   output: undefined,\n//   status: 'active'\n//   ...\n// }\n\n// After promise resolves\n// => {\n//   output: { ... },\n//   status: 'done',\n//   ...\n// }\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u4e86\u89e3\u66f4\u591a\u5173\u4e8e ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/promise-actors",children:"Promise actors"})," \u7684\u4fe1\u606f\u3002"]}),"\n",(0,r.jsxs)(e.h3,{id:"fromtransition",children:["\u8f6c\u6362\u51fd\u6570\u903b\u8f91 (",(0,r.jsx)(e.code,{children:"fromTransition(...)"}),")"]}),"\n",(0,r.jsxs)(e.p,{children:["\u8f6c\u6362 actor \u903b\u8f91\u7531\u4e00\u4e2a",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/migration#use-actor-logic-creators-for-invokesrc-instead-of-functions",children:"\u8f6c\u6362\u51fd\u6570"}),"\u63cf\u8ff0\uff0c\u7c7b\u4f3c\u4e8e\u4e00\u4e2a",(0,r.jsx)(e.a,{href:"cheatsheet#creating-transition-logic",children:"reducer"}),"\u3002\u8f6c\u6362\u51fd\u6570\u5c06\u5f53\u524d\u7684 ",(0,r.jsx)(e.code,{children:"state"})," \u548c\u63a5\u6536\u5230\u7684 ",(0,r.jsx)(e.code,{children:"event"})," \u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u8fd4\u56de\u4e0b\u4e00\u4e2a\u72b6\u6001\u3002\u4ece\u8f6c\u6362\u903b\u8f91\u521b\u5efa\u7684 actors\uff08\u201c\u8f6c\u6362 actors\u201d\uff09\u53ef\u4ee5\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u63a5\u6536\u4e8b\u4ef6"}),"\n",(0,r.jsx)(e.li,{children:"\u53d1\u51fa\u5176\u72b6\u6001\u7684\u5feb\u7167"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const transitionLogic = fromTransition(\n  (state, event) => {\n    if (event.type === 'increment') {\n      return {\n        ...state,\n        count: state.count + 1,\n      };\n    }\n    return state;\n  },\n  { count: 0 },\n);\n\nconst transitionActor = createActor(transitionLogic);\ntransitionActor.subscribe((snapshot) => {\n  console.log(snapshot);\n});\ntransitionActor.start();\n// => {\n//   status: 'active',\n//   context: { count: 0 },\n//   ...\n// }\n\ntransitionActor.send({ type: 'increment' });\n// => {\n//   status: 'active',\n//   context: { count: 1 },\n//   ...\n// }\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u4e86\u89e3\u66f4\u591a\u5173\u4e8e ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/transition-actors",children:"\u8f6c\u6362 actors"})," \u7684\u4fe1\u606f\u3002"]}),"\n",(0,r.jsxs)(e.h3,{id:"fromobservable",children:["Observable \u903b\u8f91 (",(0,r.jsx)(e.code,{children:"fromObservable(...)"}),")"]}),"\n",(0,r.jsxs)(e.p,{children:["Observable actor \u903b\u8f91\u7531\u4e00\u4e2a",(0,r.jsx)(e.a,{href:"#fromObservable",children:"observable \u503c\u6d41"}),"\u63cf\u8ff0\u3002\u4ece observable \u903b\u8f91\u521b\u5efa\u7684 actors\uff08\u201cobservable actors\u201d\uff09\u53ef\u4ee5\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u53d1\u51fa observable \u7684\u5df2\u53d1\u51fa\u503c\u7684\u5feb\u7167"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u53d1\u9001\u4e8b\u4ef6\u7ed9 observable actors \u5c06\u4e0d\u4f1a\u6709\u4efb\u4f55\u6548\u679c\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { interval } from 'rxjs';\n\nconst secondLogic = fromObservable(() => interval(1000));\n\nconst secondActor = createActor(secondLogic);\n\nsecondActor.subscribe((snapshot) => {\n  console.log(snapshot.context);\n});\n\nsecondActor.start();\n// \u6bcf\u79d2:\n// \u8f93\u51fa 0\n// \u8f93\u51fa 1\n// \u8f93\u51fa 2\n// ...\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u4e86\u89e3\u66f4\u591a\u5173\u4e8e ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/observable-actors",children:"observable actors"})," \u7684\u4fe1\u606f\u3002"]}),"\n",(0,r.jsxs)(e.h3,{id:"fromeventobservable",children:["\u4e8b\u4ef6 Observable \u903b\u8f91 (",(0,r.jsx)(e.code,{children:"fromEventObservable(...)"}),")"]}),"\n",(0,r.jsxs)(e.p,{children:["\u4e8b\u4ef6 Observable actor \u903b\u8f91\u7531 ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/transitions#event-objects",children:"\u4e8b\u4ef6\u5bf9\u8c61"})," \u7684 Observable \u6d41\u63cf\u8ff0\u3002\u4ece\u4e8b\u4ef6 Observable \u903b\u8f91\u521b\u5efa\u7684 actors\uff08\u201c\u4e8b\u4ef6 Observable actors\u201d\uff09\u53ef\u4ee5\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u9690\u5f0f\u5730\u5411\u5176\u7236 actor \u53d1\u9001\u4e8b\u4ef6"}),"\n",(0,r.jsx)(e.li,{children:"\u53d1\u51fa\u5176\u5df2\u53d1\u51fa\u4e8b\u4ef6\u5bf9\u8c61\u7684\u5feb\u7167"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u53d1\u9001\u4e8b\u4ef6\u7ed9\u4e8b\u4ef6 Observable actors \u5c06\u4e0d\u4f1a\u6709\u4efb\u4f55\u6548\u679c\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { setup, fromEventObservable } from 'xstate';\nimport { fromEvent } from 'rxjs';\n\nconst mouseClickLogic = fromEventObservable(() =>\n  fromEvent(document.body, 'click') as Subscribable<EventObject>\n);\n\nconst canvasMachine = setup({\n  actors: {\n    mouseClickLogic\n  }\n}).createMachine({\n  invoke: {\n    // \u5c06\u9f20\u6807\u70b9\u51fb\u4e8b\u4ef6\u53d1\u9001\u5230 canvas actor\n    src: 'mouseClickLogic',\n  },\n});\n\nconst canvasActor = createActor(canvasMachine);\ncanvasActor.start();\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u4e86\u89e3\u66f4\u591a\u5173\u4e8e ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/observable-actors",children:"observable actors"})," \u7684\u4fe1\u606f\u3002"]}),"\n",(0,r.jsxs)(e.h3,{id:"fromcallback",children:["\u56de\u8c03\u903b\u8f91 (",(0,r.jsx)(e.code,{children:"fromCallback(...)"}),")"]}),"\n",(0,r.jsxs)(e.p,{children:["\u56de\u8c03 actor \u903b\u8f91\u7531\u4e00\u4e2a\u63a5\u6536\u5355\u4e2a\u5bf9\u8c61\u53c2\u6570\u7684\u56de\u8c03\u51fd\u6570\u63cf\u8ff0\uff0c\u8be5\u5bf9\u8c61\u5305\u62ec ",(0,r.jsx)(e.code,{children:"sendBack(event)"})," \u51fd\u6570\u548c ",(0,r.jsx)(e.code,{children:"receive(event => ...)"})," \u51fd\u6570\u3002\u4ece\u56de\u8c03\u903b\u8f91\u521b\u5efa\u7684 actors\uff08\u201c\u56de\u8c03 actors\u201d\uff09\u53ef\u4ee5\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"receive"})," \u51fd\u6570\u63a5\u6536\u4e8b\u4ef6"]}),"\n",(0,r.jsxs)(e.li,{children:["\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"sendBack"})," \u51fd\u6570\u5411\u7236 actor \u53d1\u9001\u4e8b\u4ef6"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const callbackLogic = fromCallback(({ sendBack, receive }) => {\n  let lockStatus = 'unlocked';\n\n  const handler = (event) => {\n    if (lockStatus === 'locked') {\n      return;\n    }\n    sendBack(event);\n  };\n\n  receive((event) => {\n    if (event.type === 'lock') {\n      lockStatus = 'locked';\n    } else if (event.type === 'unlock') {\n      lockStatus = 'unlocked';\n    }\n  });\n\n  document.body.addEventListener('click', handler);\n\n  return () => {\n    document.body.removeEventListener('click', handler);\n  };\n});\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u56de\u8c03 actors \u4e0e\u5176\u4ed6 actors \u6709\u4e9b\u4e0d\u540c\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0d\u4f1a\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u4e0d\u4e0e ",(0,r.jsx)(e.code,{children:"onDone"})," \u4e00\u8d77\u5de5\u4f5c"]}),"\n",(0,r.jsxs)(e.li,{children:["\u4e0d\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:".getSnapshot()"})," \u751f\u6210\u5feb\u7167"]}),"\n",(0,r.jsxs)(e.li,{children:["\u4e0d\u5728\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:".subscribe()"})," \u65f6\u53d1\u51fa\u503c"]}),"\n",(0,r.jsxs)(e.li,{children:["\u4e0d\u80fd\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:".stop()"})," \u505c\u6b62"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"sendBack"})," \u5c06\u6355\u83b7\u7684\u9519\u8bef\u62a5\u544a\u7ed9\u7236 actor\u3002\u8fd9\u5bf9\u4e8e\u5904\u7406\u56de\u8c03\u51fd\u6570\u4e2d\u7684 promise \u62d2\u7edd\u7279\u522b\u6709\u7528\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u62d2\u7edd\u4e0d\u4f1a\u88ab ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/invoke#onerror",children:(0,r.jsx)(e.code,{children:"onError"})})," \u6355\u83b7\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u56de\u8c03\u51fd\u6570\u4e0d\u80fd\u662f ",(0,r.jsx)(e.code,{children:"async"})," \u51fd\u6570\u3002\u4f46\u53ef\u4ee5\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u6267\u884c Promise\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { setup, fromCallback } from 'xstate';\n\nconst someCallback = fromCallback(({ sendBack }) => {\n  // highlight-start\n  somePromise()\n    .then((data) => sendBack({ type: 'done', data }))\n    .catch((error) => sendBack({ type: 'error', data: error }));\n  // highlight-end\n\n  return () => {\n    /* \u6e05\u7406\u51fd\u6570 */\n  };\n})\n\nconst machine = setup({\n  actors: {\n    someCallback\n  }\n}).createMachine({\n  initial: 'running',\n  states: {\n    running: {\n      invoke: {\n        src: 'someCallback',\n      },\n      // highlight-start\n      on: {\n        error: {\n          actions: ({ event }) => console.error(event.data),\n        },\n      },\n      // highlight-end\n    },\n  },\n});\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u4e86\u89e3\u66f4\u591a\u5173\u4e8e ",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/callback-actors",children:"\u56de\u8c03 actors"})," \u7684\u4fe1\u606f\u3002"]}),"\n",(0,r.jsx)(e.h2,{id:"\u4f5c\u4e3a-promise-\u7684-actors",children:"\u4f5c\u4e3a Promise \u7684 actors"}),"\n",(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"toPromise(actor)"})," \u51fd\u6570\u4ece\u4efb\u4f55 actor \u521b\u5efa\u4e00\u4e2a promise\u3002\u5f53 actor \u5b8c\u6210\u65f6\uff08",(0,r.jsx)(e.code,{children:"snapshot.status === 'done'"}),"\uff09\uff0cpromise \u5c06\u4f7f\u7528 actor \u5feb\u7167\u7684 ",(0,r.jsx)(e.code,{children:".output"})," \u89e3\u6790\uff1b\u5f53 actor \u51fa\u9519\u65f6\uff08",(0,r.jsx)(e.code,{children:"snapshot.status === 'error'"}),"\uff09\uff0cpromise \u5c06\u4f7f\u7528 actor \u5feb\u7167\u7684 ",(0,r.jsx)(e.code,{children:".error"})," \u62d2\u7edd\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { createMachine, createActor, toPromise } from 'xstate';\n\nconst machine = createMachine({\n  // ...\n  states: {\n    // ...\n    done: { type: 'final' }\n  },\n  output: {\n    count: 42\n  }\n});\n\nconst actor = createActor(machine);\nactor.start();\n\n// highlight-start\n// \u521b\u5efa\u4e00\u4e2a promise\uff0c\u8be5 promise \u4f7f\u7528 actor \u7684\u8f93\u51fa\u89e3\u6790\n// \u6216\u4f7f\u7528 actor \u7684\u9519\u8bef\u62d2\u7edd\nconst output = await toPromise(actor);\n// highlight-end\n\nconsole.log(output);\n// => { count: 42 }\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u5982\u679c actor \u5df2\u7ecf\u5b8c\u6210\uff0cpromise \u5c06\u7acb\u5373\u4f7f\u7528 actor \u7684 ",(0,r.jsx)(e.code,{children:"snapshot.output"})," \u89e3\u6790\u3002\u5982\u679c actor \u5df2\u7ecf\u51fa\u9519\uff0cpromise \u5c06\u7acb\u5373\u4f7f\u7528 actor \u7684 ",(0,r.jsx)(e.code,{children:"snapshot.error"})," \u62d2\u7edd\u3002"]}),"\n",(0,r.jsx)(e.h2,{id:"\u9ad8\u7ea7-actor-\u903b\u8f91",children:"\u9ad8\u7ea7 actor \u903b\u8f91"}),"\n",(0,r.jsx)(e.p,{children:"\u9ad8\u7ea7 actor \u903b\u8f91\u901a\u8fc7\u9644\u52a0\u529f\u80fd\u589e\u5f3a\u73b0\u6709\u7684 actor \u903b\u8f91\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u8bb0\u5f55\u6216\u6301\u4e45\u5316 actor \u72b6\u6001\u7684 actor \u903b\u8f91\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { fromTransition, type AnyActorLogic } from 'xstate';\n\nconst toggleLogic = fromTransition((state, event) => {\n  if (event.type === 'toggle') {\n    return state === 'paused' ? 'playing' : 'paused';\n  }\n\n  return state;\n}, 'paused');\n\n// highlight-start\nfunction withLogging<T extends AnyActorLogic>(actorLogic: T) {\n  const enhancedLogic = {\n    ...actorLogic,\n    transition: (state, event, actorCtx) => {\n      console.log('State:', state);\n      return actorLogic.transition(state, event, actorCtx);\n    },\n  } satisfies T;\n\n  return enhancedLogic;\n}\n\nconst loggingToggleLogic = withLogging(toggleLogic);\n// highlight-end\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u81ea\u5b9a\u4e49-actor-\u903b\u8f91",children:"\u81ea\u5b9a\u4e49 actor \u903b\u8f91"}),"\n",(0,r.jsxs)(e.p,{children:["\u81ea\u5b9a\u4e49 actor \u903b\u8f91\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0 ",(0,r.jsx)(e.code,{children:"ActorLogic"})," \u63a5\u53e3\u7684\u5bf9\u8c61\u6765\u5b9a\u4e49\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u4f8b\u5982\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a\u5e26\u6709 ",(0,r.jsx)(e.code,{children:"transition"})," \u51fd\u6570\u7684\u81ea\u5b9a\u4e49 actor \u903b\u8f91\u5bf9\u8c61\uff0c\u5b83\u4f5c\u4e3a\u4e00\u4e2a\u7b80\u5355\u7684 reducer \u64cd\u4f5c\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { createActor, EventObject, ActorLogic, Snapshot } from \"xstate\";\n\nconst countLogic: ActorLogic<\n  Snapshot<undefined> & { context: number },\n  EventObject\n> = {\n  transition: (state, event) => {\n    if (event.type === 'INC') {\n      return {\n        ...state,\n        context: state.context + 1\n      };\n    } else if (event.type === 'DEC') {\n      return {\n        ...state,\n        context: state.context - 1\n      };\n    }\n    return state;\n  },\n  getInitialSnapshot: () => ({\n    status: 'active',\n    output: undefined,\n    error: undefined,\n    context: 0\n  }),\n  getPersistedSnapshot: (s) => s\n};\n\nconst actor = createActor(countLogic)\nactor.subscribe(state => {\n  console.log(state.context)\n})\nactor.start() // => 0\nactor.send({ type: 'INC' }) // => 1\nactor.send({ type: 'INC' }) // => 2\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u6709\u5173\u66f4\u591a\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605\u6e90\u4ee3\u7801\u4e2d\u7684 ",(0,r.jsx)(e.code,{children:"ActorLogic"})," \u5b9e\u73b0\uff0c\u4f8b\u5982 ",(0,r.jsx)(e.code,{children:"fromTransition"})," actor \u903b\u8f91\u521b\u5efa\u5668\uff0c\u6216\u6d4b\u8bd5\u4e2d\u7684\u793a\u4f8b\u3002"]}),"\n",(0,r.jsx)(e.h2,{id:"\u7a7a-actor",children:"\u7a7a actor"}),"\n",(0,r.jsxs)(e.p,{children:["\u4e00\u4e2a\u4ec0\u4e48\u90fd\u4e0d\u505a\u4e14\u53ea\u6709\u4e00\u4e2a\u5df2\u53d1\u51fa\u5feb\u7167\u7684 actor\uff1a",(0,r.jsx)(e.code,{children:"undefined"})]}),"\n",(0,r.jsxs)(e.p,{children:["\u5728 XState \u4e2d\uff0c\u7a7a actor \u662f\u4e00\u4e2a\u4ec0\u4e48\u90fd\u4e0d\u505a\u4e14\u53ea\u6709\u4e00\u4e2a\u5df2\u53d1\u51fa\u5feb\u7167\u7684 actor\uff1a",(0,r.jsx)(e.code,{children:"undefined"}),"\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u8fd9\u5bf9\u4e8e\u6d4b\u8bd5\u975e\u5e38\u6709\u7528\uff0c\u4f8b\u5982\u66ff\u4ee3\u5c1a\u672a\u5b9e\u73b0\u7684 actor\u3002\u5728\u6846\u67b6\u96c6\u6210\u4e2d\u4e5f\u5f88\u6709\u7528\uff0c\u4f8b\u5982 ",(0,r.jsx)(e.code,{children:"@xstate/react"}),"\uff0c\u5176\u4e2d actor \u53ef\u80fd\u5c1a\u4e0d\u53ef\u7528\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { createEmptyActor, AnyActorRef } from 'xstate';\nimport { useSelector } from '@xstate/react';\nconst emptyActor = createEmptyActor();\n\nfunction Component(props: { actor?: AnyActorRef }) {\n  const data = useSelector(\n    props.actor ?? emptyActor,\n    (snapshot) => snapshot.context.data,\n  );\n\n  // \u5982\u679c `props.actor` \u662f undefined\uff0c\u5219 data \u662f `undefined`\n  // \u5426\u5219\uff0c\u5b83\u662f\u6765\u81ea actor \u7684\u6570\u636e\n\n  // ...\n}\n"})}),"\n",(0,r.jsx)(e.h2,{id:"actors-\u548c-typescript",children:"Actors \u548c TypeScript"}),"\n",(0,r.jsxs)(e.admonition,{type:"typescript",children:[(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"XState v5 \u9700\u8981 TypeScript \u7248\u672c 5.0 \u6216\u66f4\u9ad8\u7248\u672c\u3002"})}),(0,r.jsxs)(e.p,{children:["\u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u6548\u679c\uff0c\u8bf7\u4f7f\u7528\u6700\u65b0\u7684 TypeScript \u7248\u672c\u3002",(0,r.jsx)(e.a,{href:"/xstate-zh/docs/typescript",children:"\u9605\u8bfb\u66f4\u591a\u5173\u4e8e XState \u548c TypeScript \u7684\u4fe1\u606f"})]})]}),"\n",(0,r.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u5728\u673a\u5668\u914d\u7f6e\u7684 ",(0,r.jsx)(e.code,{children:"types.actors"})," \u5c5e\u6027\u4e2d\u5f3a\u7c7b\u578b\u5316\u673a\u5668\u7684 ",(0,r.jsx)(e.code,{children:"actors"}),"\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"const fetcher = fromPromise(\n  async ({ input }: { input: { userId: string } }) => {\n    const user = await fetchUser(input.userId);\n\n    return user;\n  },\n);\n\nconst machine = setup({\n  types: {\n    children: {} as {\n      fetch1: 'fetcher';\n      fetch2: 'fetcher';\n    }\n  }\n  // highlight-next-line\n  actors: { fetcher }\n}).createMachine({\n  invoke: {\n    // highlight-start\n    src: 'fetchData', // \u5f3a\u7c7b\u578b\n    id: 'fetch2', // \u5f3a\u7c7b\u578b\n    onDone: {\n      actions: ({ event }) => {\n      event.output; // \u5f3a\u7c7b\u578b\u4e3a { result: string }\n      },\n    },\n    input: { userId: '42' }, // \u5f3a\u7c7b\u578b\n    // highlight-end\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u6d4b\u8bd5",children:"\u6d4b\u8bd5"}),"\n",(0,r.jsx)(e.p,{children:"\u6d4b\u8bd5 actors \u7684\u4e00\u822c\u7b56\u7565\u662f\u53d1\u9001\u4e8b\u4ef6\u5e76\u65ad\u8a00 actor \u8fbe\u5230\u9884\u671f\u72b6\u6001\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u89c2\u5bdf\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"actor.subscribe(...)"})," \u8ba2\u9605\u5176\u53d1\u51fa\u7684\u5feb\u7167"]}),"\n",(0,r.jsxs)(e.li,{children:["\u6216\u8005\u901a\u8fc7 ",(0,r.jsx)(e.code,{children:"actor.getSnapshot()"})," \u8bfb\u53d6\u6700\u65b0\u7684\u5feb\u7167\u3002"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"test('some actor', async () => {\n  const actor = createActor(fromTransition((state, event) => {\n    if (event.type === 'inc') {\n      return { count: state.count + 1 }\n    }\n    return state;\n  }, { count: 0 }));\n\n  // \u542f\u52a8 actor\n  actor.start();\n\n  // \u53d1\u9001\u4e8b\u4ef6\n  actor.send({ type: 'inc' });\n  actor.send({ type: 'inc' });\n  actor.send({ type: 'inc' });\n\n  // \u65ad\u8a00\u9884\u671f\u7ed3\u679c\n  expect(actor.getSnapshot().context).toEqual({ count: 3 });\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"actors-\u901f\u67e5\u8868",children:"Actors \u901f\u67e5\u8868"}),"\n",(0,r.jsx)(e.h3,{id:"\u901f\u67e5\u8868\u521b\u5efa\u4e00\u4e2a-actor",children:"\u901f\u67e5\u8868\uff1a\u521b\u5efa\u4e00\u4e2a actor"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { createActor } from 'xstate';\nimport { someActorLogic } from './someActorLogic.ts';\n\n// \u4ece actor \u903b\u8f91\u521b\u5efa\u4e00\u4e2a actor\nconst actor = createActor(someActorLogic);\n\n// \u8ba2\u9605 actor \u7684\u5feb\u7167\u503c\u5e76\u8bb0\u5f55\u5b83\u4eec\nactor.subscribe((snapshot) => {\n  console.log(snapshot);\n});\n\n// \u542f\u52a8 actor \u7cfb\u7edf\nactor.start();\n\n// \u73b0\u5728 actor \u53ef\u4ee5\u63a5\u6536\u4e8b\u4ef6\nactor.send({ type: 'someEvent' });\n\n// \u505c\u6b62\u6839 actor\u3001actor \u7cfb\u7edf\u53ca\u7cfb\u7edf\u4e2d\u7684\u6240\u6709 actors\nactor.stop();\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u901f\u67e5\u8868\u72b6\u6001\u673a\u903b\u8f91",children:"\u901f\u67e5\u8868\uff1a\u72b6\u6001\u673a\u903b\u8f91"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { createMachine, createActor } from 'xstate';\n\nconst toggleMachine = createMachine({\n  id: 'toggle',\n  initial: 'inactive',\n  states: {\n    inactive: {},\n    active: {},\n  },\n});\n\nconst toggleActor = createActor(toggleMachine);\n\ntoggleActor.subscribe((snapshot) => {\n  // \u5feb\u7167\u662f\u72b6\u6001\u673a\u7684\u72b6\u6001\n  console.log('state', snapshot.value);\n  console.log('context', snapshot.context);\n});\ntoggleActor.start();\n// \u8f93\u51fa 'inactive'\ntoggleActor.send({ type: 'toggle' });\n// \u8f93\u51fa 'active'\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u901f\u67e5\u8868promise-\u903b\u8f91",children:"\u901f\u67e5\u8868\uff1aPromise \u903b\u8f91"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { fromPromise, createActor } from 'xstate';\n\nconst promiseLogic = fromPromise(() => {\n  return fetch('https://example.com/...').then((data) => data.json());\n});\n\nconst promiseActor = createActor(promiseLogic);\npromiseActor.subscribe((snapshot) => {\n  console.log(snapshot);\n});\npromiseActor.start();\n\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u901f\u67e5\u8868\u8f6c\u6362\u51fd\u6570\u903b\u8f91",children:"\u901f\u67e5\u8868\uff1a\u8f6c\u6362\u51fd\u6570\u903b\u8f91"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { fromTransition, createActor } from 'xstate';\n\nconst transitionLogic = fromTransition(\n  (state, event) => {\n    if (event.type === 'increment') {\n      return {\n        ...state,\n        count: state.count + 1,\n      };\n    }\n    return state;\n  },\n  { count: 0 },\n);\n\nconst transitionActor = createActor(transitionLogic);\ntransitionActor.subscribe((snapshot) => {\n  console.log(snapshot);\n});\ntransitionActor.start();\n// => {\n//   status: 'active',\n//   context: { count: 0 },\n//   ...\n// }\n\ntransitionActor.send({ type: 'increment' });\n// => {\n//   status: 'active',\n//   context: { count: 1 },\n//   ...\n// }\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u901f\u67e5\u8868observable-\u903b\u8f91",children:"\u901f\u67e5\u8868\uff1aObservable \u903b\u8f91"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { fromObservable, createActor } from 'xstate';\nimport { interval } from 'rxjs';\n\nconst secondLogic = fromObservable(() => interval(1000));\n\nconst secondActor = createActor(secondLogic);\n\nsecondActor.subscribe((snapshot) => {\n  console.log(snapshot.context);\n});\n\nsecondActor.start();\n// \u6bcf\u79d2:\n// \u8f93\u51fa 0\n// \u8f93\u51fa 1\n// \u8f93\u51fa 2\n// ...\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u901f\u67e5\u8868\u4e8b\u4ef6-observable-\u903b\u8f91",children:"\u901f\u67e5\u8868\uff1a\u4e8b\u4ef6 Observable \u903b\u8f91"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { setup, fromEventObservable, createActor } from 'xstate';\nimport { fromEvent } from 'rxjs';\n\nconst mouseClickLogic = fromEventObservable(() =>\n  fromEvent(document.body, 'click') as Subscribable<EventObject>\n);\n\nconst canvasMachine = setup({\n  actors: {\n    mouseClickLogic\n  }\n}).createMachine({\n  invoke: {\n    // \u5c06\u9f20\u6807\u70b9\u51fb\u4e8b\u4ef6\u53d1\u9001\u5230 canvas actor\n    src: 'mouseClickLogic',\n  },\n});\n\nconst canvasActor = createActor(canvasMachine);\ncanvasActor.start();\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u901f\u67e5\u8868\u56de\u8c03\u903b\u8f91",children:"\u901f\u67e5\u8868\uff1a\u56de\u8c03\u903b\u8f91"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"import { fromCallback, createActor } from 'xstate';\n\nconst callbackLogic = fromCallback(({ sendBack, receive }) => {\n  let lockStatus = 'unlocked';\n\n  const handler = (event) => {\n    if (lockStatus === 'locked') {\n      return;\n    }\n    sendBack(event);\n  };\n\n  receive((event) => {\n    if (event.type === 'lock') {\n      lockStatus = 'locked';\n    } else if (event.type === 'unlock') {\n      lockStatus = 'unlocked';\n    }\n  });\n\n  document.body.addEventListener('click', handler);\n\n  return () => {\n    document.body.removeEventListener('click', handler);\n  };\n});\n"})})]})}function h(n={}){const{wrapper:e}={...(0,c.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},11151:(n,e,t)=>{t.d(e,{Z:()=>a,a:()=>o});var r=t(67294);const c={},s=r.createContext(c);function o(n){const e=r.useContext(s);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:o(n.components),r.createElement(s.Provider,{value:e},n.children)}}}]);