"use strict";(self.webpackChunkstately_docs=self.webpackChunkstately_docs||[]).push([[7723],{71169:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var s=t(85893),c=t(11151);const a={title:"\u4ece XState v4 \u8fc1\u79fb\u5230 v5"},i=void 0,r={id:"migration",title:"\u4ece XState v4 \u8fc1\u79fb\u5230 v5",description:"\u4e0b\u9762\u7684\u6307\u5357\u89e3\u91ca\u4e86\u5982\u4f55\u4ece XState \u7248\u672c 4 \u8fc1\u79fb\u5230\u7248\u672c 5\u3002\u4ece XState v4 \u8fc1\u79fb\u5230 v5 \u5e94\u8be5\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8fc7\u7a0b\u3002\u5982\u679c\u60a8\u9047\u5230\u56f0\u96be\u6216\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u8bf7\u901a\u8fc7 \u6211\u4eec\u7684 Discord \u8054\u7cfb Stately \u56e2\u961f\u3002",source:"@site/docs/migration.mdx",sourceDirName:".",slug:"/migration",permalink:"/xstate-zh/docs/migration",draft:!1,unlisted:!1,editUrl:"https://github.com/ouweiya/xstate-zh/tree/main/docs/migration.mdx",tags:[],version:"current",frontMatter:{title:"\u4ece XState v4 \u8fc1\u79fb\u5230 v5"},sidebar:"tutorialSidebar",previous:{title:"\u5b89\u88c5",permalink:"/xstate-zh/docs/installation"},next:{title:"XState \u793a\u4f8b",permalink:"/xstate-zh/docs/examples"}},l={},d=[{value:"XState v5 \u548c TypeScript",id:"xstate-v5-\u548c-typescript",level:2},{value:"\u521b\u5efa\u673a\u5668\u548c\u6f14\u5458",id:"\u521b\u5efa\u673a\u5668\u548c\u6f14\u5458",level:2},{value:"\u4f7f\u7528 <code>createMachine()</code>\uff0c\u800c\u4e0d\u662f <code>Machine()</code>",id:"\u4f7f\u7528-createmachine\u800c\u4e0d\u662f-machine",level:3},{value:"\u4f7f\u7528 <code>createActor()</code>\uff0c\u800c\u4e0d\u662f <code>interpret()</code>",id:"\u4f7f\u7528-createactor\u800c\u4e0d\u662f-interpret",level:3},{value:"\u4f7f\u7528 <code>machine.provide()</code>\uff0c\u800c\u4e0d\u662f <code>machine.withConfig()</code>",id:"\u4f7f\u7528-machineprovide\u800c\u4e0d\u662f-machinewithconfig",level:3},{value:"\u4f7f\u7528 <code>input</code> \u8bbe\u7f6e\u4e0a\u4e0b\u6587\uff0c\u800c\u4e0d\u662f <code>machine.withContext()</code>",id:"\u4f7f\u7528-input-\u8bbe\u7f6e\u4e0a\u4e0b\u6587\u800c\u4e0d\u662f-machinewithcontext",level:3},{value:"\u52a8\u4f5c\u9ed8\u8ba4\u6309\u987a\u5e8f\u6267\u884c\uff0c\u4e0d\u518d\u9700\u8981 <code>predictableActionArguments</code>",id:"\u52a8\u4f5c\u9ed8\u8ba4\u6309\u987a\u5e8f\u6267\u884c\u4e0d\u518d\u9700\u8981-predictableactionarguments",level:3},{value:"<code>spawn()</code> \u51fd\u6570\u5df2\u88ab\u79fb\u9664",id:"spawn-\u51fd\u6570\u5df2\u88ab\u79fb\u9664",level:3},{value:"\u4f7f\u7528 <code>getNextSnapshot(\u2026)</code> \u4ee3\u66ff <code>machine.transition(\u2026)</code>",id:"\u4f7f\u7528-getnextsnapshot-\u4ee3\u66ff-machinetransition",level:3},{value:"\u663e\u5f0f\u53d1\u9001\u4e8b\u4ef6\u800c\u4e0d\u662f\u4f7f\u7528 <code>autoForward</code>",id:"\u663e\u5f0f\u53d1\u9001\u4e8b\u4ef6\u800c\u4e0d\u662f\u4f7f\u7528-autoforward",level:3},{value:"\u72b6\u6001",id:"\u72b6\u6001",level:2},{value:"\u4f7f\u7528 <code>state.getMeta()</code> \u4ee3\u66ff <code>state.meta</code>",id:"\u4f7f\u7528-stategetmeta-\u4ee3\u66ff-statemeta",level:3},{value:"<code>state.toStrings()</code> \u65b9\u6cd5\u5df2\u88ab\u79fb\u9664",id:"statetostrings-\u65b9\u6cd5\u5df2\u88ab\u79fb\u9664",level:3},{value:"\u4f7f\u7528 <code>state._nodes</code> \u4ee3\u66ff <code>state.configuration</code>",id:"\u4f7f\u7528-state_nodes-\u4ee3\u66ff-stateconfiguration",level:3},{value:"\u4ece\u68c0\u67e5 API \u8bfb\u53d6\u4e8b\u4ef6\uff0c\u800c\u4e0d\u662f <code>state.events</code>",id:"\u4ece\u68c0\u67e5-api-\u8bfb\u53d6\u4e8b\u4ef6\u800c\u4e0d\u662f-stateevents",level:3},{value:"\u4e8b\u4ef6\u548c\u8f6c\u6362",id:"\u4e8b\u4ef6\u548c\u8f6c\u6362",level:2},{value:"\u5b9e\u73b0\u51fd\u6570\u63a5\u6536\u5355\u4e2a\u53c2\u6570",id:"\u5b9e\u73b0\u51fd\u6570\u63a5\u6536\u5355\u4e2a\u53c2\u6570",level:3},{value:"<code>send()</code> \u5df2\u88ab\u79fb\u9664\uff1b\u8bf7\u4f7f\u7528 <code>raise()</code> \u6216 <code>sendTo()</code>",id:"send-\u5df2\u88ab\u79fb\u9664\u8bf7\u4f7f\u7528-raise-\u6216-sendto",level:3},{value:"\u4f7f\u7528 <code>enqueueActions()</code> \u4ee3\u66ff <code>pure()</code> \u548c <code>choose()</code>",id:"\u4f7f\u7528-enqueueactions-\u4ee3\u66ff-pure-\u548c-choose",level:3},{value:"<code>actor.send()</code> \u4e0d\u518d\u63a5\u53d7\u5b57\u7b26\u4e32\u7c7b\u578b",id:"actorsend-\u4e0d\u518d\u63a5\u53d7\u5b57\u7b26\u4e32\u7c7b\u578b",level:3},{value:"<code>state.can()</code> \u4e0d\u518d\u63a5\u53d7\u5b57\u7b26\u4e32\u7c7b\u578b",id:"statecan-\u4e0d\u518d\u63a5\u53d7\u5b57\u7b26\u4e32\u7c7b\u578b",level:3},{value:"\u53d7\u4fdd\u62a4\u7684\u8f6c\u6362\u4f7f\u7528 <code>guard</code>\uff0c\u800c\u4e0d\u662f <code>cond</code>",id:"\u53d7\u4fdd\u62a4\u7684\u8f6c\u6362\u4f7f\u7528-guard\u800c\u4e0d\u662f-cond",level:3},{value:"\u4f7f\u7528 <code>params</code> \u4f20\u9012\u53c2\u6570\u7ed9\u52a8\u4f5c\u548c\u5b88\u536b",id:"\u4f7f\u7528-params-\u4f20\u9012\u53c2\u6570\u7ed9\u52a8\u4f5c\u548c\u5b88\u536b",level:3},{value:"\u4f7f\u7528\u901a\u914d\u7b26 <code>*</code> \u8f6c\u6362\uff0c\u800c\u4e0d\u662f\u4e25\u683c\u6a21\u5f0f",id:"\u4f7f\u7528\u901a\u914d\u7b26--\u8f6c\u6362\u800c\u4e0d\u662f\u4e25\u683c\u6a21\u5f0f",level:3},{value:"\u4f7f\u7528\u663e\u5f0f\u7684\u65e0\u4e8b\u4ef6\uff08<code>always</code>\uff09\u8f6c\u6362",id:"\u4f7f\u7528\u663e\u5f0f\u7684\u65e0\u4e8b\u4ef6always\u8f6c\u6362",level:3},{value:"\u4f7f\u7528 <code>reenter: true</code>\uff0c\u800c\u4e0d\u662f <code>internal: false</code>",id:"\u4f7f\u7528-reenter-true\u800c\u4e0d\u662f-internal-false",level:3},{value:"\u8f6c\u6362\u9ed8\u8ba4\u662f\u5185\u90e8\u7684\uff0c\u800c\u4e0d\u662f\u5916\u90e8\u7684",id:"\u8f6c\u6362\u9ed8\u8ba4\u662f\u5185\u90e8\u7684\u800c\u4e0d\u662f\u5916\u90e8\u7684",level:3},{value:"\u5b50\u72b6\u6001\u8282\u70b9\u603b\u662f\u91cd\u65b0\u8fdb\u5165",id:"\u5b50\u72b6\u6001\u8282\u70b9\u603b\u662f\u91cd\u65b0\u8fdb\u5165",level:3},{value:"\u4f7f\u7528 <code>stateIn()</code> \u9a8c\u8bc1\u72b6\u6001\u8f6c\u6362\uff0c\u800c\u4e0d\u662f <code>in</code>",id:"\u4f7f\u7528-statein-\u9a8c\u8bc1\u72b6\u6001\u8f6c\u6362\u800c\u4e0d\u662f-in",level:3},{value:"\u4f7f\u7528 <code>actor.subscribe()</code> \u4ee3\u66ff <code>state.history</code>",id:"\u4f7f\u7528-actorsubscribe-\u4ee3\u66ff-statehistory",level:3},{value:"\u52a8\u4f5c\u53ef\u4ee5\u629b\u51fa\u9519\u8bef\u800c\u65e0\u9700 <code>escalate</code>",id:"\u52a8\u4f5c\u53ef\u4ee5\u629b\u51fa\u9519\u8bef\u800c\u65e0\u9700-escalate",level:3},{value:"Actors",id:"actors",level:2},{value:"\u4f7f\u7528 actor \u903b\u8f91\u521b\u5efa\u5668\u4ee3\u66ff\u51fd\u6570\u4f5c\u4e3a <code>invoke.src</code>",id:"\u4f7f\u7528-actor-\u903b\u8f91\u521b\u5efa\u5668\u4ee3\u66ff\u51fd\u6570\u4f5c\u4e3a-invokesrc",level:3},{value:"\u4f7f\u7528 <code>invoke.input</code> \u4ee3\u66ff <code>invoke.data</code>",id:"\u4f7f\u7528-invokeinput-\u4ee3\u66ff-invokedata",level:3},{value:"\u5728\u6700\u7ec8\u72b6\u6001\u4e2d\u4f7f\u7528 <code>output</code> \u4ee3\u66ff <code>data</code>",id:"\u5728\u6700\u7ec8\u72b6\u6001\u4e2d\u4f7f\u7528-output-\u4ee3\u66ff-data",level:3},{value:"\u4e0d\u8981\u5728 <code>input</code> \u6216 <code>output</code> \u4e2d\u4f7f\u7528\u5c5e\u6027\u6620\u5c04\u5668",id:"\u4e0d\u8981\u5728-input-\u6216-output-\u4e2d\u4f7f\u7528\u5c5e\u6027\u6620\u5c04\u5668",level:3},{value:"\u4f7f\u7528 <code>options</code> \u5bf9\u8c61\u4e0a\u7684 <code>actors</code> \u5c5e\u6027\u4ee3\u66ff <code>services</code>",id:"\u4f7f\u7528-options-\u5bf9\u8c61\u4e0a\u7684-actors-\u5c5e\u6027\u4ee3\u66ff-services",level:3},{value:"\u4f7f\u7528 <code>subscribe()</code> \u76d1\u542c\u53d8\u5316\uff0c\u800c\u4e0d\u662f <code>onTransition()</code>",id:"\u4f7f\u7528-subscribe-\u76d1\u542c\u53d8\u5316\u800c\u4e0d\u662f-ontransition",level:3},{value:"<code>createActor()</code>\uff08\u539f <code>interpret()</code>\uff09\u63a5\u53d7\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6765\u6062\u590d\u72b6\u6001",id:"createactor\u539f-interpret\u63a5\u53d7\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6765\u6062\u590d\u72b6\u6001",level:3},{value:"\u4f7f\u7528 <code>actor.getSnapshot()</code> \u83b7\u53d6\u6f14\u5458\u7684\u72b6\u6001",id:"\u4f7f\u7528-actorgetsnapshot-\u83b7\u53d6\u6f14\u5458\u7684\u72b6\u6001",level:3},{value:"\u904d\u5386\u4e8b\u4ef6\u800c\u4e0d\u662f\u4f7f\u7528 <code>actor.batch()</code>",id:"\u904d\u5386\u4e8b\u4ef6\u800c\u4e0d\u662f\u4f7f\u7528-actorbatch",level:3},{value:"\u4f7f\u7528 <code>snapshot.status === &#39;done&#39;</code> \u4ee3\u66ff <code>snapshot.done</code>",id:"\u4f7f\u7528-snapshotstatus--done-\u4ee3\u66ff-snapshotdone",level:3},{value:"<code>state.nextEvents</code> \u5df2\u88ab\u79fb\u9664",id:"statenextevents-\u5df2\u88ab\u79fb\u9664",level:3},{value:"TypeScript",id:"typescript",level:2},{value:"\u4f7f\u7528 <code>types</code> \u4ee3\u66ff <code>schema</code>",id:"\u4f7f\u7528-types-\u4ee3\u66ff-schema",level:3},{value:"\u4f7f\u7528 <code>types.typegen</code> \u4ee3\u66ff <code>tsTypes</code>",id:"\u4f7f\u7528-typestypegen-\u4ee3\u66ff-tstypes",level:3},{value:"<code>@xstate/react</code>",id:"xstatereact",level:2},{value:"<code>useInterpret()</code> \u73b0\u5728\u662f <code>useActorRef()</code>",id:"useinterpret-\u73b0\u5728\u662f-useactorref",level:3},{value:"<code>useActor(logic)</code> \u73b0\u5728\u63a5\u53d7 actor \u903b\u8f91\uff0c\u800c\u4e0d\u662f actor",id:"useactorlogic-\u73b0\u5728\u63a5\u53d7-actor-\u903b\u8f91\u800c\u4e0d\u662f-actor",level:3},{value:"\u4f7f\u7528 <code>machine.provide()</code> \u5728\u94a9\u5b50\u4e2d\u63d0\u4f9b\u5b9e\u73b0",id:"\u4f7f\u7528-machineprovide-\u5728\u94a9\u5b50\u4e2d\u63d0\u4f9b\u5b9e\u73b0",level:2},{value:"<code>@xstate/vue</code>",id:"xstatevue",level:2},{value:"<code>useMachine()</code> \u73b0\u5728\u8fd4\u56de <code>snapshot</code> \u800c\u4e0d\u662f <code>state</code>\uff0c\u5e76\u8fd4\u56de <code>actor</code> \u800c\u4e0d\u662f <code>service</code>",id:"usemachine-\u73b0\u5728\u8fd4\u56de-snapshot-\u800c\u4e0d\u662f-state\u5e76\u8fd4\u56de-actor-\u800c\u4e0d\u662f-service",level:3},{value:"\u65b0\u529f\u80fd",id:"\u65b0\u529f\u80fd",level:2},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"Stately Studio \u4f55\u65f6\u4f1a\u517c\u5bb9 XState v5\uff1f",id:"stately-studio-\u4f55\u65f6\u4f1a\u517c\u5bb9-xstate-v5",level:3},{value:"XState VS Code \u6269\u5c55\u4f55\u65f6\u4f1a\u517c\u5bb9 XState v5\uff1f",id:"xstate-vs-code-\u6269\u5c55\u4f55\u65f6\u4f1a\u517c\u5bb9-xstate-v5",level:3},{value:"XState v5 \u4f55\u65f6\u4f1a\u6709 typegen\uff1f",id:"xstate-v5-\u4f55\u65f6\u4f1a\u6709-typegen",level:3},{value:"\u5982\u4f55\u540c\u65f6\u4f7f\u7528 XState v4 \u548c v5\uff1f",id:"\u5982\u4f55\u540c\u65f6\u4f7f\u7528-xstate-v4-\u548c-v5",level:3}];function o(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.a)(),...e.components},{TabItem:t,Tabs:a}=n;return t||x("TabItem",!0),a||x("Tabs",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["\u4e0b\u9762\u7684\u6307\u5357\u89e3\u91ca\u4e86\u5982\u4f55\u4ece XState \u7248\u672c 4 \u8fc1\u79fb\u5230\u7248\u672c 5\u3002\u4ece XState v4 \u8fc1\u79fb\u5230 v5 \u5e94\u8be5\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8fc7\u7a0b\u3002\u5982\u679c\u60a8\u9047\u5230\u56f0\u96be\u6216\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u8bf7\u901a\u8fc7 ",(0,s.jsx)(n.a,{href:"https://discord.gg/xstate",children:"\u6211\u4eec\u7684 Discord"})," \u8054\u7cfb Stately \u56e2\u961f\u3002"]}),"\n",(0,s.jsx)(n.admonition,{type:"new",children:(0,s.jsxs)(n.p,{children:["\u9605\u8bfb ",(0,s.jsx)(n.a,{href:"/blog/2023-12-01-xstate-v5",children:"David \u5173\u4e8e XState v5 \u53d1\u5e03\u7684\u535a\u5ba2\u6587\u7ae0"}),"\u3002"]})}),"\n",(0,s.jsx)(n.p,{children:"\u672c\u6307\u5357\u9002\u7528\u4e8e\u5e0c\u671b\u5c06\u4ee3\u7801\u5e93\u4ece v4 \u66f4\u65b0\u5230 v5 \u7684\u5f00\u53d1\u4eba\u5458\uff0c\u4e5f\u9002\u7528\u4e8e\u4efb\u4f55\u5e0c\u671b\u4e86\u89e3 v4 \u548c v5 \u4e4b\u95f4\u5dee\u5f02\u7684\u5f00\u53d1\u4eba\u5458\u3002"}),"\n",(0,s.jsx)(n.admonition,{type:"video",children:(0,s.jsxs)(n.p,{children:["\u559c\u6b22\u89c6\u9891\uff1f",(0,s.jsx)(n.a,{href:"https://www.youtube.com/live/TRVjeil-y74",children:"\u89c2\u770b\u6211\u4eec\u5728 YouTube \u4e0a\u7684 XState v5 \u7f51\u7edc\u7814\u8ba8\u4f1a"}),"\u3002"]})}),"\n",(0,s.jsx)(n.h2,{id:"xstate-v5-\u548c-typescript",children:"XState v5 \u548c TypeScript"}),"\n",(0,s.jsxs)(n.p,{children:["XState v5 \u53ca\u5176\u76f8\u5173\u5e93\u662f\u7528 TypeScript \u7f16\u5199\u7684\uff0c\u5e76\u5229\u7528\u590d\u6742\u7684\u7c7b\u578b\u4e3a\u60a8\u63d0\u4f9b\u6700\u4f73\u7684\u7c7b\u578b\u5b89\u5168\u6027\u548c\u63a8\u65ad\u80fd\u529b\u3002",(0,s.jsx)(n.strong,{children:"XState v5 \u9700\u8981 TypeScript \u7248\u672c 5.0 \u6216\u66f4\u9ad8\u7248\u672c\u3002"})," \u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u6548\u679c\uff0c\u8bf7\u4f7f\u7528\u6700\u65b0\u7684 TypeScript \u7248\u672c\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u8bf7\u9075\u5faa\u4ee5\u4e0b\u6307\u5357\u4ee5\u786e\u4fdd\u60a8\u7684 TypeScript \u9879\u76ee\u51c6\u5907\u597d\u4f7f\u7528 XState v5\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u4f7f\u7528\u6700\u65b0\u7248\u672c\u7684 TypeScript\uff0c\u7248\u672c 5.0 \u6216\u66f4\u9ad8\uff08\u5fc5\u9700\uff09"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install typescript@latest --save-dev\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["\u5728\u60a8\u7684 ",(0,s.jsx)(n.code,{children:"tsconfig.json"})," \u6587\u4ef6\u4e2d\u5c06 ",(0,s.jsx)(n.a,{href:"https://www.typescriptlang.org/tsconfig#strictNullChecks",children:(0,s.jsx)(n.code,{children:"strictNullChecks"})})," \u8bbe\u7f6e\u4e3a ",(0,s.jsx)(n.code,{children:"true"}),"\u3002\u8fd9\u5c06\u786e\u4fdd\u6211\u4eec\u7684\u7c7b\u578b\u6b63\u5e38\u5de5\u4f5c\uff0c\u5e76\u6709\u52a9\u4e8e\u6355\u6349\u4ee3\u7801\u4e2d\u7684\u9519\u8bef\uff08\u5f3a\u70c8\u63a8\u8350\uff09"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json5",children:'// tsconfig.json\n{\n  "compilerOptions": {\n    // ...\n    // highlight-next-line\n    "strictNullChecks": true\n    // \u6216\u5c06 `strict` \u8bbe\u7f6e\u4e3a true\uff0c\u8fd9\u5305\u62ec `strictNullChecks`\n    // "strict": true\n  }\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["\u5728\u60a8\u7684 ",(0,s.jsx)(n.code,{children:"tsconfig.json"})," \u6587\u4ef6\u4e2d\u5c06 ",(0,s.jsx)(n.a,{href:"https://www.typescriptlang.org/tsconfig#skipLibCheck",children:(0,s.jsx)(n.code,{children:"skipLibCheck"})})," \u8bbe\u7f6e\u4e3a ",(0,s.jsx)(n.code,{children:"true"}),"\uff08\u63a8\u8350\uff09"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u521b\u5efa\u673a\u5668\u548c\u6f14\u5458",children:"\u521b\u5efa\u673a\u5668\u548c\u6f14\u5458"}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-createmachine\u800c\u4e0d\u662f-machine",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"createMachine()"}),"\uff0c\u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"Machine()"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Machine(config)"})," \u51fd\u6570\u73b0\u5728\u79f0\u4e3a ",(0,s.jsx)(n.code,{children:"createMachine(config)"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { createMachine } from 'xstate';\n\nconst machine = createMachine({\n  // ...\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nimport { Machine } from 'xstate';\n\nconst machine = Machine({\n  // ...\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-createactor\u800c\u4e0d\u662f-interpret",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"createActor()"}),"\uff0c\u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"interpret()"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"interpret()"})," \u51fd\u6570\u5df2\u91cd\u547d\u540d\u4e3a ",(0,s.jsx)(n.code,{children:"createActor()"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { createMachine, createActor } from 'xstate';\n\nconst machine = createMachine(/* ... */);\n\n// \u2705\nconst actor = createActor(machine, {\n  // actor \u9009\u9879\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { createMachine, interpret } from 'xstate';\n\nconst machine = createMachine(/* ... */);\n\n// \u274c \u5df2\u5f03\u7528\nconst actor = interpret(machine, {\n  // actor \u9009\u9879\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-machineprovide\u800c\u4e0d\u662f-machinewithconfig",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"machine.provide()"}),"\uff0c\u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"machine.withConfig()"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"machine.withConfig()"})," \u65b9\u6cd5\u5df2\u91cd\u547d\u540d\u4e3a ",(0,s.jsx)(n.code,{children:"machine.provide()"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst specificMachine = machine.provide({\n  actions: {\n    /* ... */\n  },\n  guards: {\n    /* ... */\n  },\n  actors: {\n    /* ... */\n  },\n  // ...\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst specificMachine = machine.withConfig({\n  actions: {\n    /* ... */\n  },\n  guards: {\n    /* ... */\n  },\n  services: {\n    /* ... */\n  },\n  // ...\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-input-\u8bbe\u7f6e\u4e0a\u4e0b\u6587\u800c\u4e0d\u662f-machinewithcontext",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"input"})," \u8bbe\u7f6e\u4e0a\u4e0b\u6587\uff0c\u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"machine.withContext()"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"machine.withContext(...)"})," \u65b9\u6cd5\u4e0d\u80fd\u518d\u4f7f\u7528\uff0c\u56e0\u4e3a ",(0,s.jsx)(n.code,{children:"context"})," \u4e0d\u80fd\u518d\u76f4\u63a5\u8986\u76d6\u3002\u8bf7\u6539\u7528 ",(0,s.jsx)(n.a,{href:"/xstate-zh/docs/input",children:"input"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  context: ({ input }) => ({\n    actualMoney: Math.min(input.money, 42),\n  }),\n});\n\nconst actor = createActor(machine, {\n  input: {\n    money: 1000,\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  context: {\n    actualMoney: 0,\n  },\n});\n\nconst moneyMachine = machine.withContext({\n  actualMoney: 1000,\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u52a8\u4f5c\u9ed8\u8ba4\u6309\u987a\u5e8f\u6267\u884c\u4e0d\u518d\u9700\u8981-predictableactionarguments",children:["\u52a8\u4f5c\u9ed8\u8ba4\u6309\u987a\u5e8f\u6267\u884c\uff0c\u4e0d\u518d\u9700\u8981 ",(0,s.jsx)(n.code,{children:"predictableActionArguments"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u52a8\u4f5c\u73b0\u5728\u9ed8\u8ba4\u6309\u987a\u5e8f\u6267\u884c\uff0c\u56e0\u6b64\u4e0d\u518d\u9700\u8981 ",(0,s.jsx)(n.code,{children:"predictableActionArguments"})," \u6807\u5fd7\u3002\u5206\u914d\u52a8\u4f5c\u5c06\u59cb\u7ec8\u6309\u5b9a\u4e49\u7684\u987a\u5e8f\u8fd0\u884c\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  entry: [\n    ({ context }) => {\n      console.log(context.count); // 0\n    },\n    assign({ count: 1 }),\n    ({ context }) => {\n      console.log(context.count); // 1\n    },\n    assign({ count: 2 }),\n    ({ context }) => {\n      console.log(context.count); // 2\n    },\n  ],\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  predictableActionArguments: true,\n  entry: [\n    (context) => {\n      console.log(context.count); // 0\n    },\n    assign({ count: 1 }),\n    (context) => {\n      console.log(context.count); // 1\n    },\n    assign({ count: 2 }),\n    (context) => {\n      console.log(context.count); // 2\n    },\n  ],\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"spawn-\u51fd\u6570\u5df2\u88ab\u79fb\u9664",children:[(0,s.jsx)(n.code,{children:"spawn()"})," \u51fd\u6570\u5df2\u88ab\u79fb\u9664"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0d\u518d\u4f7f\u7528\u5bfc\u5165\u7684 ",(0,s.jsx)(n.code,{children:"spawn()"})," \u51fd\u6570\u5728 ",(0,s.jsx)(n.code,{children:"assign(...)"})," \u52a8\u4f5c\u4e2d\u521b\u5efa\u6f14\u5458\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"spawnChild(...)"})," \u52a8\u4f5c\u521b\u5efa\u5668\uff08\u9996\u9009\uff09"]}),"\n",(0,s.jsxs)(n.li,{children:["\u6216\u8005\u5728 ",(0,s.jsx)(n.code,{children:"assign(...)"})," \u52a8\u4f5c\u4e2d\u4f7f\u7528\u4f20\u9012\u7ed9\u5206\u914d\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e2d\u7684 ",(0,s.jsx)(n.code,{children:"spawn(...)"})," \u65b9\u6cd5\uff08\u5982\u679c\u9700\u8981\u5728 ",(0,s.jsx)(n.code,{children:"context"})," \u4e2d\u4f7f\u7528\u6f14\u5458\u5f15\u7528\uff09"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u9605\u8bfb\u6709\u5173",(0,s.jsx)(n.a,{href:"/xstate-zh/docs/spawn",children:"\u751f\u6210\u6f14\u5458"}),"\u7684\u6587\u6863\u4ee5\u83b7\u53d6\u66f4\u591a\u4fe1\u606f\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\n// highlight-next-line\nimport { spawnChild, assign } from 'xstate';\n\n// \u751f\u6210\u4e00\u4e2a\u76f4\u63a5\u5b50\u6f14\u5458\uff1a\nconst machine1 = createMachine({\n  // ...\n  // highlight-start\n  entry: spawnChild('someChildLogic', {\n    id: 'someChild',\n  })\n  // highlight-end\n});\n\n// \u751f\u6210\u4e00\u4e2a\u5728 [`context`](command:_github.copilot.openSymbolFromReferences?%5B%22%22%2C%5B%7B%22uri%22%3A%7B%22scheme%22%3A%22file%22%2C%22authority%22%3A%22%22%2C%22path%22%3A%22%2FD%3A%2FDOC%2Fxstate-doc%2Fdocs%2Fmigration.mdx%22%2C%22query%22%3A%22%22%2C%22fragment%22%3A%22%22%7D%2C%22pos%22%3A%7B%22line%22%3A216%2C%22character%22%3A2%7D%7D%5D%2C%221e3bedd9-7dd0-41fd-9f83-d76e3d7b4562%22%5D \"Go to definition\") \u4e2d\u6709\u6f14\u5458\u5f15\u7528\u7684\u5b50\u6f14\u5458\uff1a\nconst machine2 = createMachine({\n  // ...\n  entry: assign({\n    // highlight-next-line\n    child: ({ spawn }) => spawn('someChildLogic')\n  })\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c\nimport { assign, spawn } from 'xstate';\n\nconst machine = createMachine({\n  // ...\n  entry: assign({\n    // highlight-next-line\n    child: () => spawn('someChildLogic')\n  })\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-getnextsnapshot-\u4ee3\u66ff-machinetransition",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"getNextSnapshot(\u2026)"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"machine.transition(\u2026)"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"machine.transition(\u2026)"})," \u65b9\u6cd5\u73b0\u5728\u9700\u8981\u4e00\u4e2a\u201c\u6f14\u5458\u8303\u56f4\u201d\u4f5c\u4e3a\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u7531 ",(0,s.jsx)(n.code,{children:"createActor(\u2026)"})," \u5185\u90e8\u521b\u5efa\u3002\u76f8\u53cd\uff0c\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"getNextSnapshot(\u2026)"})," \u6839\u636e\u5f53\u524d\u5feb\u7167\u548c\u4e8b\u4ef6\u4ece\u67d0\u4e9b\u6f14\u5458\u903b\u8f91\u4e2d\u83b7\u53d6\u4e0b\u4e00\u4e2a\u5feb\u7167\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nimport {\n  createMachine,\n  // highlight-next-line\n  getNextSnapshot\n} from 'xstate';\n\nconst machine = createMachine({\n  // ...\n});\n\n// highlight-start\nconst nextState = getNextSnapshot(\n  machine,\n  machine.resolveState({ value: 'green' }),\n  { type: 'timer' }\n);\n// highlight-end\n\nnextState.value; // yellow\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c\nimport { createMachine } from 'xstate';\n\nconst machine = createMachine({\n  // ...\n});\n\nconst nextState = machine.transition(\n  'green',\n  { type: 'timer' }\n);\n\nnextState.value; // yellow\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u663e\u5f0f\u53d1\u9001\u4e8b\u4ef6\u800c\u4e0d\u662f\u4f7f\u7528-autoforward",children:["\u663e\u5f0f\u53d1\u9001\u4e8b\u4ef6\u800c\u4e0d\u662f\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"autoForward"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"autoForward"})," \u5c5e\u6027\u5728\u8c03\u7528\u914d\u7f6e\u4e2d\u5df2\u88ab\u79fb\u9664\u3002\u76f8\u53cd\uff0c\u8bf7\u663e\u5f0f\u53d1\u9001\u4e8b\u4ef6\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u901a\u5e38\uff0c\u4e0d\u63a8\u8350\u5c06\u6240\u6709\u4e8b\u4ef6\u8f6c\u53d1\u7ed9\u6f14\u5458\u3002\u76f8\u53cd\uff0c\u53ea\u8f6c\u53d1\u6f14\u5458\u9700\u8981\u7684\u7279\u5b9a\u4e8b\u4ef6\u3002"}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  // ...\n  invoke: {\n    src: 'someSource',\n    id: 'someId'\n  },\n  // highlight-start\n  always: {\n    // \u5c06\u4e8b\u4ef6\u8f6c\u53d1\u7ed9\u88ab\u8c03\u7528\u7684\u6f14\u5458\n    // \u8fd9\u5728 XState v5 \u4e2d\u4e0d\u4f1a\u5bfc\u81f4\u65e0\u9650\u5faa\u73af\n    actions: sendTo('someId', ({ event }) => event)\n  }\n  // highlight-end\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c\nconst machine = createMachine({\n  // ...\n  invoke: {\n    src: 'someSource',\n    id: 'someId'\n    // highlight-next-line\n    autoForward: true // deprecated\n  }\n});\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"\u72b6\u6001",children:"\u72b6\u6001"}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-stategetmeta-\u4ee3\u66ff-statemeta",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"state.getMeta()"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"state.meta"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"state.meta"})," \u5c5e\u6027\u5df2\u91cd\u547d\u540d\u4e3a ",(0,s.jsx)(n.code,{children:"state.getMeta()"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nstate.getMeta();\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nstate.meta;\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"statetostrings-\u65b9\u6cd5\u5df2\u88ab\u79fb\u9664",children:[(0,s.jsx)(n.code,{children:"state.toStrings()"})," \u65b9\u6cd5\u5df2\u88ab\u79fb\u9664"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { type StateValue } from 'xstate';\n\nexport function getStateValueStrings(stateValue: StateValue): string[] {\n  if (typeof stateValue === 'string') {\n    return [stateValue];\n  }\n  const valueKeys = Object.keys(stateValue);\n\n  return valueKeys.concat(\n    ...valueKeys.map((key) =>\n      getStateValueStrings(stateValue[key]!).map((s) => key + '.' + s)\n    )\n  );\n}\n\n// ...\n\nconst stateValueStrings = getStateValueStrings(stateValue);\n// \u4f8b\u5982 ['green', 'yellow', 'red', 'red.walk', 'red.wait', \u2026]\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-state_nodes-\u4ee3\u66ff-stateconfiguration",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"state._nodes"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"state.configuration"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"state.configuration"})," \u5c5e\u6027\u5df2\u91cd\u547d\u540d\u4e3a ",(0,s.jsx)(n.code,{children:"state._nodes"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nstate._nodes;\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nstate.configuration;\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4ece\u68c0\u67e5-api-\u8bfb\u53d6\u4e8b\u4ef6\u800c\u4e0d\u662f-stateevents",children:["\u4ece\u68c0\u67e5 API \u8bfb\u53d6\u4e8b\u4ef6\uff0c\u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"state.events"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"state.events"})," \u5c5e\u6027\u5df2\u88ab\u79fb\u9664\uff0c\u56e0\u4e3a\u4e8b\u4ef6\u4e0d\u662f\u72b6\u6001\u7684\u4e00\u90e8\u5206\uff0c\u9664\u975e\u60a8\u660e\u786e\u5c06\u5b83\u4eec\u6dfb\u52a0\u5230\u72b6\u6001\u7684 ",(0,s.jsx)(n.code,{children:"context"})," \u4e2d\u3002\u8bf7\u4f7f\u7528 ",(0,s.jsx)(n.a,{href:"/xstate-zh/docs/inspection",children:"\u68c0\u67e5 API"})," \u6765\u89c2\u5bdf\u4e8b\u4ef6\uff0c\u6216\u8005\u5c06\u4e8b\u4ef6\u660e\u786e\u6dfb\u52a0\u5230\u72b6\u6001\u7684 ",(0,s.jsx)(n.code,{children:"context"})," \u4e2d\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nimport { createActor } from 'xstate';\nimport { someMachine } from './someMachine';\n\nconst actor = createActor(someMachine, {\n  // highlight-start\n  inspect: (inspEvent) => {\n    if (inspEvent.type === '@xstate.event') {\n      console.log(inspEvent.event);\n    }\n  }\n  // highlight-end\n});\n"})})}),(0,s.jsx)(t,{value:"v5-alt",label:"XState v5 (context)",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nimport { setup, createActor } from 'xstate';\n\nconst someMachine = setup({\n  // ...\n  actions: {\n    // highlight-start\n    recordEvent: assign({\n      event: ({ event }) => event\n    })\n    // highlight-end\n  }\n}).createMachine({\n  context: { event: undefined },\n  on: {\n    someEvent: {\n      // ...\n      // highlight-next-line\n      actions: ['recordEvent']\n    }\n  }\n});\n\nconst someActor = createActor(someMachine);\nsomeActor.subscribe(snapshot => {\n  // highlight-next-line\n  console.log(snapshot.context.event);\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nimport { interpret } from 'xstate';\nimport { someMachine } from './someMachine';\n\nconst actor = interpret(someMachine);\nactor.subscribe(state => {\n  // highlight-next-line\n  console.log(state.event); // Removed\n});\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"\u4e8b\u4ef6\u548c\u8f6c\u6362",children:"\u4e8b\u4ef6\u548c\u8f6c\u6362"}),"\n",(0,s.jsx)(n.h3,{id:"\u5b9e\u73b0\u51fd\u6570\u63a5\u6536\u5355\u4e2a\u53c2\u6570",children:"\u5b9e\u73b0\u51fd\u6570\u63a5\u6536\u5355\u4e2a\u53c2\u6570"}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5b9e\u73b0\u51fd\u6570\u73b0\u5728\u63a5\u6536\u4e00\u4e2a\u5355\u4e00\u53c2\u6570\uff1a\u4e00\u4e2a\u5305\u542b ",(0,s.jsx)(n.code,{children:"context"}),"\u3001",(0,s.jsx)(n.code,{children:"event"})," \u548c\u5176\u4ed6\u5c5e\u6027\u7684\u5bf9\u8c61\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  entry: ({ context, event }) => {\n    // ...\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  entry: (context, event) => {\n    // ...\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"send-\u5df2\u88ab\u79fb\u9664\u8bf7\u4f7f\u7528-raise-\u6216-sendto",children:[(0,s.jsx)(n.code,{children:"send()"})," \u5df2\u88ab\u79fb\u9664\uff1b\u8bf7\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"raise()"})," \u6216 ",(0,s.jsx)(n.code,{children:"sendTo()"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"send(...)"})," \u52a8\u4f5c\u521b\u5efa\u5668\u5df2\u88ab\u79fb\u9664\u3002\u8bf7\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"raise(...)"})," \u53d1\u9001\u4e8b\u4ef6\u7ed9\u81ea\u5df1\uff0c\u6216\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"sendTo(...)"})," \u53d1\u9001\u4e8b\u4ef6\u7ed9\u5176\u4ed6\u6f14\u5458\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u9605\u8bfb\u6709\u5173 ",(0,s.jsxs)(n.a,{href:"/xstate-zh/docs/actions#send-to-action",children:[(0,s.jsx)(n.code,{children:"sendTo"})," \u52a8\u4f5c"]})," \u548c ",(0,s.jsxs)(n.a,{href:"/xstate-zh/docs/actions#raise-action",children:[(0,s.jsx)(n.code,{children:"raise"})," \u52a8\u4f5c"]})," \u7684\u6587\u6863\u4ee5\u83b7\u53d6\u66f4\u591a\u4fe1\u606f\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  // ...\n  entry: [\n    // Send an event to self\n    raise({ type: 'someEvent' }),\n\n    // Send an event to another actor\n    sendTo('someActor', { type: 'someEvent' }),\n  ],\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  // ...\n  entry: [\n    // Send an event to self\n    send({ type: 'someEvent' }),\n\n    // Send an event to another actor\n    send({ type: 'someEvent' }, { to: 'someActor' }),\n  ],\n});\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8fc1\u79fb\u524d\u63d0\u793a\uff1a"})," \u66f4\u65b0 v4 \u9879\u76ee\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"sendTo"})," \u6216 ",(0,s.jsx)(n.code,{children:"raise"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"send"}),"\u3002"]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-enqueueactions-\u4ee3\u66ff-pure-\u548c-choose",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"enqueueActions()"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"pure()"})," \u548c ",(0,s.jsx)(n.code,{children:"choose()"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"pure()"})," \u548c ",(0,s.jsx)(n.code,{children:"choose()"})," \u65b9\u6cd5\u5df2\u88ab\u79fb\u9664\u3002\u8bf7\u6539\u7528 ",(0,s.jsx)(n.code,{children:"enqueueActions()"}),"\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5bf9\u4e8e ",(0,s.jsx)(n.code,{children:"pure()"})," \u52a8\u4f5c\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nentry: [\n  enqueueActions(({ context, event, enqueue }) => {\n    enqueue('action1');\n    enqueue('action2');\n  })\n];\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nentry: [\n  pure(() => {\n    return [\n      'action1',\n      'action2'\n    ]\n  })\n];\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["\u5bf9\u4e8e ",(0,s.jsx)(n.code,{children:"choose()"})," \u52a8\u4f5c\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nentry: [\n  enqueueActions(({ enqueue, check }) => {\n    if (check('someGuard')) {\n      enqueue('action1');\n      enqueue('action2');\n    }\n  })\n];\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nentry: [\n  choose([\n    {\n      guard: 'someGuard',\n      actions: ['action1', 'action2']\n    }\n  ]),\n];\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"actorsend-\u4e0d\u518d\u63a5\u53d7\u5b57\u7b26\u4e32\u7c7b\u578b",children:[(0,s.jsx)(n.code,{children:"actor.send()"})," \u4e0d\u518d\u63a5\u53d7\u5b57\u7b26\u4e32\u7c7b\u578b"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5b57\u7b26\u4e32\u4e8b\u4ef6\u7c7b\u578b\u4e0d\u518d\u53ef\u4ee5\u53d1\u9001\uff0c\u4f8b\u5982 ",(0,s.jsx)(n.code,{children:"actor.send(event)"}),"\uff1b\u60a8\u5fc5\u987b\u53d1\u9001\u4e00\u4e2a\u4e8b\u4ef6\u5bf9\u8c61\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nactor.send({ type: 'someEvent' });\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nactor.send('someEvent');\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8fc1\u79fb\u524d\u63d0\u793a\uff1a"})," \u66f4\u65b0 v4 \u9879\u76ee\u4ee5\u4f20\u9012\u5bf9\u8c61\u7ed9 ",(0,s.jsx)(n.code,{children:".send()"}),"\u3002"]}),"\n",(0,s.jsxs)(n.h3,{id:"statecan-\u4e0d\u518d\u63a5\u53d7\u5b57\u7b26\u4e32\u7c7b\u578b",children:[(0,s.jsx)(n.code,{children:"state.can()"})," \u4e0d\u518d\u63a5\u53d7\u5b57\u7b26\u4e32\u7c7b\u578b"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5b57\u7b26\u4e32\u4e8b\u4ef6\u7c7b\u578b\u4e0d\u518d\u53ef\u4ee5\u53d1\u9001\uff0c\u4f8b\u5982 ",(0,s.jsx)(n.code,{children:"state.can(event)"}),"\uff1b\u60a8\u5fc5\u987b\u53d1\u9001\u4e00\u4e2a\u4e8b\u4ef6\u5bf9\u8c61\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nstate.can({ type: 'someEvent' });\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nstate.can('someEvent');\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u53d7\u4fdd\u62a4\u7684\u8f6c\u6362\u4f7f\u7528-guard\u800c\u4e0d\u662f-cond",children:["\u53d7\u4fdd\u62a4\u7684\u8f6c\u6362\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"guard"}),"\uff0c\u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"cond"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53d7\u4fdd\u62a4\u8f6c\u6362\u7684 ",(0,s.jsx)(n.code,{children:"cond"})," \u5c5e\u6027\u73b0\u5728\u79f0\u4e3a ",(0,s.jsx)(n.code,{children:"guard"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  on: {\n    someEvent: {\n      guard: 'someGuard',\n      target: 'someState',\n    },\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  on: {\n    someEvent: {\n      // renamed to `guard` in v5\n      cond: 'someGuard',\n      target: 'someState',\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-params-\u4f20\u9012\u53c2\u6570\u7ed9\u52a8\u4f5c\u548c\u5b88\u536b",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"params"})," \u4f20\u9012\u53c2\u6570\u7ed9\u52a8\u4f5c\u548c\u5b88\u536b"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u52a8\u4f5c\u5bf9\u8c61\u548c\u5b88\u536b\u5bf9\u8c61\u4e2d\u9664\u4e86 ",(0,s.jsx)(n.code,{children:"type"})," \u4e4b\u5916\u7684\u5c5e\u6027\u5e94\u8be5\u5d4c\u5957\u5728 ",(0,s.jsx)(n.code,{children:"params"})," \u5c5e\u6027\u4e0b\uff1b",(0,s.jsx)(n.code,{children:"{ type: 'someType', message: 'hello' }"})," \u53d8\u4e3a ",(0,s.jsx)(n.code,{children:"{ type: 'someType', params: { message: 'hello' }}"}),"\u3002\u8fd9\u4e9b ",(0,s.jsx)(n.code,{children:"params"})," \u7136\u540e\u4f1a\u4f5c\u4e3a\u52a8\u4f5c\u6216\u5b88\u536b\u5b9e\u73b0\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4f20\u9012\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  entry: {\n    type: 'greet',\n    params: {\n      message: 'Hello world',\n    },\n  },\n  on: {\n    someEvent: {\n      guard: { type: 'isGreaterThan', params: { value: 42 } },\n    },\n  },\n}).provide({\n  actions: {\n    greet: ({ context, event }, params) => {\n      console.log(params.message); // 'Hello world'\n    },\n  },\n  guards: {\n    isGreaterThan: ({ context, event }, params) => {\n      return event.value > params.value;\n    },\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine(\n  {\n    entry: {\n      type: 'greet',\n      message: 'Hello world',\n    },\n    on: {\n      someEvent: {\n        cond: { type: 'isGreaterThan', value: 42 },\n      },\n    },\n  },\n  {\n    actions: {\n      greet: (context, event, { action }) => {\n        console.log(action.message); // 'Hello world'\n      },\n    },\n    guards: {\n      isGreaterThan: (context, event, { guard }) => {\n        return event.value > guard.value;\n      },\n    },\n  },\n);\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8fc1\u79fb\u524d\u63d0\u793a\uff1a"})," \u66f4\u65b0 v4 \u9879\u76ee\u4e2d\u7684\u52a8\u4f5c\u548c\u5b88\u536b\u5bf9\u8c61\uff0c\u5c06 ",(0,s.jsx)(n.code,{children:"type"})," \u4e4b\u5916\u7684\u5c5e\u6027\u79fb\u52a8\u5230 ",(0,s.jsx)(n.code,{children:"params"})," \u5bf9\u8c61\u4e2d\u3002"]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528\u901a\u914d\u7b26--\u8f6c\u6362\u800c\u4e0d\u662f\u4e25\u683c\u6a21\u5f0f",children:["\u4f7f\u7528\u901a\u914d\u7b26 ",(0,s.jsx)(n.code,{children:"*"})," \u8f6c\u6362\uff0c\u800c\u4e0d\u662f\u4e25\u683c\u6a21\u5f0f"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e25\u683c\u6a21\u5f0f\u5df2\u88ab\u79fb\u9664\u3002\u5982\u679c\u60a8\u5e0c\u671b\u5728\u672a\u5904\u7406\u7684\u4e8b\u4ef6\u4e0a\u629b\u51fa\u9519\u8bef\uff0c\u60a8\u5e94\u8be5\u4f7f\u7528\u901a\u914d\u7b26\u8f6c\u6362\uff1a"}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  on: {\n    knownEvent: {\n      // ...\n    },\n    // highlight-start\n    '*': {\n      // unknown event\n      actions: ({ event }) => {\n        throw new Error(`Unknown event: ${event.type}`);\n      },\n    },\n    // highlight-end\n  },\n});\n\nconst actor = createActor(machine);\n\nactor.subscribe({\n  // highlight-start\n  error: (err) => {\n    console.error(err);\n  }\n  // highlight-end\n});\n\nactor.start();\n\nactor.send({ type: 'unknownEvent' });\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  strict: true,\n  on: {\n    knownEvent: {\n      // ...\n    },\n  },\n});\n\nconst service = interpret(machine);\n\nservice.send({ type: 'unknownEvent' });\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528\u663e\u5f0f\u7684\u65e0\u4e8b\u4ef6always\u8f6c\u6362",children:["\u4f7f\u7528\u663e\u5f0f\u7684\u65e0\u4e8b\u4ef6\uff08",(0,s.jsx)(n.code,{children:"always"}),"\uff09\u8f6c\u6362"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u65e0\u4e8b\u4ef6\uff08\u201calways\u201d\uff09\u8f6c\u6362\u73b0\u5728\u5fc5\u987b\u901a\u8fc7\u72b6\u6001\u8282\u70b9\u7684 ",(0,s.jsx)(n.code,{children:"always: { ... }"})," \u5c5e\u6027\u5b9a\u4e49\uff1b\u5b83\u4eec\u4e0d\u80fd\u518d\u901a\u8fc7\u7a7a\u5b57\u7b26\u4e32\u5b9a\u4e49\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  // ...\n  states: {\n    someState: {\n      always: {\n        target: 'anotherState',\n      },\n    },\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  // ...\n  states: {\n    someState: {\n      on: {\n        '': {\n          target: 'anotherState',\n        },\n      },\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8fc1\u79fb\u524d\u63d0\u793a\uff1a"})," \u66f4\u65b0 v4 \u9879\u76ee\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"always"})," \u8fdb\u884c\u65e0\u4e8b\u4ef6\u8f6c\u6362\u3002"]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-reenter-true\u800c\u4e0d\u662f-internal-false",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"reenter: true"}),"\uff0c\u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"internal: false"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"internal: false"})," \u73b0\u5728\u662f ",(0,s.jsx)(n.code,{children:"reenter: true"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u4ee5\u524d\u7528 ",(0,s.jsx)(n.code,{children:"internal: false"})," \u6307\u5b9a\u7684\u5916\u90e8\u8f6c\u6362\u73b0\u5728\u7528 ",(0,s.jsx)(n.code,{children:"reenter: true"})," \u6307\u5b9a\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  // ...\n  on: {\n    someEvent: {\n      target: 'sameState',\n      reenter: true,\n    },\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  // ...\n  on: {\n    someEvent: {\n      target: 'sameState',\n      internal: false,\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"\u8f6c\u6362\u9ed8\u8ba4\u662f\u5185\u90e8\u7684\u800c\u4e0d\u662f\u5916\u90e8\u7684",children:"\u8f6c\u6362\u9ed8\u8ba4\u662f\u5185\u90e8\u7684\uff0c\u800c\u4e0d\u662f\u5916\u90e8\u7684"}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6240\u6709\u8f6c\u6362\u9ed8\u8ba4\u662f",(0,s.jsx)(n.strong,{children:"\u5185\u90e8\u7684"}),"\u3002\u6b64\u66f4\u6539\u4e0e\u5728\u72b6\u6001\u8282\u70b9\u4e0a\u5b9a\u4e49\u7684\u8f6c\u6362\u76f8\u5173\uff0c\u8fd9\u4e9b\u72b6\u6001\u8282\u70b9\u5177\u6709 ",(0,s.jsx)(n.code,{children:"entry"})," \u6216 ",(0,s.jsx)(n.code,{children:"exit"})," \u52a8\u4f5c\u3001\u8c03\u7528\u7684\u6f14\u5458\u6216\u5ef6\u8fdf\u8f6c\u6362 (",(0,s.jsx)(n.code,{children:"after"}),")\u3002\u5982\u679c\u60a8\u4f9d\u8d56\u4e8e\u4ee5\u524d XState v4 \u7684\u884c\u4e3a\uff0c\u5373\u8f6c\u6362\u9690\u5f0f\u91cd\u65b0\u8fdb\u5165\u72b6\u6001\u8282\u70b9\uff0c\u8bf7\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"reenter: true"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  // ...\n  states: {\n    compoundState: {\n      entry: 'someAction',\n      on: {\n        // highlight-start\n        someEvent: {\n          target: 'compoundState.childState',\n          // Reenters the `compoundState` state,\n          // just like an external transition\n          reenter: true,\n        },\n        selfEvent: {\n          target: 'childState',\n          reenter: true\n        }\n        // highlight-end\n      },\n      initial: 'childState',\n      states: {\n        childState: {},\n      },\n    },\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  // ...\n  states: {\n    compoundState: {\n      entry: 'someAction',\n      on: {\n        // highlight-start\n        someEvent: {\n          // implicitly external\n          target: 'compoundState.childState', // non-relative target\n        },\n        selfEvent: {\n          target: 'compoundState'\n        }\n        // highlight-end\n      },\n      initial: 'childState',\n      states: {\n        childState: {},\n      },\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  // ...\n  states: {\n    compoundState: {\n      after: {\n        1000: {\n          target: 'compoundState.childState',\n          reenter: true, // make it external explicitly!\n        },\n      },\n      initial: 'childState',\n      states: {\n        childState: {},\n      },\n    },\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  // ...\n  states: {\n    compoundState: {\n      after: {\n        1000: {\n          // implicitly external\n          target: 'compoundState.childState', // non-relative target\n        },\n      },\n      initial: 'childState',\n      states: {\n        childState: {},\n      },\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"\u5b50\u72b6\u6001\u8282\u70b9\u603b\u662f\u91cd\u65b0\u8fdb\u5165",children:"\u5b50\u72b6\u6001\u8282\u70b9\u603b\u662f\u91cd\u65b0\u8fdb\u5165"}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5f53\u590d\u5408\u72b6\u6001\u8282\u70b9\u4e0a\u5b9a\u4e49\u7684\u8f6c\u6362\uff08\u65e0\u8bba\u662f\u5916\u90e8\u8fd8\u662f\u5185\u90e8\uff09\u76ee\u6807\u662f\u5b50\u72b6\u6001\u8282\u70b9\u65f6\uff0c\u5b50\u72b6\u6001\u8282\u70b9\u603b\u662f\u91cd\u65b0\u8fdb\u5165\u3002\u8fd9\u4e00\u53d8\u5316\u4ec5\u5728\u5b50\u72b6\u6001\u8282\u70b9\u5177\u6709 ",(0,s.jsx)(n.code,{children:"entry"})," \u6216 ",(0,s.jsx)(n.code,{children:"exit"})," \u52a8\u4f5c\u3001\u8c03\u7528\u7684\u6f14\u5458\u6216\u5ef6\u8fdf\u8f6c\u6362 (",(0,s.jsx)(n.code,{children:"after"}),") \u65f6\u76f8\u5173\u3002\u6dfb\u52a0 ",(0,s.jsx)(n.code,{children:"stateIn"})," \u5b88\u536b\u4ee5\u9632\u6b62\u5b50\u72b6\u6001\u7684\u975e\u9884\u671f\u91cd\u65b0\u8fdb\u5165\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\n\nconst machine = createMachine({\n  // ...\n  states: {\n    compoundState: {\n      on: {\n        someEvent: {\n          guard: not(stateIn({ compoundState: 'childState' })),\n          target: '.childState',\n        },\n      },\n      initial: 'childState',\n      states: {\n        childState: {\n          entry: 'someAction',\n        },\n      },\n    },\n  },\n})\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\n\nconst machine = createMachine({\n  // ...\n  states: {\n    compoundState: {\n      on: {\n        someEvent: {\n          // Implicitly internal; childState not re-entered\n          target: '.childState',\n        },\n      },\n      initial: 'childState',\n      states: {\n        childState: {\n          entry: 'someAction',\n        },\n      },\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-statein-\u9a8c\u8bc1\u72b6\u6001\u8f6c\u6362\u800c\u4e0d\u662f-in",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"stateIn()"})," \u9a8c\u8bc1\u72b6\u6001\u8f6c\u6362\uff0c\u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"in"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"in: 'someState'"})," \u8f6c\u6362\u5c5e\u6027\u5df2\u88ab\u79fb\u9664\u3002\u8bf7\u6539\u7528 ",(0,s.jsx)(n.code,{children:"guard: stateIn(...)"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  on: {\n    someEvent: {\n      guard: stateIn({ form: 'submitting' }),\n      target: 'someState',\n    },\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  on: {\n    someEvent: {\n      in: '#someMachine.form.submitting'\n      target: 'someState',\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-actorsubscribe-\u4ee3\u66ff-statehistory",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"actor.subscribe()"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"state.history"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"state.history"})," \u5c5e\u6027\u5df2\u88ab\u79fb\u9664\u3002\u5982\u679c\u60a8\u9700\u8981\u524d\u4e00\u4e2a\u5feb\u7167\uff0c\u5e94\u8be5\u901a\u8fc7 ",(0,s.jsx)(n.code,{children:"actor.subscribe(...)"})," \u6765\u7ef4\u62a4\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nlet previousSnapshot = actor.getSnapshot();\n\nactor.subscribe((snapshot) => {\n  doSomeComparison(previousSnapshot, snapshot);\n  previousSnapshot = snapshot;\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nactor.subscribe((state) => {\n  doSomeComparison(state.history, state);\n});\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8fc1\u79fb\u524d\u63d0\u793a\uff1a"})," \u66f4\u65b0 v4 \u9879\u76ee\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"actor.subscribe()"})," \u8ddf\u8e2a\u5386\u53f2\u8bb0\u5f55\u3002"]}),"\n",(0,s.jsxs)(n.h3,{id:"\u52a8\u4f5c\u53ef\u4ee5\u629b\u51fa\u9519\u8bef\u800c\u65e0\u9700-escalate",children:["\u52a8\u4f5c\u53ef\u4ee5\u629b\u51fa\u9519\u8bef\u800c\u65e0\u9700 ",(0,s.jsx)(n.code,{children:"escalate"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"escalate"})," \u52a8\u4f5c\u521b\u5efa\u5668\u5df2\u88ab\u79fb\u9664\u3002\u5728 XState v5 \u4e2d\uff0c\u52a8\u4f5c\u53ef\u4ee5\u629b\u51fa\u9519\u8bef\uff0c\u5e76\u4e14\u5b83\u4eec\u5c06\u6309\u9884\u671f\u4f20\u64ad\u3002\u9519\u8bef\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"onError"})," \u8f6c\u6362\u8fdb\u884c\u5904\u7406\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst childMachine = createMachine({\n  // \u8fd9\u5c06\u53d1\u9001\u5230\u8c03\u7528\u6b64\u5b50\u673a\u5668\u7684\u7236\u673a\u5668\n  // highlight-start\n  entry: () => {\n    throw new Error('This is some error')\n  }\n  // highlight-end\n});\n\nconst parentMachine = createMachine({\n  invoke: {\n    src: childMachine,\n    // highlight-start\n    onError: {\n      actions: ({ context, event }) => {\n        console.log(event.error);\n        //  {\n        //    type: ...,\n        //    error: {\n        //      message: 'This is some error'\n        //    }\n        //  }\n      }\n    }\n    // highlight-end\n  }\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst childMachine = createMachine({\n  // highlight-start\n  entry: escalate('This is some error')\n  // highlight-end\n});\n\n/* ... */\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"actors",children:"Actors"}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-actor-\u903b\u8f91\u521b\u5efa\u5668\u4ee3\u66ff\u51fd\u6570\u4f5c\u4e3a-invokesrc",children:["\u4f7f\u7528 actor \u903b\u8f91\u521b\u5efa\u5668\u4ee3\u66ff\u51fd\u6570\u4f5c\u4e3a ",(0,s.jsx)(n.code,{children:"invoke.src"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u7528\u7684 actor \u903b\u8f91\u521b\u5efa\u5668\u6709\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"createMachine"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"fromPromise"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"fromObservable"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"fromEventObservable"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"fromTransition"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"fromCallback"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 ",(0,s.jsx)(n.a,{href:"/xstate-zh/docs/actors",children:"Actors"}),"\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nimport { fromPromise, setup } from 'xstate';\n\nconst machine = setup({\n  actors: {\n    getUser: fromPromise(async ({ input }: { input: { userId: string } }) => {\n      const data = await getData(input.userId);\n      // ...\n      return data;\n    })\n  }\n}).createMachine({\n  invoke: {\n    src: 'getUser',\n    input: ({ context, event }) => ({\n      userId: context.userId,\n    }),\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nimport { createMachine } from 'xstate';\n\nconst machine = createMachine({\n  invoke: {\n    src: (context) => async () => {\n      const data = await getData(context.userId);\n\n      // ...\n      return data;\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nimport { fromCallback, createMachine } from 'xstate';\n\nconst machine = createMachine({\n  invoke: {\n    src: fromCallback(({ sendBack, receive, input }) => {\n      // ...\n    }),\n    input: ({ context, event }) => ({\n      userId: context.userId,\n    }),\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nimport { createMachine } from 'xstate';\n\nconst machine = createMachine({\n  invoke: {\n    src: (context, event) => (sendBack, receive) => {\n      // context.userId\n      // ...\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nimport { fromEventObservable, createMachine } from 'xstate';\nimport { interval, mapTo } from 'rxjs';\n\nconst machine = createMachine({\n  invoke: {\n    src: fromEventObservable(() =>\n      interval(1000).pipe(mapTo({ type: 'tick' })),\n    ),\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nimport { createMachine } from 'xstate';\nimport { interval, mapTo } from 'rxjs';\n\nconst machine = createMachine({\n  invoke: {\n    src: () => interval(1000).pipe(mapTo({ type: 'tick' })),\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-invokeinput-\u4ee3\u66ff-invokedata",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"invoke.input"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"invoke.data"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"invoke.data"})," \u5c5e\u6027\u5df2\u88ab\u79fb\u9664\u3002\u5982\u679c\u60a8\u60f3\u4e3a\u88ab\u8c03\u7528\u7684\u6f14\u5458\u63d0\u4f9b\u4e0a\u4e0b\u6587\uff0c\u8bf7\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"invoke.input"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst someActor = createMachine({\n  // The input must be consumed by the invoked actor:\n  context: ({ input }) => input,\n  // ...\n});\n\nconst machine = createMachine({\n  // ...\n  invoke: {\n    src: 'someActor',\n    input: {\n      value: 42,\n    },\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst someActor = createMachine({\n  // ...\n});\n\nconst machine = createMachine({\n  // ...\n  invoke: {\n    src: 'someActor',\n    data: {\n      value: 42,\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u5728\u6700\u7ec8\u72b6\u6001\u4e2d\u4f7f\u7528-output-\u4ee3\u66ff-data",children:["\u5728\u6700\u7ec8\u72b6\u6001\u4e2d\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"output"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"data"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8981\u4ece\u8fbe\u5230\u6700\u7ec8\u72b6\u6001\u7684\u673a\u5668\u751f\u6210\u8f93\u51fa\u6570\u636e\uff0c\u8bf7\u4f7f\u7528\u9876\u7ea7 ",(0,s.jsx)(n.code,{children:"output"})," \u5c5e\u6027\u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"data"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  // ...\n  states: {\n    finished: {\n      type: 'final',\n    },\n  },\n  output: {\n    answer: 42,\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  // ...\n  states: {\n    finished: {\n      type: 'final',\n      data: {\n        answer: 42,\n      },\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["\u8981\u63d0\u4f9b\u52a8\u6001\u751f\u6210\u7684\u8f93\u51fa\uff0c\u8bf7\u5c06 ",(0,s.jsx)(n.code,{children:"invoke.data"})," \u66ff\u6362\u4e3a ",(0,s.jsx)(n.code,{children:"invoke.output"})," \u5e76\u6dfb\u52a0\u9876\u7ea7 ",(0,s.jsx)(n.code,{children:"output"})," \u5c5e\u6027\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  // ...\n  states: {\n    finished: {\n      type: 'final',\n      output: ({ event }) => ({\n        answer: event.someValue,\n      }),\n    },\n  },\n  output: ({ event }) => event.output,\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  // ...\n  states: {\n    finished: {\n      type: 'final',\n      data: (context, event) => {\n        answer: event.someValue,\n      },\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4e0d\u8981\u5728-input-\u6216-output-\u4e2d\u4f7f\u7528\u5c5e\u6027\u6620\u5c04\u5668",children:["\u4e0d\u8981\u5728 ",(0,s.jsx)(n.code,{children:"input"})," \u6216 ",(0,s.jsx)(n.code,{children:"output"})," \u4e2d\u4f7f\u7528\u5c5e\u6027\u6620\u5c04\u5668"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u60a8\u60f3\u4e3a\u88ab\u8c03\u7528\u7684\u6f14\u5458\u63d0\u4f9b\u52a8\u6001\u4e0a\u4e0b\u6587\uff0c\u6216\u4ece\u6700\u7ec8\u72b6\u6001\u751f\u6210\u52a8\u6001\u8f93\u51fa\uff0c\u8bf7\u4f7f\u7528\u51fd\u6570\u800c\u4e0d\u662f\u5e26\u6709\u5c5e\u6027\u6620\u5c04\u5668\u7684\u5bf9\u8c61\u3002"}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  // ...\n  invoke: {\n    src: 'someActor',\n    input: ({ context, event }) => ({\n      value: event.value,\n    }),\n  },\n});\n\n// \u88ab\u8c03\u7528\u7684 actor \u5fc5\u987b\u6d88\u8d39 input\uff1a\nconst someActor = createMachine({\n  // ...\n  context: ({ input }) => input,\n});\n\n// \u751f\u6210\u673a\u5668\u8f93\u51fa\nconst machine = createMachine({\n  // ...\n  states: {\n    finished: {\n      type: 'final',\n    },\n  },\n  output: ({ context, event }) => ({\n    answer: context.value,\n  }),\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  // ...\n  invoke: {\n    src: 'someActor',\n    data: {\n      value: (context, event) => event.value, // a property mapper\n    },\n  },\n});\n\n// \u751f\u6210\u673a\u5668\u8f93\u51fa\nconst machine = createMachine({\n  // ...\n  states: {\n    finished: {\n      type: 'final',\n      data: {\n        answer: (context, event) => context.value, // a property mapper\n      },\n    },\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-options-\u5bf9\u8c61\u4e0a\u7684-actors-\u5c5e\u6027\u4ee3\u66ff-services",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"options"})," \u5bf9\u8c61\u4e0a\u7684 ",(0,s.jsx)(n.code,{children:"actors"})," \u5c5e\u6027\u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"services"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"services"})," \u5df2\u91cd\u547d\u540d\u4e3a ",(0,s.jsx)(n.code,{children:"actors"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst specificMachine = machine.provide({\n  actions: {\n    /* ... */\n  },\n  guards: {\n    /* ... */\n  },\n  actors: {\n    /* ... */\n  },\n  // ...\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst specificMachine = machine.withConfig({\n  actions: {\n    /* ... */\n  },\n  guards: {\n    /* ... */\n  },\n  services: {\n    /* ... */\n  },\n  // ...\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-subscribe-\u76d1\u542c\u53d8\u5316\u800c\u4e0d\u662f-ontransition",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"subscribe()"})," \u76d1\u542c\u53d8\u5316\uff0c\u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"onTransition()"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"actor.onTransition(...)"})," \u65b9\u6cd5\u5df2\u88ab\u79fb\u9664\u3002\u8bf7\u6539\u7528 ",(0,s.jsx)(n.code,{children:"actor.subscribe(...)"}),"\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst actor = createActor(machine);\nactor.subscribe((state) => {\n  // ...\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst actor = interpret(machine);\nactor.onTransition((state) => {\n  // ...\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"createactor\u539f-interpret\u63a5\u53d7\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6765\u6062\u590d\u72b6\u6001",children:[(0,s.jsx)(n.code,{children:"createActor()"}),"\uff08\u539f ",(0,s.jsx)(n.code,{children:"interpret()"}),"\uff09\u63a5\u53d7\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6765\u6062\u590d\u72b6\u6001"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"interpret(machine).start(state)"})," \u73b0\u5728\u662f ",(0,s.jsx)(n.code,{children:"createActor(machine, { snapshot }).start()"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u8981\u5728\u7279\u5b9a\u72b6\u6001\u4e0b\u6062\u590d\u6f14\u5458\uff0c\u73b0\u5728\u5e94\u5c06\u72b6\u6001\u4f5c\u4e3a ",(0,s.jsx)(n.code,{children:"createActor(logic, options)"})," \u7684 ",(0,s.jsx)(n.code,{children:"options"})," \u53c2\u6570\u7684 ",(0,s.jsx)(n.code,{children:"snapshot"})," \u5c5e\u6027\u4f20\u9012\u3002",(0,s.jsx)(n.code,{children:"actor.start()"})," \u65b9\u6cd5\u4e0d\u518d\u63a5\u53d7 ",(0,s.jsx)(n.code,{children:"state"})," \u53c2\u6570\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst actor = createActor(machine, { snapshot: someState });\nactor.start();\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst actor = interpret(machine);\nactor.start(someState);\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-actorgetsnapshot-\u83b7\u53d6\u6f14\u5458\u7684\u72b6\u6001",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"actor.getSnapshot()"})," \u83b7\u53d6\u6f14\u5458\u7684\u72b6\u6001"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u6f14\u5458\u542f\u52a8\u540e\u8ba2\u9605\u6f14\u5458 (",(0,s.jsx)(n.code,{children:"actor.subscribe(...)"}),") \u5c06\u4e0d\u518d\u7acb\u5373\u53d1\u51fa\u5f53\u524d\u5feb\u7167\u3002\u76f8\u53cd\uff0c\u8bf7\u4ece ",(0,s.jsx)(n.code,{children:"actor.getSnapshot()"})," \u8bfb\u53d6\u5f53\u524d\u5feb\u7167\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst actor = createActor(machine);\nactor.start();\n\nconst initialState = actor.getSnapshot();\n\nactor.subscribe((state) => {\n  // Snapshots from when the subscription was created\n  // Will not emit the current snapshot until a transition happens\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst actor = interpret(machine);\nactor.start();\n\nactor.subscribe((state) => {\n  // Current snapshot immediately emitted\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u904d\u5386\u4e8b\u4ef6\u800c\u4e0d\u662f\u4f7f\u7528-actorbatch",children:["\u904d\u5386\u4e8b\u4ef6\u800c\u4e0d\u662f\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"actor.batch()"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7528\u4e8e\u6279\u91cf\u5904\u7406\u4e8b\u4ef6\u7684 ",(0,s.jsx)(n.code,{children:"actor.batch([...])"})," \u65b9\u6cd5\u5df2\u88ab\u79fb\u9664\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nfor (const event of events) {\n  actor.send(event);\n}\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nactor.batch(events);\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8fc1\u79fb\u524d\u63d0\u793a\uff1a"})," \u66f4\u65b0 v4 \u9879\u76ee\u4ee5\u5faa\u73af\u904d\u5386\u4e8b\u4ef6\u5e76\u5c06\u5b83\u4eec\u4f5c\u4e3a\u6279\u5904\u7406\u53d1\u9001\u3002"]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-snapshotstatus--done-\u4ee3\u66ff-snapshotdone",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"snapshot.status === 'done'"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"snapshot.done"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"snapshot.done"})," \u5c5e\u6027\u5df2\u88ab\u79fb\u9664\uff0c\u8be5\u5c5e\u6027\u4ee5\u524d\u5728\u72b6\u6001\u673a\u6f14\u5458\u7684\u5feb\u7167\u5bf9\u8c61\u4e2d\u3002\u8bf7\u6539\u7528 ",(0,s.jsx)(n.code,{children:"snapshot.status === 'done'"}),"\uff0c\u5b83\u9002\u7528\u4e8e\u6240\u6709\u6f14\u5458\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst actor = createActor(machine);\nactor.start();\n\nactor.subscribe((snapshot) => {\n  if (snapshot.status === 'done') {\n    // ...\n  }\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst actor = interpret(machine);\nactor.start();\n\nactor.subscribe((state) => {\n  if (state.done) {\n    // ...\n  }\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"statenextevents-\u5df2\u88ab\u79fb\u9664",children:[(0,s.jsx)(n.code,{children:"state.nextEvents"})," \u5df2\u88ab\u79fb\u9664"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"state.nextEvents"})," \u5c5e\u6027\u5df2\u88ab\u79fb\u9664\uff0c\u56e0\u4e3a\u5b83\u4e0d\u662f\u786e\u5b9a\u53ef\u4ee5\u53d1\u9001\u7ed9\u6f14\u5458\u7684\u4e0b\u4e00\u4e2a\u4e8b\u4ef6\u7684\u5b8c\u5168\u5b89\u5168/\u53ef\u9760\u7684\u65b9\u6cd5\u3002\u5982\u679c\u60a8\u60f3\u6839\u636e\u4ee5\u524d\u7684\u884c\u4e3a\u83b7\u53d6\u4e0b\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528\u6b64\u8f85\u52a9\u51fd\u6570\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import type { AnyMachineSnapshot } from 'xstate';\n\nfunction getNextEvents(snapshot: AnyMachineSnapshot) {\n  return [...new Set([...snapshot._nodes.flatMap((sn) => sn.ownEvents)])];\n}\n\n// \u4ee3\u66ff `state.nextEvents`:\nconst nextEvents = getNextEvents(state);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"typescript",children:"TypeScript"}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-types-\u4ee3\u66ff-schema",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"types"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"schema"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"machineConfig.schema"})," \u5c5e\u6027\u5df2\u91cd\u547d\u540d\u4e3a ",(0,s.jsx)(n.code,{children:"machineConfig.types"}),"\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  types: {} as {\n    context: {\n      /* ...*/\n    };\n    events: {\n      /* ...*/\n    };\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  schema: {} as {\n    context: {\n      /* ...*/\n    };\n    events: {\n      /* ...*/\n    };\n  },\n});\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4f7f\u7528-typestypegen-\u4ee3\u66ff-tstypes",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"types.typegen"})," \u4ee3\u66ff ",(0,s.jsx)(n.code,{children:"tsTypes"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsx)(n.admonition,{type:"warningxstate",children:(0,s.jsx)(n.p,{children:"XState Typegen \u5c1a\u672a\u5b8c\u5168\u652f\u6301 XState v5\u3002\u7136\u800c\uff0c\u4ecd\u7136\u53ef\u4ee5\u5728\u6ca1\u6709 Typegen \u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u5f3a\u7c7b\u578b\u7684\u673a\u5668\u3002"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"machineConfig.tsTypes"})," \u5c5e\u6027\u5df2\u88ab\u91cd\u547d\u540d\uff0c\u73b0\u5728\u4f4d\u4e8e ",(0,s.jsx)(n.code,{children:"machineConfig.types.typegen"}),"\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nconst machine = createMachine({\n  types: {} as {\n    typegen: {};\n    context: {\n      /* ...*/\n    };\n    events: {\n      /* ...*/\n    };\n  },\n});\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nconst machine = createMachine({\n  tsTypes: {};\n  schema: {} as {\n    context: {\n      /* ...*/\n    };\n    events: {\n      /* ...*/\n    };\n  },\n});\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"xstatereact",children:(0,s.jsx)(n.code,{children:"@xstate/react"})}),"\n",(0,s.jsxs)(n.h3,{id:"useinterpret-\u73b0\u5728\u662f-useactorref",children:[(0,s.jsx)(n.code,{children:"useInterpret()"})," \u73b0\u5728\u662f ",(0,s.jsx)(n.code,{children:"useActorRef()"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"useInterpret()"})," \u94a9\u5b50\uff08\u7528\u4e8e\u8fd4\u56de ",(0,s.jsx)(n.code,{children:"actorRef"}),'\uff0c\u5728 XState v4 \u4e2d\u79f0\u4e3a "service"\uff09\u5df2\u91cd\u547d\u540d\u4e3a ',(0,s.jsx)(n.code,{children:"useActorRef()"}),"\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u2705\nimport { useActorRef } from '@xstate/react';\n\nconst actorRef = useActorRef(machine); // or any other logic\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u274c \u5df2\u5f03\u7528\nimport { useInterpret } from '@xstate/react';\n\nconst service = useInterpret(machine);\n"})})})]}),"\n",(0,s.jsxs)(n.h3,{id:"useactorlogic-\u73b0\u5728\u63a5\u53d7-actor-\u903b\u8f91\u800c\u4e0d\u662f-actor",children:[(0,s.jsx)(n.code,{children:"useActor(logic)"})," \u73b0\u5728\u63a5\u53d7 actor \u903b\u8f91\uff0c\u800c\u4e0d\u662f actor"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"useActor(logic)"})," \u94a9\u5b50\u73b0\u5728\u63a5\u53d7 ",(0,s.jsx)(n.em,{children:"actor \u903b\u8f91"}),"\uff08\u4f8b\u5982 ",(0,s.jsx)(n.code,{children:"fromPromise(...)"}),"\u3001",(0,s.jsx)(n.code,{children:"createMachine(...)"})," \u7b49\uff09\u800c\u4e0d\u662f\u73b0\u6709\u7684 ",(0,s.jsx)(n.code,{children:"ActorRef"}),"\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8981\u4f7f\u7528\u73b0\u6709\u7684 ",(0,s.jsx)(n.code,{children:"ActorRef"}),"\uff0c\u8bf7\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"actor.send(...)"})," \u53d1\u9001\u4e8b\u4ef6\uff0c\u5e76\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"useSelector(actor, ...)"})," \u83b7\u53d6\u5feb\u7167\uff1a"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// \u2705\nimport { useSelector } from '@xstate/react';\n\nfunction Component({ someActorRef }) {\n  const state = useSelector(someActorRef, (s) => s);\n\n  return (\n    <button onClick={() => someActorRef.send({ type: 'someEvent' })} />\n  );\n}\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// \u274c \u5df2\u5f03\u7528\nimport { useActor } from '@xstate/react';\n\nfunction Component({ someActorRef }) {\n  const [state, send] = useActor(someActorRef);\n\n  return (\n    <button onClick={() => send({ type: 'someEvent' })} />\n  );\n}\n"})})})]}),"\n",(0,s.jsxs)(n.h2,{id:"\u4f7f\u7528-machineprovide-\u5728\u94a9\u5b50\u4e2d\u63d0\u4f9b\u5b9e\u73b0",children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"machine.provide()"})," \u5728\u94a9\u5b50\u4e2d\u63d0\u4f9b\u5b9e\u73b0"]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5bf9\u4e8e\u52a8\u6001\u521b\u5efa\u5177\u6709\u63d0\u4f9b\u5b9e\u73b0\u7684\u673a\u5668\uff0c",(0,s.jsx)(n.code,{children:"useMachine(...)"}),"\u3001",(0,s.jsx)(n.code,{children:"useActor(...)"})," \u548c ",(0,s.jsx)(n.code,{children:"useActorRef(...)"})," \u94a9\u5b50\u4e0d\u518d\u63a5\u53d7\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\u7684\u60f0\u6027\u673a\u5668\u521b\u5efa\u5668"}),"\n",(0,s.jsx)(n.li,{children:"\u4f20\u9012\u7ed9\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u5b9e\u73b0"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u76f8\u53cd\uff0c",(0,s.jsx)(n.code,{children:"machine.provide(...)"})," \u5e94\u76f4\u63a5\u4f20\u9012\u7ed9\u7b2c\u4e00\u4e2a\u53c2\u6570\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"@xstate/react"})," \u5305\u5c06\u5177\u6709\u76f8\u540c\u914d\u7f6e\u7684\u673a\u5668\u89c6\u4e3a\u76f8\u540c\u7684\u673a\u5668\uff0c\u56e0\u6b64\u5b83\u5c06\u6700\u5c0f\u5316\u91cd\u65b0\u6e32\u67d3\uff0c\u4f46\u4ecd\u4f1a\u4fdd\u6301\u63d0\u4f9b\u7684\u5b9e\u73b0\u662f\u6700\u65b0\u7684\u3002"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// \u2705\nimport { useMachine } from '@xstate/react';\nimport { someMachine } from './someMachine';\n\nfunction Component(props) {\n  const [state, send] = useMachine(someMachine.provide({\n    actions: {\n      doSomething: () => {\n        props.onSomething?.(); // Kept up-to-date\n      }\n    }\n  }));\n\n  // ...\n}\n"})})}),(0,s.jsx)(t,{value:"v4 arguments",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// \u274c \u5df2\u5f03\u7528\nimport { useMachine } from '@xstate/react';\nimport { someMachine } from './someMachine';\n\nfunction Component(props) {\n  const [state, send] = useMachine(someMachine, {\n    actions: {\n      doSomething: () => {\n        props.onSomething?.();\n      }\n    }\n  });\n\n  // ...\n}\n"})})}),(0,s.jsx)(t,{value:"v4 function",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// \u274c \u5df2\u5f03\u7528\nimport { useMachine } from '@xstate/react';\nimport { someMachine } from './someMachine';\n\nfunction Component(props) {\n  const [state, send] = useMachine(() => someMachine.withConfig({\n    actions: {\n      doSomething: () => {\n        props.onSomething?.();\n      }\n    }\n  }));\n\n  // ...\n}\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"xstatevue",children:(0,s.jsx)(n.code,{children:"@xstate/vue"})}),"\n",(0,s.jsxs)(n.h3,{id:"usemachine-\u73b0\u5728\u8fd4\u56de-snapshot-\u800c\u4e0d\u662f-state\u5e76\u8fd4\u56de-actor-\u800c\u4e0d\u662f-service",children:[(0,s.jsx)(n.code,{children:"useMachine()"})," \u73b0\u5728\u8fd4\u56de ",(0,s.jsx)(n.code,{children:"snapshot"})," \u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"state"}),"\uff0c\u5e76\u8fd4\u56de ",(0,s.jsx)(n.code,{children:"actor"})," \u800c\u4e0d\u662f ",(0,s.jsx)(n.code,{children:"service"})]}),"\n",(0,s.jsx)(n.admonition,{type:"breakingchange",children:(0,s.jsx)(n.p,{children:"\u91cd\u5927\u53d8\u66f4"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e3a\u4e86\u4e0e XState \u548c\u76f8\u5173\u5e93\u4fdd\u6301\u4e00\u81f4\u7684\u547d\u540d\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"state"})," \u73b0\u5728\u662f ",(0,s.jsx)(n.code,{children:"snapshot"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"service"})," \u73b0\u5728\u662f ",(0,s.jsx)(n.code,{children:"actor"})]}),"\n"]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)(t,{value:"v5",label:"XState v5",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// \u2705\nimport { useMachine } from '@xstate/vue';\n\n// ...\n\nconst {\n  // highlight-next-line\n  snapshot, // Renamed from `state`\n  send,\n  // highlight-next-line\n  actor // Renamed from `service`\n} = useMachine(someMachine)\n"})})}),(0,s.jsx)(t,{value:"v4",label:"XState v4",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// \u274c \u5df2\u5f03\u7528\nimport { useMachine } from '@xstate/vue';\n\n// ...\n\nconst {\n  // highlight-next-line\n  state, // Renamed to `snapshot` in @xstate/vue 3.0.0\n  send,\n  // highlight-next-line\n  service // Renamed to `actor` in @xstate/vue 3.0.0\n} = useMachine(someMachine)\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"\u65b0\u529f\u80fd",children:"\u65b0\u529f\u80fd"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/xstate-zh/docs/system",children:"\u521b\u5efa\u6f14\u5458\u7cfb\u7edf"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/actors#actor-logic-creators",children:"\u65b0\u7684\u6f14\u5458\u903b\u8f91\u521b\u5efa\u5668"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/xstate-zh/docs/persistence",children:"\u4e3a\u8c03\u7528\u548c\u751f\u6210\u7684\u6f14\u5458\u63d0\u4f9b\u6df1\u5ea6\u6301\u4e45\u6027"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/xstate-zh/docs/input",children:"\u4e3a\u72b6\u6001\u673a\u548c\u6f14\u5458\u63d0\u4f9b\u8f93\u5165\u6570\u636e"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/xstate-zh/docs/output",children:"\u4e3a\u6f14\u5458\u6307\u5b9a\u8f93\u51fa\u201c\u5b8c\u6210\u6570\u636e\u201d"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/transitions#partial-wildcard-transitions",children:"\u90e8\u5206\u4e8b\u4ef6\u63cf\u8ff0\u7b26\uff08\u90e8\u5206\u901a\u914d\u7b26\uff09"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/actions#enqueue-actions",children:"\u6392\u961f\u52a8\u4f5c"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/guards#higher-level-guards",children:"\u66f4\u9ad8\u7ea7\u7684\u5b88\u536b"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/docs/machines#providing-implementations",children:"\u7528\u4e8e\u6307\u5b9a\u7c7b\u578b\u548c\u5f3a\u7c7b\u578b\u72b6\u6001\u503c\u7684\u8bbe\u7f6e API"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/xstate-zh/docs/inspection",children:"\u68c0\u67e5 API"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,s.jsx)(n.h3,{id:"stately-studio-\u4f55\u65f6\u4f1a\u517c\u5bb9-xstate-v5",children:"Stately Studio \u4f55\u65f6\u4f1a\u517c\u5bb9 XState v5\uff1f"}),"\n",(0,s.jsxs)(n.p,{children:["\u6211\u4eec\u76ee\u524d\u6b63\u5728\u52aa\u529b\u4f7f ",(0,s.jsx)(n.a,{href:"/xstate-zh/docs/studio",children:"Stately Studio"})," \u517c\u5bb9 XState v5\u3002\u5bfc\u51fa\u5230 XState v5\uff08JavaScript \u6216 TypeScript\uff09\u5df2\u7ecf\u53ef\u7528\u3002\u6211\u4eec\u6b63\u5728\u52aa\u529b\u652f\u6301 XState v5 \u7684\u65b0\u529f\u80fd\uff0c\u4f8b\u5982\u9ad8\u9636\u5b88\u536b\u3001\u90e8\u5206\u4e8b\u4ef6\u901a\u914d\u7b26\u548c\u673a\u5668\u8f93\u5165/\u8f93\u51fa\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u6211\u4eec\u7684\u8def\u7ebf\u56fe\u4e0a\u4e3a ",(0,s.jsx)(n.a,{href:"https://feedback.stately.ai/editor/p/stately-studio-xstate-v5-compatibility",children:"Stately Studio + XState v5 \u517c\u5bb9\u6027"})," \u70b9\u8d5e\u6216\u53d1\u8868\u8bc4\u8bba\uff0c\u4ee5\u968f\u65f6\u4e86\u89e3\u6211\u4eec\u7684\u8fdb\u5c55\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"xstate-vs-code-\u6269\u5c55\u4f55\u65f6\u4f1a\u517c\u5bb9-xstate-v5",children:"XState VS Code \u6269\u5c55\u4f55\u65f6\u4f1a\u517c\u5bb9 XState v5\uff1f"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/xstate-zh/docs/xstate-vscode-extension",children:"XState VS Code \u6269\u5c55"})," \u5c1a\u672a\u517c\u5bb9 XState v5\u3002\u8be5\u6269\u5c55\u662f\u6211\u4eec\u7684\u4f18\u5148\u4e8b\u9879\uff0c\u76f8\u5173\u5de5\u4f5c\u5df2\u7ecf\u5728\u8fdb\u884c\u4e2d\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u6211\u4eec\u7684\u8def\u7ebf\u56fe\u4e0a\u4e3a ",(0,s.jsx)(n.a,{href:"https://feedback.stately.ai/devtools/p/xstate-v5-compatibility-for-vs-code-extension",children:"VS Code \u6269\u5c55\u7684 XState v5 \u517c\u5bb9\u6027"})," \u70b9\u8d5e\u6216\u53d1\u8868\u8bc4\u8bba\uff0c\u4ee5\u968f\u65f6\u4e86\u89e3\u6211\u4eec\u7684\u8fdb\u5c55\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"xstate-v5-\u4f55\u65f6\u4f1a\u6709-typegen",children:"XState v5 \u4f55\u65f6\u4f1a\u6709 typegen\uff1f"}),"\n",(0,s.jsxs)(n.p,{children:["XState v5 \u4e2d\u7684 TypeScript \u63a8\u65ad\u529f\u80fd\u5f97\u5230\u4e86\u6781\u5927\u6539\u8fdb\u3002\u7279\u522b\u662f\u901a\u8fc7 ",(0,s.jsx)(n.code,{children:"setup()"})," API \u548c\u52a8\u6001\u53c2\u6570\u7b49\u529f\u80fd\uff0c\u4e3b\u8981\u7684 typegen \u7528\u4f8b\u4e0d\u518d\u9700\u8981\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u7136\u800c\uff0c\u6211\u4eec\u8ba4\u8bc6\u5230\u53ef\u80fd\u4ecd\u7136\u5b58\u5728\u4e00\u4e9b\u7279\u5b9a\u7684 typegen \u7528\u4f8b\u3002\u5728\u6211\u4eec\u7684\u8def\u7ebf\u56fe\u4e0a\u4e3a ",(0,s.jsx)(n.a,{href:"https://feedback.stately.ai/xstate/p/typegen-for-xstate-v5",children:"XState v5 \u7684 typegen"})," \u70b9\u8d5e\u6216\u53d1\u8868\u8bc4\u8bba\uff0c\u4ee5\u968f\u65f6\u4e86\u89e3\u6211\u4eec\u7684\u8fdb\u5c55\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u5982\u4f55\u540c\u65f6\u4f7f\u7528-xstate-v4-\u548c-v5",children:"\u5982\u4f55\u540c\u65f6\u4f7f\u7528 XState v4 \u548c v5\uff1f"}),"\n",(0,s.jsxs)(n.p,{children:["\u60a8\u53ef\u4ee5\u5728\u540c\u4e00\u4e2a\u9879\u76ee\u4e2d\u540c\u65f6\u4f7f\u7528 XState v4 \u548c v5\uff0c\u8fd9\u5bf9\u4e8e\u9010\u6b65\u8fc1\u79fb\u5230 XState v5 \u975e\u5e38\u6709\u7528\u3002\u8981\u540c\u65f6\u4f7f\u7528\u8fd9\u4e24\u4e2a\u7248\u672c\uff0c\u8bf7\u624b\u52a8\u6216\u901a\u8fc7 CLI \u5c06 ",(0,s.jsx)(n.code,{children:'"xstate5": "npm:xstate@5"'})," \u6dfb\u52a0\u5230\u60a8\u7684 ",(0,s.jsx)(n.code,{children:"package.json"})," \u4e2d\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm i xstate5@npm:xstate@5\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7136\u540e\uff0c\u60a8\u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u5bfc\u5165 XState v5 \u7248\u672c\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { createMachine } from 'xstate5';\n// or { createMachine as createMachine5 } from 'xstate5';\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679c\u60a8\u9700\u8981\u4f7f\u7528\u4e0d\u540c\u7248\u672c\u7684\u96c6\u6210\u5305\uff0c\u4f8b\u5982 ",(0,s.jsx)(n.code,{children:"@xstate/react"}),"\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e0a\u9762\u7684\u7b56\u7565\uff0c\u4f46\u9700\u8981\u5728\u96c6\u6210\u5305\u4e2d\u94fe\u63a5\u5230\u6b63\u786e\u7248\u672c\u7684 XState\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u811a\u672c\u6765\u5b8c\u6210\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm i xstate5@npm:xstate@5 @xstate5/react@npm:@xstate/react@4 --force\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// scripts/xstate5-react-script.js\nconst fs = require('fs-extra');\nconst path = require('path');\n\nconst rootNodeModules = path.join(__dirname, '..', 'node_modules');\n\nfs.ensureSymlinkSync(\n  path.join(rootNodeModules, 'xstate5'),\n  path.join(rootNodeModules, '@xstate5', 'react', 'node_modules', 'xstate'),\n);\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json5",children:'// package.json\n"scripts": {\n  "postinstall": "node scripts/xstate5-react-script.js"\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u7136\u540e\uff0c\u60a8\u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528\u517c\u5bb9 XState v5 \u7684 ",(0,s.jsx)(n.code,{children:"@xstate/react"})," \u7248\u672c\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { useMachine } from '@xstate5/react';\n// or { useMachine as useMachine5 } from '@xstate5/react';\nimport { createMachine } from 'xstate5';\n// or { createMachine as createMachine5 } from 'xstate5';\n\n// ...\n"})})]})}function h(e={}){const{wrapper:n}={...(0,c.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}function x(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},11151:(e,n,t)=>{t.d(n,{Z:()=>r,a:()=>i});var s=t(67294);const c={},a=s.createContext(c);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);