---
title: XState
slug: '/xstate'
---

XState æ˜¯ä¸€ä¸ªç”¨äº JavaScript å’Œ TypeScript åº”ç”¨çš„çŠ¶æ€ç®¡ç†å’Œç¼–æ’è§£å†³æ–¹æ¡ˆã€‚

å®ƒä½¿ç”¨[äº‹ä»¶é©±åŠ¨](transitions.mdx)ç¼–ç¨‹ã€[çŠ¶æ€æœºã€çŠ¶æ€å›¾](state-machines-and-statecharts.mdx)å’Œ[æ¼”å‘˜æ¨¡å‹](actor-model.mdx)ä»¥å¯é¢„æµ‹ã€ç¨³å¥å’Œå¯è§†åŒ–çš„æ–¹å¼å¤„ç†å¤æ‚é€»è¾‘ã€‚XState æä¾›äº†ä¸€ç§å¼ºå¤§ä¸”çµæ´»çš„æ–¹å¼æ¥ç®¡ç†åº”ç”¨ç¨‹åºå’Œå·¥ä½œæµçŠ¶æ€ï¼Œå…è®¸å¼€å‘äººå‘˜å°†é€»è¾‘å»ºæ¨¡ä¸ºæ¼”å‘˜å’ŒçŠ¶æ€æœºã€‚å®ƒä¸ Reactã€Vueã€Svelte å’Œå…¶ä»–æ¡†æ¶å¾ˆå¥½åœ°é›†æˆï¼Œå¹¶ä¸”å¯ä»¥åœ¨å‰ç«¯ã€åç«¯æˆ–ä»»ä½• JavaScript è¿è¡Œçš„åœ°æ–¹ä½¿ç”¨ã€‚

:::tip

æƒ³äº†è§£æ›´å¤šå…³äºçŠ¶æ€æœºçš„ä¿¡æ¯å—ï¼Ÿ[é˜…è¯»æˆ‘ä»¬çš„ä»‹ç»](state-machines-and-statecharts.mdx)ã€‚

:::

## å®‰è£…

XState å¯ä»¥åœ¨ [npm](https://www.npmjs.com/package/xstate) ä¸Šè·å–ï¼š

<Tabs>
<TabItem value="npm" label="npm">

```bash
npm install xstate
```

</TabItem>

<TabItem value="pnpm" label="pnpm">

```bash
pnpm install xstate
```

</TabItem>

<TabItem value="yarn" label="yarn">

```bash
yarn add xstate
```

</TabItem>
</Tabs>

## åˆ›å»ºä¸€ä¸ªç®€å•çš„çŠ¶æ€æœº

```js
import { createMachine, assign, createActor } from 'xstate';

const countMachine = createMachine({
  context: {
    count: 0,
  },
  on: {
    INC: {
      actions: assign({
        count: ({ context }) => context.count + 1,
      }),
    },
    DEC: {
      actions: assign({
        count: ({ context }) => context.count - 1,
      }),
    },
    SET: {
      actions: assign({
        count: ({ event }) => event.value,
      }),
    },
  },
});

const countActor = createActor(countMachine).start();

countActor.subscribe((state) => {
  console.log(state.context.count);
});

countActor.send({ type: 'INC' });
// logs 1
countActor.send({ type: 'DEC' });
// logs 0
countActor.send({ type: 'SET', value: 10 });
// logs 10
```

<EmbedMachine embedURL="https://stately.ai/registry/editor/embed/c447d996-cef1-421d-a422-8be695668764?machineId=89e9d8f1-73d6-4dee-92bc-1796270e2f50&mode=design" title="Simple machine"/>

[æŸ¥çœ‹æ›´å¤šå¤‡å¿˜å•ç¤ºä¾‹](cheatsheet.mdx).

## åˆ›å»ºä¸€ä¸ªæ›´å¤æ‚çš„çŠ¶æ€æœº

```js
import { createMachine, assign, createActor } from 'xstate';

const textMachine = createMachine({
  context: {
    committedValue: '',
    value: '',
  },
  initial: 'reading',
  states: {
    reading: {
      on: {
        'text.edit': { target: 'editing' },
      },
    },
    editing: {
      on: {
        'text.change': {
          actions: assign({
            value: ({ event }) => event.value,
          }),
        },
        'text.commit': {
          actions: assign({
            committedValue: ({ context }) => context.value,
          }),
          target: 'reading',
        },
        'text.cancel': {
          actions: assign({
            value: ({ context }) => context.committedValue,
          }),
          target: 'reading',
        },
      },
    },
  },
});

const textActor = createActor(textMachine).start();

textActor.subscribe((state) => {
  console.log(state.context.value);
});

textActor.send({ type: 'text.edit' });
// logs ''
textActor.send({ type: 'text.change', value: 'Hello' });
// logs 'Hello'
textActor.send({ type: 'text.commit' });
// logs 'Hello'
textActor.send({ type: 'text.edit' });
// logs 'Hello'
textActor.send({ type: 'text.change', value: 'Hello world' });
// logs 'Hello world'
textActor.send({ type: 'text.cancel' });
// logs 'Hello'
```

<EmbedMachine embedURL="https://stately.ai/registry/editor/embed/c447d996-cef1-421d-a422-8be695668764?mode=design&machineId=fa84c2d4-7c42-4f67-8bde-66f972133703" title="more complex machine"/>

## ä¸‹è½½ XState VS Code æ‰©å±•

:::warningxstate

XState VS Code æ‰©å±•å°šæœªå®Œå…¨æ”¯æŒ XState v5ã€‚

:::

- [Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=statelyai.stately-vscode)
- [Open VSX Registry](https://open-vsx.org/extension/statelyai/stately-vscode)

[é˜…è¯»æ›´å¤šå…³äºæˆ‘ä»¬çš„å¼€å‘è€…å·¥å…·](developer-tools.mdx)ã€‚

## åŒ…

- ğŸ¤– [xstate](https://github.com/statelyai/xstate/): æ ¸å¿ƒæœ‰é™çŠ¶æ€æœºå’ŒçŠ¶æ€å›¾åº“ + æ¼”å‘˜
- ğŸ“‰ [@xstate/graph](https://github.com/statelyai/xstate/tree/main/packages/xstate-graph): XState çš„å›¾éå†å·¥å…·
- âš›ï¸ [@xstate/react](https://github.com/statelyai/xstate/tree/main/packages/xstate-react): åœ¨ React åº”ç”¨ä¸­ä½¿ç”¨ XState çš„ React hooks å’Œå·¥å…·
- ğŸ’š [@xstate/vue](https://github.com/statelyai/xstate/tree/main/packages/xstate-vue): åœ¨ Vue åº”ç”¨ä¸­ä½¿ç”¨ XState çš„ Vue ç»„åˆå‡½æ•°å’Œå·¥å…·
- ğŸ· [@xstate/svelte](https://github.com/statelyai/xstate/tree/main/packages/xstate-svelte): åœ¨ Svelte åº”ç”¨ä¸­ä½¿ç”¨ XState çš„ Svelte å·¥å…·
- âœ… [@xstate/test](https://github.com/statelyai/xstate/tree/main/packages/xstate-test): ç”¨äºæµ‹è¯•ä»»ä½•è½¯ä»¶çš„åŸºäºæ¨¡å‹çš„æµ‹è¯•å·¥å…·ï¼ˆä½¿ç”¨ XStateï¼‰
