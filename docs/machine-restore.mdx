---
title: 机器恢复
---

Studio 使用服务器-客户端架构构建。
每当您编辑机器时，我们会将这些更改持久化到我们的数据库中，随时供您在任何有互联网连接的设备上使用。

![上图为 Stately Studio 架构的简化图。](/studio_architecture_challenges.png)

但是，如果您的互联网连接失败或 Stately 后端出现问题，您的编辑会发生什么？
这就是机器恢复发挥作用的地方。

### 示例

在我们的示例中，圣诞老人的送货机器出现了问题；圣诞节状态无法到达。
所以我们像任何一个好的圣诞老人助手一样；我们创建一个事件来进入圣诞节。
但遗憾的是，我们处于离线状态，因此我们的更改可能会丢失。
在这个新功能之前，您可能不会注意到您已经离线或服务器返回了错误。
但正如您在下面的 GIF 中所看到的，我们引入了新的错误横幅来显示发生了什么。

如果您失去连接，我们会显示错误横幅，提示“您处于离线状态，因此我们无法保存您的机器；我们将尽力存储一个本地副本，您可以稍后恢复。”
所以请随意继续编辑；您可以在下次访问此机器时在同一设备上恢复您的工作。

![圣诞老人的送货状态机在尝试离线编辑时显示错误。](/recovery_offline_error.gif)

### 如何恢复

我们尽力在您编辑机器时检测任何故障或连接丢失。
如果您遇到任何错误状态，我们会通知您并开始在您的设备上本地保存您的工作。
因此，下次您从同一设备访问 Studio 时，我们将比较我们保存的内容与服务器上的机器。
如果它们不同，我们将为您提供将安全副本恢复到新机器的选项。

当我们检测到您的设备上有本地更改时，我们会显示一个标题为“恢复离线机器？”的模态窗口。
现在您有两个选项：

1. **“不，删除离线副本”** - 此选项将忽略并删除在您的设备上找到的更改，并且不再显示模态窗口。
2. **“是的，恢复到新机器”** - 此选项将在您当前的项目中创建一个包含更改的新机器。

您可以使用上面的示例看到这一点。
当我返回 Studio 时，我可以恢复我在离线时所做的更改。圣诞节得救了。

![Stately Studio 显示一个选项，用于恢复用户在离线时对机器所做的更改。](/recovery_restore_machine.gif)

:::info

阅读更多内容，请参阅[我们的博客文章，介绍机器恢复](https://stately.ai/blog/2022-12-22-machine-recovery)。

:::